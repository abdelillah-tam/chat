import{$ as q,$a as sn,A as Tt,Aa as vo,Ab as Tr,B as Hc,Ba as iu,Bb as Ar,C as fo,Ca as mr,Cb as Dr,D as ot,Da as ct,Db as Rr,E as qc,Ea as yo,Eb as mu,F as en,Fa as fe,Fb as Ye,G as at,Ga as ru,Gb as gu,H as po,Ha as qn,Hb as _u,I as Kc,Ia as Fe,Ib as xr,J as Yc,Ja as gr,Jb as Mr,K as Qc,Ka as su,L as lr,La as ou,M as Ie,Ma as Re,N as cr,Na as xt,O as ne,Oa as K,P as U,Pa as rn,Q as At,Qa as b,R as S,Ra as E,S as le,Sa as j,T as Xc,Ta as _r,U as k,Ua as z,V as mo,Va as Le,W as C,Wa as au,X as y,Xa as bo,Y as zn,Ya as wo,Z as ie,Za as F,_ as ce,_a as vr,a as g,aa as Dt,ab as yr,b as V,ba as Zc,bb as br,ca as tn,cb as wr,d as Q,da as De,db as Ke,e as Bc,ea as He,eb as re,f as $c,fa as ur,fb as lu,g as Bn,ga as dr,gb as cu,h as lo,ha as lt,hb as Cr,i as co,ia as nn,ib as Er,j as we,ja as Rt,jb as Co,k as Ce,ka as Jc,kb as Ir,l as rt,la as hr,lb as Eo,m as ae,ma as go,mb as uu,n as I,na as ve,nb as Mt,o as $n,oa as fr,ob as du,p as Wc,pa as ue,pb as hu,q as zc,qa as eu,qb as ut,r as N,ra as pr,rb as Kn,s as Wn,sa as tu,sb as dt,t as Ee,ta as qe,tb as on,u as uo,ua as _o,ub as fu,v as ar,va as Gn,vb as pu,w as ho,wa as nu,wb as X,x as Gc,xa as Hn,xb as Yn,y as st,ya as W,yb as Io,z as Jt,za as v,zb as Sr}from"./chunk-WWC2Z3ED.js";var Xn=class{},Or=class{},de=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let i=n.indexOf(":");if(i>0){let r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,i)=>{this.setHeaderEntries(i,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,i])=>{this.setHeaderEntries(n,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,n);let r=(e.op==="a"?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let i=(Array.isArray(n)?n:[n]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var To=class{encodeKey(e){return vu(e)}encodeValue(e){return vu(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function Qp(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,a]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=n.get(o)||[];c.push(a),n.set(o,c)}),n}var Xp=/%(\d[a-f0-9])/gi,Zp={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function vu(t){return encodeURIComponent(t).replace(Xp,(e,n)=>Zp[n]??e)}function Nr(t){return`${t}`}var ft=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new To,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=Qp(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let i=e.fromObject[n],r=Array.isArray(i)?i.map(Nr):[Nr(i)];this.map.set(n,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Nr(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(Nr(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Ao=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function Jp(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function yu(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function bu(t){return typeof Blob<"u"&&t instanceof Blob}function wu(t){return typeof FormData<"u"&&t instanceof FormData}function em(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var Qn=class t{constructor(e,n,i,r){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(Jp(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new de,this.context??=new Ao,!this.params)this.params=new ft,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||yu(this.body)||bu(this.body)||wu(this.body)||em(this.body)?this.body:this.body instanceof ft?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||wu(this.body)?null:bu(this.body)?this.body.type||null:yu(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ft?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new t(n,i,o,{params:u,headers:l,context:d,reportProgress:c,responseType:r,withCredentials:a,transferCache:s})}},pt=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(pt||{}),Zn=class{constructor(e,n=200,i="OK"){this.headers=e.headers||new de,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},kr=class t extends Zn{constructor(e={}){super(e),this.type=pt.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Jn=class t extends Zn{constructor(e={}){super(e),this.type=pt.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},ht=class extends Zn{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Su=200,tm=204;function So(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var xo=(()=>{let e=class e{constructor(i){this.handler=i}request(i,r,s={}){let o;if(i instanceof Qn)o=i;else{let l;s.headers instanceof de?l=s.headers:l=new de(s.headers);let u;s.params&&(s.params instanceof ft?u=s.params:u=new ft({fromObject:s.params})),o=new Qn(i,r,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:u,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=I(o).pipe(Tt(l=>this.handler.handle(l)));if(i instanceof Qn||s.observe==="events")return a;let c=a.pipe(st(l=>l instanceof Jn));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(N(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(N(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(N(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(N(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(i,r={}){return this.request("DELETE",i,r)}get(i,r={}){return this.request("GET",i,r)}head(i,r={}){return this.request("HEAD",i,r)}jsonp(i,r){return this.request("JSONP",i,{params:new ft().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,r={}){return this.request("OPTIONS",i,r)}patch(i,r,s={}){return this.request("PATCH",i,So(s,r))}post(i,r,s={}){return this.request("POST",i,So(s,r))}put(i,r,s={}){return this.request("PUT",i,So(s,r))}};e.\u0275fac=function(r){return new(r||e)(C(Xn))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),nm=/^\)\]\}',?\n/,im="X-Request-URL";function Cu(t){if(t.url)return t.url;let e=im.toLocaleLowerCase();return t.headers.get(e)}var rm=(()=>{let e=class e{constructor(){this.fetchImpl=y(Do,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=y(fe)}handle(i){return new Bn(r=>{let s=new AbortController;return this.doRequest(i,s.signal,r).then(Ro,o=>r.error(new ht({error:o}))),()=>s.abort()})}doRequest(i,r,s){return Q(this,null,function*(){let o=this.createRequestInit(i),a;try{let p=this.ngZone.runOutsideAngular(()=>this.fetchImpl(i.urlWithParams,g({signal:r},o)));sm(p),s.next({type:pt.Sent}),a=yield p}catch(p){s.error(new ht({error:p,status:p.status??0,statusText:p.statusText,url:i.urlWithParams,headers:p.headers}));return}let c=new de(a.headers),l=a.statusText,u=Cu(a)??i.urlWithParams,d=a.status,h=null;if(i.reportProgress&&s.next(new kr({headers:c,status:d,statusText:l,url:u})),a.body){let p=a.headers.get("content-length"),w=[],_=a.body.getReader(),D=0,H,ee,Y=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Q(this,null,function*(){for(;;){let{done:St,value:Un}=yield _.read();if(St)break;if(w.push(Un),D+=Un.length,i.reportProgress){ee=i.responseType==="text"?(ee??"")+(H??=new TextDecoder).decode(Un,{stream:!0}):void 0;let Uc=()=>s.next({type:pt.DownloadProgress,total:p?+p:void 0,loaded:D,partialText:ee});Y?Y.run(Uc):Uc()}}}));let jn=this.concatChunks(w,D);try{let St=a.headers.get("Content-Type")??"";h=this.parseBody(i,jn,St)}catch(St){s.error(new ht({error:St,headers:new de(a.headers),status:a.status,statusText:a.statusText,url:Cu(a)??i.urlWithParams}));return}}d===0&&(d=h?Su:0),d>=200&&d<300?(s.next(new Jn({body:h,headers:c,status:d,statusText:l,url:u})),s.complete()):s.error(new ht({error:h,headers:c,status:d,statusText:l,url:u}))})}parseBody(i,r,s){switch(i.responseType){case"json":let o=new TextDecoder().decode(r).replace(nm,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:s});case"arraybuffer":return r.buffer}}createRequestInit(i){let r={},s=i.withCredentials?"include":void 0;if(i.headers.forEach((o,a)=>r[o]=a.join(",")),i.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!i.headers.has("Content-Type")){let o=i.detectContentTypeHeader();o!==null&&(r["Content-Type"]=o)}return{body:i.serializeBody(),method:i.method,headers:r,credentials:s}}concatChunks(i,r){let s=new Uint8Array(r),o=0;for(let a of i)s.set(a,o),o+=a.length;return s}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Do=class{};function Ro(){}function sm(t){t.then(Ro,Ro)}function om(t,e){return e(t)}function am(t,e,n){return(i,r)=>De(n,()=>e(i,s=>t(s,r)))}var Tu=new k(""),lm=new k(""),cm=new k("",{providedIn:"root",factory:()=>!0});var Eu=(()=>{let e=class e extends Xn{constructor(i,r){super(),this.backend=i,this.injector=r,this.chain=null,this.pendingTasks=y(fr),this.contributeToStability=y(cm)}handle(i){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Tu),...this.injector.get(lm,[])]));this.chain=r.reduceRight((s,o)=>am(s,o,this.injector),om)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(i,s=>this.backend.handle(s)).pipe(en(()=>this.pendingTasks.remove(r)))}else return this.chain(i,r=>this.backend.handle(r))}};e.\u0275fac=function(r){return new(r||e)(C(Or),C(tn))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();var um=/^\)\]\}',?\n/;function dm(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var Iu=(()=>{let e=class e{constructor(i){this.xhrFactory=i}handle(i){if(i.method==="JSONP")throw new U(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?ae(r.\u0275loadImpl()):I(null)).pipe(Ie(()=>new Bn(o=>{let a=r.build();if(a.open(i.method,i.urlWithParams),i.withCredentials&&(a.withCredentials=!0),i.headers.forEach((_,D)=>a.setRequestHeader(_,D.join(","))),i.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){let _=i.detectContentTypeHeader();_!==null&&a.setRequestHeader("Content-Type",_)}if(i.responseType){let _=i.responseType.toLowerCase();a.responseType=_!=="json"?_:"text"}let c=i.serializeBody(),l=null,u=()=>{if(l!==null)return l;let _=a.statusText||"OK",D=new de(a.getAllResponseHeaders()),H=dm(a)||i.url;return l=new kr({headers:D,status:a.status,statusText:_,url:H}),l},d=()=>{let{headers:_,status:D,statusText:H,url:ee}=u(),Y=null;D!==tm&&(Y=typeof a.response>"u"?a.responseText:a.response),D===0&&(D=Y?Su:0);let jn=D>=200&&D<300;if(i.responseType==="json"&&typeof Y=="string"){let St=Y;Y=Y.replace(um,"");try{Y=Y!==""?JSON.parse(Y):null}catch(Un){Y=St,jn&&(jn=!1,Y={error:Un,text:Y})}}jn?(o.next(new Jn({body:Y,headers:_,status:D,statusText:H,url:ee||void 0})),o.complete()):o.error(new ht({error:Y,headers:_,status:D,statusText:H,url:ee||void 0}))},h=_=>{let{url:D}=u(),H=new ht({error:_,status:a.status||0,statusText:a.statusText||"Unknown Error",url:D||void 0});o.error(H)},f=!1,p=_=>{f||(o.next(u()),f=!0);let D={type:pt.DownloadProgress,loaded:_.loaded};_.lengthComputable&&(D.total=_.total),i.responseType==="text"&&a.responseText&&(D.partialText=a.responseText),o.next(D)},w=_=>{let D={type:pt.UploadProgress,loaded:_.loaded};_.lengthComputable&&(D.total=_.total),o.next(D)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),i.reportProgress&&(a.addEventListener("progress",p),c!==null&&a.upload&&a.upload.addEventListener("progress",w)),a.send(c),o.next({type:pt.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),i.reportProgress&&(a.removeEventListener("progress",p),c!==null&&a.upload&&a.upload.removeEventListener("progress",w)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(r){return new(r||e)(C(Mr))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Au=new k(""),hm="XSRF-TOKEN",fm=new k("",{providedIn:"root",factory:()=>hm}),pm="X-XSRF-TOKEN",mm=new k("",{providedIn:"root",factory:()=>pm}),Pr=class{},gm=(()=>{let e=class e{constructor(i,r,s){this.doc=i,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=Tr(i,this.cookieName),this.lastCookieString=i),this.lastToken}};e.\u0275fac=function(r){return new(r||e)(C(X),C(qe),C(fm))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();function _m(t,e){let n=t.url.toLowerCase();if(!y(Au)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let i=y(Pr).getToken(),r=y(mm);return i!=null&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,i)})),e(t)}function Du(...t){let e=[xo,Iu,Eu,{provide:Xn,useExisting:Eu},{provide:Or,useFactory:()=>y(rm,{optional:!0})??y(Iu)},{provide:Tu,useValue:_m,multi:!0},{provide:Au,useValue:!0},{provide:Pr,useClass:gm}];for(let n of t)e.push(...n.\u0275providers);return Dt(e)}var Oo=class extends pu{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ko=class t extends Oo{static makeCurrent(){fu(new t)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=wm();return n==null?null:Cm(n)}resetBaseElement(){ei=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Tr(document.cookie,e)}},ei=null;function wm(){return ei=ei||document.querySelector("base"),ei?ei.getAttribute("href"):null}function Cm(t){return new URL(t,document.baseURI).pathname}var Em=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Lr=new k(""),Mu=(()=>{let e=class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,s){return this._findPluginFor(r).addEventListener(i,r,s)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new U(5101,!1);return this._eventNameToPlugin.set(i,r),r}};e.\u0275fac=function(r){return new(r||e)(C(Lr),C(fe))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),ti=class{constructor(e){this._doc=e}},Mo="ng-app-id",Nu=(()=>{let e=class e{constructor(i,r,s,o={}){this.doc=i,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=xr(o),this.resetHostNodes()}addStyles(i){for(let r of i)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(i){for(let r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){let r=this.styleRef;r.get(i)?.elements?.forEach(s=>s.remove()),r.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${Mo}="${this.appId}"]`);if(i?.length){let r=new Map;return i.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(i,r){let s=this.styleRef;if(s.has(i)){let o=s.get(i);return o.usage+=r,o.usage}return s.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===i)return s.delete(r),o.removeAttribute(Mo),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Mo,this.appId),i.appendChild(a),a}}addStyleToHost(i,r){let s=this.getStyleElement(i,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(C(X),C(pr),C(Gn,8),C(qe))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),No={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Lo=/%COMP%/g,Ou="%COMP%",Im=`_nghost-${Ou}`,Sm=`_ngcontent-${Ou}`,Tm=!0,Am=new k("",{providedIn:"root",factory:()=>Tm});function Dm(t){return Sm.replace(Lo,t)}function Rm(t){return Im.replace(Lo,t)}function ku(t,e){return e.map(n=>n.replace(Lo,t))}var Vr=(()=>{let e=class e{constructor(i,r,s,o,a,c,l,u=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=xr(c),this.defaultRenderer=new ni(i,a,l,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===zn.ShadowDom&&(r=V(g({},r),{encapsulation:zn.Emulated}));let s=this.getOrCreateRenderer(i,r);return s instanceof jr?s.applyToHost(i):s instanceof ii&&s.applyStyles(),s}getOrCreateRenderer(i,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case zn.Emulated:o=new jr(l,u,r,this.appId,d,a,c,h);break;case zn.ShadowDom:return new Po(l,u,i,r,a,c,this.nonce,h);default:o=new ii(l,u,r,d,a,c,h);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(C(Mu),C(Nu),C(pr),C(Am),C(X),C(qe),C(fe),C(Gn))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),ni=class{constructor(e,n,i,r){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(No[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(Ru(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(Ru(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new U(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;let s=No[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){let r=No[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(Hn.DashCase|Hn.Important)?e.style.setProperty(n,i,r&Hn.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&Hn.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e!=null&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if(typeof e=="string"&&(e=on().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function Ru(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Po=class extends ni{constructor(e,n,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=ku(r.id,r.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ii=class extends ni{constructor(e,n,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=c?ku(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},jr=class extends ii{constructor(e,n,i,r,s,o,a,c){let l=r+"-"+i.id;super(e,n,i,s,o,a,c,l),this.contentAttr=Dm(l),this.hostAttr=Rm(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}},xm=(()=>{let e=class e extends ti{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,s){return i.addEventListener(r,s,!1),()=>this.removeEventListener(i,r,s)}removeEventListener(i,r,s){return i.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(C(X))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Mm=(()=>{let e=class e extends ti{constructor(i){super(i),this.delegate=y(hu,{optional:!0})}supports(i){return this.delegate?this.delegate.supports(i):!1}addEventListener(i,r,s){return this.delegate.addEventListener(i,r,s)}removeEventListener(i,r,s){return this.delegate.removeEventListener(i,r,s)}};e.\u0275fac=function(r){return new(r||e)(C(X))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),xu=["alt","control","meta","shift"],Nm={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Om={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},km=(()=>{let e=class e extends ti{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>on().onAndCancel(i,o.domEventName,a))}static parseEventName(i){let r=i.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),xu.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),a+=u+".")}),a+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(i,r){let s=Nm[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(s=i.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),xu.forEach(a=>{if(a!==s){let c=Om[a];c(i)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(i,r,s){return o=>{e.matchEventFullKeyCode(o,i)&&s.runGuarded(()=>r(o))}}static _normalizeKey(i){return i==="esc"?"escape":i}};e.\u0275fac=function(r){return new(r||e)(C(X))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();function Pu(t,e){return du(g({rootComponent:t},Pm(e)))}function Pm(t){return{appProviders:[...Um,...t?.providers??[]],platformProviders:jm}}function Fm(){ko.makeCurrent()}function Lm(){return new go}function Vm(){return eu(document),document}var jm=[{provide:qe,useValue:gu},{provide:tu,useValue:Fm,multi:!0},{provide:X,useFactory:Vm,deps:[]}];var Um=[{provide:Zc,useValue:"root"},{provide:go,useFactory:Lm,deps:[]},{provide:Lr,useClass:xm,multi:!0,deps:[X,fe,qe]},{provide:Lr,useClass:km,multi:!0,deps:[X]},{provide:Lr,useClass:Mm,multi:!0},Vr,Nu,Mu,{provide:mr,useExisting:Vr},{provide:Mr,useClass:Em,deps:[]},[]];var Fu=(()=>{let e=class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}};e.\u0275fac=function(r){return new(r||e)(C(X))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var T="primary",yi=Symbol("RouteTitle"),$o=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function hn(t){return new $o(t)}function Wm(t,e,n){let i=n.path.split("/");if(i.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||i.length<t.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],a=t[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function zm(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Ve(t[n],e[n]))return!1;return!0}function Ve(t,e){let n=t?Wo(t):void 0,i=e?Wo(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!zu(t[r],e[r]))return!1;return!0}function Wo(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function zu(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}else return t===e}function Gu(t){return t.length>0?t[t.length-1]:null}function mt(t){return Wc(t)?t:Er(t)?ae(Promise.resolve(t)):I(t)}var Gm={exact:qu,subset:Ku},Hu={exact:Hm,subset:qm,ignored:()=>!0};function Lu(t,e,n){return Gm[n.paths](t.root,e.root,n.matrixParams)&&Hu[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Hm(t,e){return Ve(t,e)}function qu(t,e,n){if(!Ot(t.segments,e.segments)||!$r(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!t.children[i]||!qu(t.children[i],e.children[i],n))return!1;return!0}function qm(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>zu(t[n],e[n]))}function Ku(t,e,n){return Yu(t,e,e.segments,n)}function Yu(t,e,n,i){if(t.segments.length>n.length){let r=t.segments.slice(0,n.length);return!(!Ot(r,n)||e.hasChildren()||!$r(r,n,i))}else if(t.segments.length===n.length){if(!Ot(t.segments,n)||!$r(t.segments,n,i))return!1;for(let r in e.children)if(!t.children[r]||!Ku(t.children[r],e.children[r],i))return!1;return!0}else{let r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ot(t.segments,r)||!$r(t.segments,r,i)||!t.children[T]?!1:Yu(t.children[T],e,s,i)}}function $r(t,e,n){return e.every((i,r)=>Hu[n](t[r].parameters,i.parameters))}var Xe=class{constructor(e=new P([],{}),n={},i=null){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=hn(this.queryParams),this._queryParamMap}toString(){return Qm.serialize(this)}},P=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wr(this)}},Nt=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=hn(this.parameters),this._parameterMap}toString(){return Xu(this)}};function Km(t,e){return Ot(t,e)&&t.every((n,i)=>Ve(n.parameters,e[i].parameters))}function Ot(t,e){return t.length!==e.length?!1:t.every((n,i)=>n.path===e[i].path)}function Ym(t,e){let n=[];return Object.entries(t.children).forEach(([i,r])=>{i===T&&(n=n.concat(e(r,i)))}),Object.entries(t.children).forEach(([i,r])=>{i!==T&&(n=n.concat(e(r,i)))}),n}var ma=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>new ui,providedIn:"root"});let t=e;return t})(),ui=class{parse(e){let n=new Go(e);return new Xe(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${ri(e.root,!0)}`,i=Jm(e.queryParams),r=typeof e.fragment=="string"?`#${Xm(e.fragment)}`:"";return`${n}${i}${r}`}},Qm=new ui;function Wr(t){return t.segments.map(e=>Xu(e)).join("/")}function ri(t,e){if(!t.hasChildren())return Wr(t);if(e){let n=t.children[T]?ri(t.children[T],!1):"",i=[];return Object.entries(t.children).forEach(([r,s])=>{r!==T&&i.push(`${r}:${ri(s,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}else{let n=Ym(t,(i,r)=>r===T?[ri(t.children[T],!1)]:[`${r}:${ri(i,!1)}`]);return Object.keys(t.children).length===1&&t.children[T]!=null?`${Wr(t)}/${n[0]}`:`${Wr(t)}/(${n.join("//")})`}}function Qu(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ur(t){return Qu(t).replace(/%3B/gi,";")}function Xm(t){return encodeURI(t)}function zo(t){return Qu(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zr(t){return decodeURIComponent(t)}function Vu(t){return zr(t.replace(/\+/g,"%20"))}function Xu(t){return`${zo(t.path)}${Zm(t.parameters)}`}function Zm(t){return Object.entries(t).map(([e,n])=>`;${zo(e)}=${zo(n)}`).join("")}function Jm(t){let e=Object.entries(t).map(([n,i])=>Array.isArray(i)?i.map(r=>`${Ur(n)}=${Ur(r)}`).join("&"):`${Ur(n)}=${Ur(i)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var eg=/^[^\/()?;#]+/;function Vo(t){let e=t.match(eg);return e?e[0]:""}var tg=/^[^\/()?;=#]+/;function ng(t){let e=t.match(tg);return e?e[0]:""}var ig=/^[^=?&#]+/;function rg(t){let e=t.match(ig);return e?e[0]:""}var sg=/^[^&#]+/;function og(t){let e=t.match(sg);return e?e[0]:""}var Go=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new P([],{}):new P([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[T]=new P(e,n)),i}parseSegment(){let e=Vo(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new U(4009,!1);return this.capture(e),new Nt(zr(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=ng(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let r=Vo(this.remaining);r&&(i=r,this.capture(i))}e[zr(n)]=zr(i)}parseQueryParam(e){let n=rg(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let o=og(this.remaining);o&&(i=o,this.capture(i))}let r=Vu(n),s=Vu(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Vo(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new U(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=T);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[T]:new P([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new U(4011,!1)}};function Zu(t){return t.segments.length>0?new P([],{[T]:t}):t}function Ju(t){let e={};for(let[i,r]of Object.entries(t.children)){let s=Ju(r);if(i===T&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let n=new P(t.segments,e);return ag(n)}function ag(t){if(t.numberOfChildren===1&&t.children[T]){let e=t.children[T];return new P(t.segments.concat(e.segments),e.children)}return t}function kt(t){return t instanceof Xe}function lg(t,e,n=null,i=null){let r=ed(t);return td(r,e,n,i)}function ed(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new P(s.url,o);return s===t&&(e=a),a}let i=n(t.root),r=Zu(i);return e??r}function td(t,e,n,i){let r=t;for(;r.parent;)r=r.parent;if(e.length===0)return jo(r,r,r,n,i);let s=cg(e);if(s.toRoot())return jo(r,r,new P([],{}),n,i);let o=ug(s,r,t),a=o.processChildren?ai(o.segmentGroup,o.index,s.commands):id(o.segmentGroup,o.index,s.commands);return jo(r,o.segmentGroup,a,n,i)}function Gr(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function di(t){return typeof t=="object"&&t!=null&&t.outlets}function jo(t,e,n,i,r){let s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;t===e?o=n:o=nd(t,e,n);let a=Zu(Ju(o));return new Xe(a,s,r)}function nd(t,e,n){let i={};return Object.entries(t.children).forEach(([r,s])=>{s===e?i[r]=n:i[r]=nd(s,e,n)}),new P(t.segments,i)}var Hr=class{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&Gr(i[0]))throw new U(4003,!1);let r=i.find(di);if(r&&r!==Gu(i))throw new U(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function cg(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Hr(!0,0,t);let e=0,n=!1,i=t.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Hr(n,e,i)}var cn=class{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}};function ug(t,e,n){if(t.isAbsolute)return new cn(e,!0,0);if(!n)return new cn(e,!1,NaN);if(n.parent===null)return new cn(n,!0,0);let i=Gr(t.commands[0])?0:1,r=n.segments.length-1+i;return dg(n,r,t.numberOfDoubleDots)}function dg(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new U(4005,!1);r=i.segments.length}return new cn(i,!1,r-s)}function hg(t){return di(t[0])?t[0].outlets:{[T]:t}}function id(t,e,n){if(t??=new P([],{}),t.segments.length===0&&t.hasChildren())return ai(t,e,n);let i=fg(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){let s=new P(t.segments.slice(0,i.pathIndex),{});return s.children[T]=new P(t.segments.slice(i.pathIndex),t.children),ai(s,0,r)}else return i.match&&r.length===0?new P(t.segments,{}):i.match&&!t.hasChildren()?Ho(t,e,n):i.match?ai(t,0,r):Ho(t,e,n)}function ai(t,e,n){if(n.length===0)return new P(t.segments,{});{let i=hg(n),r={};if(Object.keys(i).some(s=>s!==T)&&t.children[T]&&t.numberOfChildren===1&&t.children[T].segments.length===0){let s=ai(t.children[T],e,n);return new P(t.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=id(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new P(t.segments,r)}}function fg(t,e,n){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;let o=t.segments[r],a=n[i];if(di(a))break;let c=`${a}`,l=i<n.length-1?n[i+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Uu(c,l,o))return s;i+=2}else{if(!Uu(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function Ho(t,e,n){let i=t.segments.slice(0,e),r=0;for(;r<n.length;){let s=n[r];if(di(s)){let c=pg(s.outlets);return new P(i,c)}if(r===0&&Gr(n[0])){let c=t.segments[e];i.push(new Nt(c.path,ju(n[0]))),r++;continue}let o=di(s)?s.outlets[T]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&Gr(a)?(i.push(new Nt(o,ju(a))),r+=2):(i.push(new Nt(o,{})),r++)}return new P(i,{})}function pg(t){let e={};return Object.entries(t).forEach(([n,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[n]=Ho(new P([],{}),0,i))}),e}function ju(t){let e={};return Object.entries(t).forEach(([n,i])=>e[n]=`${i}`),e}function Uu(t,e,n){return t==n.path&&Ve(e,n.parameters)}var li="imperative",se=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(se||{}),Se=class{constructor(e,n){this.id=e,this.url=n}},hi=class extends Se{constructor(e,n,i="imperative",r=null){super(e,n),this.type=se.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ze=class extends Se{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i,this.type=se.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},be=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(be||{}),qo=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(qo||{}),Qe=class extends Se{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=se.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Pt=class extends Se{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=se.NavigationSkipped}},fi=class extends Se{constructor(e,n,i,r){super(e,n),this.error=i,this.target=r,this.type=se.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},qr=class extends Se{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=se.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ko=class extends Se{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=se.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yo=class extends Se{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=se.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Qo=class extends Se{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=se.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xo=class extends Se{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=se.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zo=class{constructor(e){this.route=e,this.type=se.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Jo=class{constructor(e){this.route=e,this.type=se.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ea=class{constructor(e){this.snapshot=e,this.type=se.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ta=class{constructor(e){this.snapshot=e,this.type=se.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},na=class{constructor(e){this.snapshot=e,this.type=se.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ia=class{constructor(e){this.snapshot=e,this.type=se.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var pi=class{},fn=class{constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function mg(t,e){return t.providers&&!t._injector&&(t._injector=ou(t.providers,e,`Route: ${t.path}`)),t._injector??e}function xe(t){return t.outlet||T}function gg(t,e){let n=t.filter(i=>xe(i)===e);return n.push(...t.filter(i=>xe(i)!==e)),n}function bi(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var ra=class{get injector(){return bi(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new es(this.rootInjector),this.attachRef=null}},es=(()=>{let e=class e{constructor(i){this.rootInjector=i,this.contexts=new Map}onChildOutletCreated(i,r){let s=this.getOrCreateContext(i);s.outlet=r,this.contexts.set(i,s)}onChildOutletDestroyed(i){let r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new ra(this.rootInjector),this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}};e.\u0275fac=function(r){return new(r||e)(C(tn))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Kr=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=sa(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){let n=sa(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=oa(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return oa(e,this._root).map(n=>n.value)}};function sa(t,e){if(t===e.value)return e;for(let n of e.children){let i=sa(t,n);if(i)return i}return null}function oa(t,e){if(t===e.value)return[e];for(let n of e.children){let i=oa(t,n);if(i.length)return i.unshift(e),i}return[]}var ye=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ln(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Yr=class extends Kr{constructor(e,n){super(e),this.snapshot=n,ga(this,e)}toString(){return this.snapshot.toString()}};function rd(t){let e=_g(t),n=new Ce([new Nt("",{})]),i=new Ce({}),r=new Ce({}),s=new Ce({}),o=new Ce(""),a=new Ft(n,i,s,o,r,T,t,e.root);return a.snapshot=e.root,new Yr(new ye(a,[]),e)}function _g(t){let e={},n={},i={},r="",s=new un([],e,i,r,n,T,t,null,{});return new Xr("",new ye(s,[]))}var Ft=class{constructor(e,n,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(N(l=>l[yi]))??I(void 0),this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(N(e=>hn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(N(e=>hn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Qr(t,e,n="emptyOnly"){let i,{routeConfig:r}=t;return e!==null&&(n==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:g(g({},e.params),t.params),data:g(g({},e.data),t.data),resolve:g(g(g(g({},t.data),e.data),r?.data),t._resolvedData)}:i={params:g({},t.params),data:g({},t.data),resolve:g(g({},t.data),t._resolvedData??{})},r&&od(r)&&(i.resolve[yi]=r.title),i}var un=class{get title(){return this.data?.[yi]}constructor(e,n,i,r,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=hn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=hn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Xr=class extends Kr{constructor(e,n){super(n),this.url=e,ga(this,n)}toString(){return sd(this._root)}};function ga(t,e){e.value._routerState=t,e.children.forEach(n=>ga(t,n))}function sd(t){let e=t.children.length>0?` { ${t.children.map(sd).join(", ")} } `:"";return`${t.value}${e}`}function Uo(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Ve(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Ve(e.params,n.params)||t.paramsSubject.next(n.params),zm(e.url,n.url)||t.urlSubject.next(n.url),Ve(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function aa(t,e){let n=Ve(t.params,e.params)&&Km(t.url,e.url),i=!t.parent!=!e.parent;return n&&!i&&(!t.parent||aa(t.parent,e.parent))}function od(t){return typeof t.title=="string"||t.title===null}var _a=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=T,this.activateEvents=new ue,this.deactivateEvents=new ue,this.attachEvents=new ue,this.detachEvents=new ue,this.parentContexts=y(es),this.location=y(ru),this.changeDetector=y(Mt),this.inputBinder=y(va,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:r,previousValue:s}=i.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new U(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new U(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new U(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new U(4013,!1);this._activatedRoute=i;let s=this.location,a=i.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new la(i,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=q({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[He]});let t=e;return t})(),la=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===Ft?this.route:e===es?this.childContexts:this.parent.get(e,n)}},va=new k("");function vg(t,e,n){let i=mi(t,e._root,n?n._root:void 0);return new Yr(i,e)}function mi(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let i=n.value;i._futureSnapshot=e.value;let r=yg(t,e,n);return new ye(i,r)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>mi(t,a)),o}}let i=bg(e.value),r=e.children.map(s=>mi(t,s));return new ye(i,r)}}function yg(t,e,n){return e.children.map(i=>{for(let r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return mi(t,i,r);return mi(t,i)})}function bg(t){return new Ft(new Ce(t.url),new Ce(t.params),new Ce(t.queryParams),new Ce(t.fragment),new Ce(t.data),t.outlet,t.component,t)}var gi=class{constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},ad="ngNavigationCancelingError";function Zr(t,e){let{redirectTo:n,navigationBehaviorOptions:i}=kt(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=ld(!1,be.Redirect);return r.url=n,r.navigationBehaviorOptions=i,r}function ld(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[ad]=!0,n.cancellationCode=e,n}function wg(t){return cd(t)&&kt(t.url)}function cd(t){return!!t&&t[ad]}var Cg=(t,e,n,i)=>N(r=>(new ca(e,r.targetRouterState,r.currentRouterState,n,i).activate(t),r)),ca=class{constructor(e,n,i,r,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),Uo(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){let r=ln(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=ln(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=ln(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,n,i){let r=ln(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new ia(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ta(e.value.snapshot))}activateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(Uo(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Uo(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}},Jr=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},dn=class{constructor(e,n){this.component=e,this.route=n}};function Eg(t,e,n){let i=t._root,r=e?e._root:null;return si(i,r,n,[i.value])}function Ig(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function gn(t,e){let n=Symbol(),i=e.get(t,n);return i===n?typeof t=="function"&&!Xc(t)?t:e.get(t):i}function si(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=ln(e);return t.children.forEach(o=>{Sg(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ci(a,n.getContext(o),r)),r}function Sg(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=Tg(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Jr(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?si(t,e,a?a.children:null,i,r):si(t,e,n,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new dn(a.outlet.component,o))}else o&&ci(e,a,r),r.canActivateChecks.push(new Jr(i)),s.component?si(t,null,a?a.children:null,i,r):si(t,null,n,i,r);return r}function Tg(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ot(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ot(t.url,e.url)||!Ve(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!aa(t,e)||!Ve(t.queryParams,e.queryParams);case"paramsChange":default:return!aa(t,e)}}function ci(t,e,n){let i=ln(t),r=t.value;Object.entries(i).forEach(([s,o])=>{r.component?e?ci(o,e.children.getContext(s),n):ci(o,null,n):ci(o,e,n)}),r.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new dn(e.outlet.component,r)):n.canDeactivateChecks.push(new dn(null,r)):n.canDeactivateChecks.push(new dn(null,r))}function wi(t){return typeof t=="function"}function Ag(t){return typeof t=="boolean"}function Dg(t){return t&&wi(t.canLoad)}function Rg(t){return t&&wi(t.canActivate)}function xg(t){return t&&wi(t.canActivateChild)}function Mg(t){return t&&wi(t.canDeactivate)}function Ng(t){return t&&wi(t.canMatch)}function ud(t){return t instanceof zc||t?.name==="EmptyError"}var Br=Symbol("INITIAL_VALUE");function pn(){return Ie(t=>Wn(t.map(e=>e.pipe(ot(1),lr(Br)))).pipe(N(e=>{for(let n of e)if(n!==!0){if(n===Br)return Br;if(n===!1||Og(n))return n}return!0}),st(e=>e!==Br),ot(1)))}function Og(t){return kt(t)||t instanceof gi}function kg(t,e){return Ee(n=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?I(V(g({},n),{guardsResult:!0})):Pg(o,i,r,t).pipe(Ee(a=>a&&Ag(a)?Fg(i,s,t,e):I(a)),N(a=>V(g({},n),{guardsResult:a})))})}function Pg(t,e,n,i){return ae(t).pipe(Ee(r=>Bg(r.component,r.route,n,e,i)),at(r=>r!==!0,!0))}function Fg(t,e,n,i){return ae(e).pipe(Tt(r=>ar(Vg(r.route.parent,i),Lg(r.route,i),Ug(t,r.path,n),jg(t,r.route,n))),at(r=>r!==!0,!0))}function Lg(t,e){return t!==null&&e&&e(new na(t)),I(!0)}function Vg(t,e){return t!==null&&e&&e(new ea(t)),I(!0)}function jg(t,e,n){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return I(!0);let r=i.map(s=>ho(()=>{let o=bi(e)??n,a=gn(s,o),c=Rg(a)?a.canActivate(e,t):De(o,()=>a(e,t));return mt(c).pipe(at())}));return I(r).pipe(pn())}function Ug(t,e,n){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Ig(o)).filter(o=>o!==null).map(o=>ho(()=>{let a=o.guards.map(c=>{let l=bi(o.node)??n,u=gn(c,l),d=xg(u)?u.canActivateChild(i,t):De(l,()=>u(i,t));return mt(d).pipe(at())});return I(a).pipe(pn())}));return I(s).pipe(pn())}function Bg(t,e,n,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return I(!0);let o=s.map(a=>{let c=bi(e)??r,l=gn(a,c),u=Mg(l)?l.canDeactivate(t,e,n,i):De(c,()=>l(t,e,n,i));return mt(u).pipe(at())});return I(o).pipe(pn())}function $g(t,e,n,i){let r=e.canLoad;if(r===void 0||r.length===0)return I(!0);let s=r.map(o=>{let a=gn(o,t),c=Dg(a)?a.canLoad(e,n):De(t,()=>a(e,n));return mt(c)});return I(s).pipe(pn(),dd(i))}function dd(t){return $c(ne(e=>{if(typeof e!="boolean")throw Zr(t,e)}),N(e=>e===!0))}function Wg(t,e,n,i){let r=e.canMatch;if(!r||r.length===0)return I(!0);let s=r.map(o=>{let a=gn(o,t),c=Ng(a)?a.canMatch(e,n):De(t,()=>a(e,n));return mt(c)});return I(s).pipe(pn(),dd(i))}var _i=class{constructor(e){this.segmentGroup=e||null}},vi=class extends Error{constructor(e){super(),this.urlTree=e}};function an(t){return $n(new _i(t))}function zg(t){return $n(new U(4e3,!1))}function Gg(t){return $n(ld(!1,be.GuardRejected))}var ua=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return I(i);if(r.numberOfChildren>1||!r.children[T])return zg(`${e.redirectTo}`);r=r.children[T]}}applyRedirectCommands(e,n,i,r,s){if(typeof n!="string"){let a=n,{queryParams:c,fragment:l,routeConfig:u,url:d,outlet:h,params:f,data:p,title:w}=r,_=De(s,()=>a({params:f,data:p,queryParams:c,fragment:l,routeConfig:u,url:d,outlet:h,title:w}));if(_ instanceof Xe)throw new vi(_);n=_}let o=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,i);if(n[0]==="/")throw new vi(o);return o}applyRedirectCreateUrlTree(e,n,i,r){let s=this.createSegmentGroup(e,n.root,i,r);return new Xe(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);i[r]=n[a]}else i[r]=s}),i}createSegmentGroup(e,n,i,r){let s=this.createSegments(e,n.segments,i,r),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new P(s,o)}createSegments(e,n,i,r){return n.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){let r=i[n.path.substring(1)];if(!r)throw new U(4001,!1);return r}findOrReturn(e,n){let i=0;for(let r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}},da={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Hg(t,e,n,i,r){let s=ya(t,e,n);return s.matched?(i=mg(e,i),Wg(i,e,n,r).pipe(N(o=>o===!0?s:g({},da)))):I(s)}function ya(t,e,n){if(e.path==="**")return qg(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?g({},da):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let r=(e.matcher||Wm)(n,t,e);if(!r)return g({},da);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?g(g({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function qg(t){return{matched:!0,parameters:t.length>0?Gu(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function Bu(t,e,n,i){return n.length>0&&Qg(t,n,i)?{segmentGroup:new P(e,Yg(i,new P(n,t.children))),slicedSegments:[]}:n.length===0&&Xg(t,n,i)?{segmentGroup:new P(t.segments,Kg(t,n,i,t.children)),slicedSegments:n}:{segmentGroup:new P(t.segments,t.children),slicedSegments:n}}function Kg(t,e,n,i){let r={};for(let s of n)if(ts(t,e,s)&&!i[xe(s)]){let o=new P([],{});r[xe(s)]=o}return g(g({},i),r)}function Yg(t,e){let n={};n[T]=e;for(let i of t)if(i.path===""&&xe(i)!==T){let r=new P([],{});n[xe(i)]=r}return n}function Qg(t,e,n){return n.some(i=>ts(t,e,i)&&xe(i)!==T)}function Xg(t,e,n){return n.some(i=>ts(t,e,i))}function ts(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Zg(t,e,n,i){return xe(t)!==i&&(i===T||!ts(e,n,t))?!1:ya(e,t,n).matched}function Jg(t,e,n){return e.length===0&&!t.children[n]}var ha=class{};function e_(t,e,n,i,r,s,o="emptyOnly"){return new fa(t,e,n,i,r,o,s).recognize()}var t_=31,fa=class{constructor(e,n,i,r,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new ua(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new U(4002,`'${e.segmentGroup}'`)}recognize(){let e=Bu(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(N(({children:n,rootSnapshot:i})=>{let r=new ye(i,n),s=new Xr("",r),o=lg(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let n=new un([],Object.freeze({}),Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),T,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,T,n).pipe(N(i=>({children:i,rootSnapshot:n})),Jt(i=>{if(i instanceof vi)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof _i?this.noMatchError(i):i}))}processSegmentGroup(e,n,i,r,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,n,i,s):this.processSegment(e,n,i,i.segments,r,!0,s).pipe(N(o=>o instanceof ye?[o]:[]))}processChildren(e,n,i,r){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return ae(s).pipe(Tt(o=>{let a=i.children[o],c=gg(n,o);return this.processSegmentGroup(e,c,a,o,r)}),Yc((o,a)=>(o.push(...a),o)),fo(null),Kc(),Ee(o=>{if(o===null)return an(i);let a=hd(o);return n_(a),I(a)}))}processSegment(e,n,i,r,s,o,a){return ae(n).pipe(Tt(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,i,r,s,o,a).pipe(Jt(l=>{if(l instanceof _i)return I(null);throw l}))),at(c=>!!c),Jt(c=>{if(ud(c))return Jg(i,r,s)?I(new ha):an(i);throw c}))}processSegmentAgainstRoute(e,n,i,r,s,o,a,c){return Zg(i,r,s,o)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,o,c):an(r):an(r)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=ya(n,r,s);if(!c)return an(n);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>t_&&(this.allowRedirects=!1));let f=new un(s,l,Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,$u(r),xe(r),r.component??r._loadedComponent??null,r,Wu(r)),p=Qr(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let w=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,f,e);return this.applyRedirects.lineralizeSegments(r,w).pipe(Ee(_=>this.processSegment(e,i,n,_.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,n,i,r,s,o){let a=Hg(n,i,r,e,this.urlSerializer);return i.path==="**"&&(n.children={}),a.pipe(Ie(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(Ie(({routes:l})=>{let u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=c,p=new un(h,d,Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,$u(i),xe(i),i.component??i._loadedComponent??null,i,Wu(i)),w=Qr(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(w.params),p.data=Object.freeze(w.data);let{segmentGroup:_,slicedSegments:D}=Bu(n,h,f,l);if(D.length===0&&_.hasChildren())return this.processChildren(u,l,_,p).pipe(N(ee=>new ye(p,ee)));if(l.length===0&&D.length===0)return I(new ye(p,[]));let H=xe(i)===s;return this.processSegment(u,l,_,D,H?T:s,!0,p).pipe(N(ee=>new ye(p,ee instanceof ye?[ee]:[])))}))):an(n)))}getChildConfig(e,n,i){return n.children?I({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?I({routes:n._loadedRoutes,injector:n._loadedInjector}):$g(e,n,i,this.urlSerializer).pipe(Ee(r=>r?this.configLoader.loadChildren(e,n).pipe(ne(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):Gg(n))):I({routes:[],injector:e})}};function n_(t){t.sort((e,n)=>e.value.outlet===T?-1:n.value.outlet===T?1:e.value.outlet.localeCompare(n.value.outlet))}function i_(t){let e=t.value.routeConfig;return e&&e.path===""}function hd(t){let e=[],n=new Set;for(let i of t){if(!i_(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),n.add(r)):e.push(i)}for(let i of n){let r=hd(i.children);e.push(new ye(i.value,r))}return e.filter(i=>!n.has(i))}function $u(t){return t.data||{}}function Wu(t){return t.resolve||{}}function r_(t,e,n,i,r,s){return Ee(o=>e_(t,e,n,i,o.extractedUrl,r,s).pipe(N(({state:a,tree:c})=>V(g({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function s_(t,e){return Ee(n=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return I(n);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of fd(c))o.add(l);let a=0;return ae(o).pipe(Tt(c=>s.has(c)?o_(c,i,t,e):(c.data=Qr(c,c.parent,t).resolve,I(void 0))),ne(()=>a++),po(1),Ee(c=>a===o.size?I(n):rt))})}function fd(t){let e=t.children.map(n=>fd(n)).flat();return[t,...e]}function o_(t,e,n,i){let r=t.routeConfig,s=t._resolve;return r?.title!==void 0&&!od(r)&&(s[yi]=r.title),a_(s,t,e,i).pipe(N(o=>(t._resolvedData=o,t.data=Qr(t,t.parent,n).resolve,null)))}function a_(t,e,n,i){let r=Wo(t);if(r.length===0)return I({});let s={};return ae(r).pipe(Ee(o=>l_(t[o],e,n,i).pipe(at(),ne(a=>{if(a instanceof gi)throw Zr(new ui,a);s[o]=a}))),po(1),qc(s),Jt(o=>ud(o)?rt:$n(o)))}function l_(t,e,n,i){let r=bi(e)??i,s=gn(t,r),o=s.resolve?s.resolve(e,n):De(r,()=>s(e,n));return mt(o)}function Bo(t){return Ie(e=>{let n=t(e);return n?ae(n).pipe(N(()=>e)):I(e)})}var pd=(()=>{let e=class e{buildTitle(i){let r,s=i.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===T);return r}getResolvedTitleForRoute(i){return i.data[yi]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>y(c_),providedIn:"root"});let t=e;return t})(),c_=(()=>{let e=class e extends pd{constructor(i){super(),this.title=i}updateTitle(i){let r=this.buildTitle(i);r!==void 0&&this.title.setTitle(r)}};e.\u0275fac=function(r){return new(r||e)(C(Fu))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ba=new k("",{providedIn:"root",factory:()=>({})}),u_=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!0,features:[re],decls:1,vars:0,template:function(r,s){r&1&&j(0,"router-outlet")},dependencies:[_a],encapsulation:2});let t=e;return t})();function wa(t){let e=t.children&&t.children.map(wa),n=e?V(g({},t),{children:e}):g({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==T&&(n.component=u_),n}var Ca=new k(""),d_=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=y(Eo)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return I(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=mt(i.loadComponent()).pipe(N(md),ne(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),en(()=>{this.componentLoaders.delete(i)})),s=new co(r,()=>new we).pipe(lo());return this.componentLoaders.set(i,s),s}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return I({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=h_(r,this.compiler,i,this.onLoadEndListener).pipe(en(()=>{this.childrenLoaders.delete(r)})),a=new co(o,()=>new we).pipe(lo());return this.childrenLoaders.set(r,a),a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function h_(t,e,n,i){return mt(t.loadChildren()).pipe(N(md),Ee(r=>r instanceof su||Array.isArray(r)?I(r):ae(e.compileModuleAsync(r))),N(r=>{i&&i(t);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(n).injector,o=s.get(Ca,[],{optional:!0,self:!0}).flat()),{routes:o.map(wa),injector:s}}))}function f_(t){return t&&typeof t=="object"&&"default"in t}function md(t){return f_(t)?t.default:t}var Ea=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>y(p_),providedIn:"root"});let t=e;return t})(),p_=(()=>{let e=class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),m_=new k("");var g_=new k(""),__=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new we,this.transitionAbortSubject=new we,this.configLoader=y(d_),this.environmentInjector=y(tn),this.urlSerializer=y(ma),this.rootContexts=y(es),this.location=y(Sr),this.inputBindingEnabled=y(va,{optional:!0})!==null,this.titleStrategy=y(pd),this.options=y(ba,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=y(Ea),this.createViewTransition=y(m_,{optional:!0}),this.navigationErrorHandler=y(g_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>I(void 0),this.rootComponentType=null;let i=s=>this.events.next(new Zo(s)),r=s=>this.events.next(new Jo(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let r=++this.navigationId;this.transitions?.next(V(g(g({},this.transitions.value),i),{id:r}))}setupNavigations(i,r,s){return this.transitions=new Ce({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:li,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(st(o=>o.id!==0),N(o=>V(g({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ie(o=>{let a=!1,c=!1;return I(o).pipe(Ie(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",be.SupersededByNewNavigation),rt;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?V(g({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Pt(l.id,this.urlSerializer.serialize(l.rawUrl),h,qo.IgnoredSameUrlNavigation)),l.resolve(!1),rt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return I(l).pipe(Ie(h=>{let f=this.transitions?.getValue();return this.events.next(new hi(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?rt:Promise.resolve(h)}),r_(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),ne(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=V(g({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new qr(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:w,extras:_}=l,D=new hi(h,this.urlSerializer.serialize(f),p,w);this.events.next(D);let H=rd(this.rootComponentType).snapshot;return this.currentTransition=o=V(g({},l),{targetSnapshot:H,urlAfterRedirects:f,extras:V(g({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,I(o)}else{let h="";return this.events.next(new Pt(l.id,this.urlSerializer.serialize(l.extractedUrl),h,qo.IgnoredByUrlHandlingStrategy)),l.resolve(!1),rt}}),ne(l=>{let u=new Ko(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),N(l=>(this.currentTransition=o=V(g({},l),{guards:Eg(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),kg(this.environmentInjector,l=>this.events.next(l)),ne(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Zr(this.urlSerializer,l.guardsResult);let u=new Yo(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),st(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",be.GuardRejected),!1)),Bo(l=>{if(l.guards.canActivateChecks.length)return I(l).pipe(ne(u=>{let d=new Qo(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Ie(u=>{let d=!1;return I(u).pipe(s_(this.paramsInheritanceStrategy,this.environmentInjector),ne({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",be.NoDataFromResolver)}}))}),ne(u=>{let d=new Xo(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),Bo(l=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ne(f=>{d.component=f}),N(()=>{})));for(let f of d.children)h.push(...u(f));return h};return Wn(u(l.targetSnapshot.root)).pipe(fo(null),ot(1))}),Bo(()=>this.afterPreactivation()),Ie(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return d?ae(d).pipe(N(()=>o)):I(o)}),N(l=>{let u=vg(i.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=V(g({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),ne(()=>{this.events.next(new pi)}),Cg(this.rootContexts,i.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ot(1),ne({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ze(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),cr(this.transitionAbortSubject.pipe(ne(l=>{throw l}))),en(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",be.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Jt(l=>{if(c=!0,cd(l))this.events.next(new Qe(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),wg(l)?this.events.next(new fn(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let u=new fi(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let d=De(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(d instanceof gi){let{message:h,cancellationCode:f}=Zr(this.urlSerializer,d);this.events.next(new Qe(o.id,this.urlSerializer.serialize(o.extractedUrl),h,f)),this.events.next(new fn(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(u);let h=i.errorHandler(l);o.resolve(!!h)}}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return rt}))}))}cancelNavigationTransition(i,r,s){let o=new Qe(i.id,this.urlSerializer.serialize(i.extractedUrl),r,s);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let i=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return i.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function v_(t){return t!==li}var y_=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>y(b_),providedIn:"root"});let t=e;return t})(),pa=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},b_=(()=>{let e=class e extends pa{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Rt(e)))(s||e)}})(),e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),gd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>y(w_),providedIn:"root"});let t=e;return t})(),w_=(()=>{let e=class e extends gd{constructor(){super(...arguments),this.location=y(Sr),this.urlSerializer=y(ma),this.options=y(ba,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=y(Ea),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Xe,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=rd(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{r.type==="popstate"&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof hi)this.stateMemento=this.createStateMemento();else if(i instanceof Pt)this.rawUrlTree=r.initialUrl;else if(i instanceof qr){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??s,r)}}else i instanceof pi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):i instanceof Qe&&(i.code===be.GuardRejected||i.code===be.NoDataFromResolver)?this.restoreHistory(r):i instanceof fi?this.restoreHistory(r,!0):i instanceof Ze&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){let s=i instanceof Xe?this.urlSerializer.serialize(i):i;if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let o=this.browserPageId,a=g(g({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(s,"",a)}else{let o=g(g({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(i,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&o===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Rt(e)))(s||e)}})(),e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),oi=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(oi||{});function C_(t,e){t.events.pipe(st(n=>n instanceof Ze||n instanceof Qe||n instanceof fi||n instanceof Pt),N(n=>n instanceof Ze||n instanceof Pt?oi.COMPLETE:(n instanceof Qe?n.code===be.Redirect||n.code===be.SupersededByNewNavigation:!1)?oi.REDIRECTING:oi.FAILED),st(n=>n!==oi.REDIRECTING),ot(1)).subscribe(()=>{e()})}function E_(t){throw t}var I_={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},S_={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},je=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=y(Cr),this.stateManager=y(gd),this.options=y(ba,{optional:!0})||{},this.pendingTasks=y(fr),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=y(__),this.urlSerializer=y(ma),this.location=y(Sr),this.urlHandlingStrategy=y(Ea),this._events=new we,this.errorHandler=this.options.errorHandler||E_,this.navigated=!1,this.routeReuseStrategy=y(y_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=y(Ca,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!y(va,{optional:!0}),this.eventsSubscription=new Bc,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Qe&&r.code!==be.Redirect&&r.code!==be.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ze)this.navigated=!0;else if(r instanceof fn){let a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),l=g({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||v_(s.source)},a);this.scheduleNavigation(c,li,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}A_(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),li,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)})}navigateToSyncWithBrowser(i,r,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=g({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(i);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(wa),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=g(g({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=ed(f)}catch{(typeof i[0]!="string"||i[0][0]!=="/")&&(i=[]),h=this.currentUrlTree.root}return td(h,i,d,u??null)}navigateByUrl(i,r={skipLocationChange:!1}){let s=kt(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,li,null,r)}navigate(i,r={skipLocationChange:!1}){return T_(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let s;if(r===!0?s=g({},I_):r===!1?s=g({},S_):s=r,kt(i))return Lu(this.currentUrlTree,i,s);let o=this.parseUrl(i);return Lu(this.currentUrlTree,o,s)}removeEmptyProps(i){return Object.entries(i).reduce((r,[s,o])=>(o!=null&&(r[s]=o),r),{})}scheduleNavigation(i,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((h,f)=>{c=h,l=f});let d=this.pendingTasks.add();return C_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function T_(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new U(4008,!1)}function A_(t){return!(t instanceof pi)&&!(t instanceof fn)}var mn=(()=>{let e=class e{constructor(i,r,s,o,a,c){this.router=i,this.route=r,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.onChanges=new we,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=i.events.subscribe(u=>{u instanceof Ze&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",i)}ngOnChanges(i){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(i){i==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(kt(i)?this.routerLinkInput=i:this.routerLinkInput=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0"))}onClick(i,r,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(i!==0||r||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let i=this.urlTree;this.href=i!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(i)):null;let r=this.href===null?null:nu(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(i,r){let s=this.renderer,o=this.el.nativeElement;r!==null?s.setAttribute(o,i,r):s.removeAttribute(o,i)}get urlTree(){return this.routerLinkInput===null?null:kt(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(r){return new(r||e)(v(je),v(Ft),Jc("tabindex"),v(ct),v(ve),v(Yn))},e.\u0275dir=q({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,s){r&1&&z("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&xt("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ut],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ut],replaceUrl:[2,"replaceUrl","replaceUrl",ut],routerLink:"routerLink"},standalone:!0,features:[gr,He]});let t=e;return t})(),ns=(()=>{let e=class e{get isActive(){return this._isActive}constructor(i,r,s,o,a){this.router=i,this.element=r,this.renderer=s,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new ue,this.routerEventsSubscription=i.events.subscribe(c=>{c instanceof Ze&&this.update()})}ngAfterContentInit(){I(this.links.changes,I(null)).pipe(uo()).subscribe(i=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let i=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=ae(i).pipe(uo()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(i){let r=Array.isArray(i)?i:i.split(" ");this.classes=r.filter(s=>!!s)}ngOnChanges(i){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let i=this.hasActiveLinks();this.classes.forEach(r=>{i?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),i&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==i&&(this._isActive=i,this.cdr.markForCheck(),this.isActiveChange.emit(i))})}isLinkActive(i){let r=D_(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return s=>{let o=s.urlTree;return o?i.isActive(o,r):!1}}hasActiveLinks(){let i=this.isLinkActive(this.router);return this.link&&i(this.link)||this.links.some(i)}};e.\u0275fac=function(r){return new(r||e)(v(je),v(ve),v(ct),v(Mt),v(mn,8))},e.\u0275dir=q({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(r,s,o){if(r&1&&au(o,mn,5),r&2){let a;bo(a=wo())&&(s.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[He]});let t=e;return t})();function D_(t){return!!t.paths}var R_=new k("");function _d(t,...e){return Dt([{provide:Ca,multi:!0,useValue:t},[],{provide:Ft,useFactory:x_,deps:[je]},{provide:Co,multi:!0,useFactory:M_},e.map(n=>n.\u0275providers)])}function x_(t){return t.routerState.root}function M_(){let t=y(hr);return e=>{let n=t.get(Ir);if(e!==n.components[0])return;let i=t.get(je),r=t.get(N_);t.get(O_)===1&&i.initialNavigation(),t.get(k_,null,mo.Optional)?.setUpPreloading(),t.get(R_,null,mo.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var N_=new k("",{factory:()=>new we}),O_=new k("",{providedIn:"root",factory:()=>1});var k_=new k("");var Td=(()=>{let e=class e{constructor(i,r){this._renderer=i,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(i,r){this._renderer.setProperty(this._elementRef.nativeElement,i,r)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}};e.\u0275fac=function(r){return new(r||e)(v(ct),v(ve))},e.\u0275dir=q({type:e});let t=e;return t})(),Ra=(()=>{let e=class e extends Td{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Rt(e)))(s||e)}})(),e.\u0275dir=q({type:e,features:[Fe]});let t=e;return t})(),Ti=new k("");var P_={provide:Ti,useExisting:At(()=>Ue),multi:!0};function F_(){let t=on()?on().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var L_=new k(""),Ue=(()=>{let e=class e extends Td{constructor(i,r,s){super(i,r),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!F_())}writeValue(i){let r=i??"";this.setProperty("value",r)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}};e.\u0275fac=function(r){return new(r||e)(v(ct),v(ve),v(L_,8))},e.\u0275dir=q({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&z("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Ke([P_]),Fe]});let t=e;return t})();function gt(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Ad(t){return t!=null&&typeof t.length=="number"}var xa=new k(""),Ma=new k(""),V_=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Me=class{static min(e){return j_(e)}static max(e){return U_(e)}static required(e){return B_(e)}static requiredTrue(e){return $_(e)}static email(e){return W_(e)}static minLength(e){return z_(e)}static maxLength(e){return G_(e)}static pattern(e){return H_(e)}static nullValidator(e){return Dd(e)}static compose(e){return kd(e)}static composeAsync(e){return Fd(e)}};function j_(t){return e=>{if(gt(e.value)||gt(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function U_(t){return e=>{if(gt(e.value)||gt(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function B_(t){return gt(t.value)?{required:!0}:null}function $_(t){return t.value===!0?null:{required:!0}}function W_(t){return gt(t.value)||V_.test(t.value)?null:{email:!0}}function z_(t){return e=>gt(e.value)||!Ad(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function G_(t){return e=>Ad(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function H_(t){if(!t)return Dd;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),i=>{if(gt(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}function Dd(t){return null}function Rd(t){return t!=null}function xd(t){return Er(t)?ae(t):t}function Md(t){let e={};return t.forEach(n=>{e=n!=null?g(g({},e),n):e}),Object.keys(e).length===0?null:e}function Nd(t,e){return e.map(n=>n(t))}function q_(t){return!t.validate}function Od(t){return t.map(e=>q_(e)?e:n=>e.validate(n))}function kd(t){if(!t)return null;let e=t.filter(Rd);return e.length==0?null:function(n){return Md(Nd(n,e))}}function Pd(t){return t!=null?kd(Od(t)):null}function Fd(t){if(!t)return null;let e=t.filter(Rd);return e.length==0?null:function(n){let i=Nd(n,e).map(xd);return Gc(i).pipe(N(Md))}}function Ld(t){return t!=null?Fd(Od(t)):null}function vd(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Vd(t){return t._rawValidators}function jd(t){return t._rawAsyncValidators}function Sa(t){return t?Array.isArray(t)?t:[t]:[]}function rs(t,e){return Array.isArray(t)?t.includes(e):t===e}function yd(t,e){let n=Sa(e);return Sa(t).forEach(r=>{rs(n,r)||n.push(r)}),n}function bd(t,e){return Sa(e).filter(n=>!rs(t,n))}var ss=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Pd(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Ld(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Lt=class extends ss{get formDirective(){return null}get path(){return null}},Vt=class extends ss{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},os=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},K_={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},nE=V(g({},K_),{"[class.ng-submitted]":"isSubmitted"}),vt=(()=>{let e=class e extends os{constructor(i){super(i)}};e.\u0275fac=function(r){return new(r||e)(v(Vt,2))},e.\u0275dir=q({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&rn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Fe]});let t=e;return t})(),ds=(()=>{let e=class e extends os{constructor(i){super(i)}};e.\u0275fac=function(r){return new(r||e)(v(Lt,10))},e.\u0275dir=q({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,s){r&2&&rn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Fe]});let t=e;return t})();var Ci="VALID",is="INVALID",_n="PENDING",Ei="DISABLED",_t=class{},as=class extends _t{constructor(e,n){super(),this.value=e,this.source=n}},Ii=class extends _t{constructor(e,n){super(),this.pristine=e,this.source=n}},Si=class extends _t{constructor(e,n){super(),this.touched=e,this.source=n}},vn=class extends _t{constructor(e,n){super(),this.status=e,this.source=n}},Ta=class extends _t{constructor(e){super(),this.source=e}},Aa=class extends _t{constructor(e){super(),this.source=e}};function Ud(t){return(hs(t)?t.validators:t)||null}function Y_(t){return Array.isArray(t)?Pd(t):t||null}function Bd(t,e){return(hs(e)?e.asyncValidators:t)||null}function Q_(t){return Array.isArray(t)?Ld(t):t||null}function hs(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function X_(t,e,n){let i=t.controls;if(!(e?Object.keys(i):i).length)throw new U(1e3,"");if(!i[n])throw new U(1001,"")}function Z_(t,e,n){t._forEachChild((i,r)=>{if(n[r]===void 0)throw new U(1002,"")})}var ls=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Kn(()=>this.statusReactive()),this.statusReactive=qn(void 0),this._pristine=Kn(()=>this.pristineReactive()),this.pristineReactive=qn(!0),this._touched=Kn(()=>this.touchedReactive()),this.touchedReactive=qn(!1),this._events=new we,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return dt(this.statusReactive)}set status(e){dt(()=>this.statusReactive.set(e))}get valid(){return this.status===Ci}get invalid(){return this.status===is}get pending(){return this.status==_n}get disabled(){return this.status===Ei}get enabled(){return this.status!==Ei}get pristine(){return dt(this.pristineReactive)}set pristine(e){dt(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return dt(this.touchedReactive)}set touched(e){dt(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(yd(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(yd(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(bd(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(bd(e,this._rawAsyncValidators))}hasValidator(e){return rs(this._rawValidators,e)}hasAsyncValidator(e){return rs(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(V(g({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new Si(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),n&&e.emitEvent!==!1&&this._events.next(new Si(!1,i))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(V(g({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new Ii(!1,i))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),n&&e.emitEvent!==!1&&this._events.next(new Ii(!0,i))}markAsPending(e={}){this.status=_n;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new vn(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(V(g({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ei,this.errors=null,this._forEachChild(r=>{r.disable(V(g({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new as(this.value,i)),this._events.next(new vn(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(V(g({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ci,this._forEachChild(i=>{i.enable(V(g({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(V(g({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ci||this.status===_n)&&this._runAsyncValidator(i,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new as(this.value,n)),this._events.next(new vn(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(V(g({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ei:Ci}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=_n,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let i=xd(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((i,r)=>i&&i._find(r),this)}getError(e,n){let i=n?this.get(n):this;return i&&i.errors?i.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new vn(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,i)}_initObservables(){this.valueChanges=new ue,this.statusChanges=new ue}_calculateStatus(){return this._allControlsDisabled()?Ei:this.errors?is:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_n)?_n:this._anyControlsHaveStatus(is)?is:Ci}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),r&&this._events.next(new Ii(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new Si(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){hs(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Y_(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Q_(this._rawAsyncValidators)}},yn=class extends ls{constructor(e,n,i){super(Ud(n),Bd(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,i={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){Z_(this,!0,e),Object.keys(e).forEach(i=>{X_(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,i)=>(e[i]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,i)=>i._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let i=this.controls[n];i&&e(i,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,i]of Object.entries(this.controls))if(this.contains(n)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,i,r)=>((i.enabled||this.disabled)&&(n[r]=i.value),n))}_reduceChildren(e,n){let i=e;return this._forEachChild((r,s)=>{i=n(i,r,s)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var fs=new k("CallSetDisabledState",{providedIn:"root",factory:()=>ps}),ps="always";function $d(t,e){return[...e.path,t]}function Da(t,e,n=ps){Na(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),ev(t,e),nv(t,e),tv(t,e),J_(t,e)}function wd(t,e,n=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),us(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function cs(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function J_(t,e){if(e.valueAccessor.setDisabledState){let n=i=>{e.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Na(t,e){let n=Vd(t);e.validator!==null?t.setValidators(vd(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let i=jd(t);e.asyncValidator!==null?t.setAsyncValidators(vd(i,e.asyncValidator)):typeof i=="function"&&t.setAsyncValidators([i]);let r=()=>t.updateValueAndValidity();cs(e._rawValidators,r),cs(e._rawAsyncValidators,r)}function us(t,e){let n=!1;if(t!==null){if(e.validator!==null){let r=Vd(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.validator);s.length!==r.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let r=jd(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(n=!0,t.setAsyncValidators(s))}}}let i=()=>{};return cs(e._rawValidators,i),cs(e._rawAsyncValidators,i),n}function ev(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Wd(t,e)})}function tv(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Wd(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Wd(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function nv(t,e){let n=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function iv(t,e){t==null,Na(t,e)}function rv(t,e){return us(t,e)}function zd(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function sv(t){return Object.getPrototypeOf(t.constructor)===Ra}function ov(t,e){t._syncPendingControls(),e.forEach(n=>{let i=n.control;i.updateOn==="submit"&&i._pendingChange&&(n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Gd(t,e){if(!e)return null;Array.isArray(e);let n,i,r;return e.forEach(s=>{s.constructor===Ue?n=s:sv(s)?i=s:r=s}),r||i||n||null}function av(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Cd(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Ed(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Ne=class extends ls{constructor(e=null,n,i){super(Ud(n),Bd(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hs(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Ed(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Cd(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Cd(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Ed(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var lv=t=>t instanceof Ne;var cv={provide:Vt,useExisting:At(()=>Ai)},Id=Promise.resolve(),Ai=(()=>{let e=class e extends Vt{constructor(i,r,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new Ne,this._registered=!1,this.name="",this.update=new ue,this._parent=i,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=Gd(this,o)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let r=i.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),zd(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Da(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){Id.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let r=i.isDisabled.currentValue,s=r!==0&&ut(r);Id.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?$d(i,this._parent):[i]}};e.\u0275fac=function(r){return new(r||e)(v(Lt,9),v(xa,10),v(Ma,10),v(Ti,10),v(Mt,8),v(fs,8))},e.\u0275dir=q({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ke([cv]),Fe,He]});let t=e;return t})(),ms=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=q({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var Hd=new k("");var uv={provide:Lt,useExisting:At(()=>Di)},Di=(()=>{let e=class e extends Lt{get submitted(){return dt(this._submittedReactive)}set submitted(i){this._submittedReactive.set(i)}constructor(i,r,s){super(),this.callSetDisabledState=s,this._submitted=Kn(()=>this._submittedReactive()),this._submittedReactive=qn(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ue,this._setValidators(i),this._setAsyncValidators(r)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(us(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let r=this.form.get(i.path);return Da(r,i,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),r}getControl(i){return this.form.get(i.path)}removeControl(i){wd(i.control||null,i,!1),av(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,r){this.form.get(i.path).setValue(r)}onSubmit(i){return this._submittedReactive.set(!0),ov(this.form,this.directives),this.ngSubmit.emit(i),this.form._events.next(new Ta(this.control)),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this._submittedReactive.set(!1),this.form._events.next(new Aa(this.form))}_updateDomValue(){this.directives.forEach(i=>{let r=i.control,s=this.form.get(i.path);r!==s&&(wd(r||null,i),lv(s)&&(Da(s,i,this.callSetDisabledState),i.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let r=this.form.get(i.path);iv(r,i),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let r=this.form.get(i.path);r&&rv(r,i)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Na(this.form,this),this._oldForm&&us(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(r){return new(r||e)(v(xa,10),v(Ma,10),v(fs,8))},e.\u0275dir=q({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&z("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ke([uv]),Fe,He]});let t=e;return t})();var dv={provide:Vt,useExisting:At(()=>Ri)},Ri=(()=>{let e=class e extends Vt{set isDisabled(i){}constructor(i,r,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new ue,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=Gd(this,o)}ngOnChanges(i){this._added||this._setUpControl(),zd(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return $d(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(r){return new(r||e)(v(Lt,13),v(xa,10),v(Ma,10),v(Ti,10),v(Hd,8))},e.\u0275dir=q({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Ke([dv]),Fe,He]});let t=e;return t})(),hv={provide:Ti,useExisting:At(()=>gs),multi:!0};function qd(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function fv(t){return t.split(":")[0]}var gs=(()=>{let e=class e extends Ra{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){this.value=i;let r=this._getOptionId(i),s=qd(r,i);this.setProperty("value",s)}registerOnChange(i){this.onChange=r=>{this.value=this._getOptionValue(r),i(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(i){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),i))return r;return null}_getOptionValue(i){let r=fv(i);return this._optionMap.has(r)?this._optionMap.get(r):i}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Rt(e)))(s||e)}})(),e.\u0275dir=q({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,s){r&1&&z("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ke([hv]),Fe]});let t=e;return t})(),Kd=(()=>{let e=class e{constructor(i,r,s){this._element=i,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(i){this._select!=null&&(this._select._optionMap.set(this.id,i),this._setElementValue(qd(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._setElementValue(i),this._select&&this._select.writeValue(this._select.value)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(v(ve),v(ct),v(gs,9))},e.\u0275dir=q({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),pv={provide:Ti,useExisting:At(()=>Yd),multi:!0};function Sd(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function mv(t){return t.split(":")[0]}var Yd=(()=>{let e=class e extends Ra{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){this.value=i;let r;if(Array.isArray(i)){let s=i.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else r=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(i){this.onChange=r=>{let s=[],o=r.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],u=this._getOptionValue(l.value);s.push(u)}}else{let a=r.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let u=this._getOptionValue(l.value);s.push(u)}}}this.value=s,i(s)}}_registerOption(i){let r=(this._idCounter++).toString();return this._optionMap.set(r,i),r}_getOptionId(i){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,i))return r;return null}_getOptionValue(i){let r=mv(i);return this._optionMap.has(r)?this._optionMap.get(r)._value:i}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Rt(e)))(s||e)}})(),e.\u0275dir=q({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,s){r&1&&z("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ke([pv]),Fe]});let t=e;return t})(),Qd=(()=>{let e=class e{constructor(i,r,s){this._element=i,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(i){this._select!=null&&(this._value=i,this._setElementValue(Sd(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._select?(this._value=i,this._setElementValue(Sd(this.id,i)),this._select.writeValue(this._select.value)):this._setElementValue(i)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}_setSelected(i){this._renderer.setProperty(this._element.nativeElement,"selected",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(v(ve),v(ct),v(Yd,9))},e.\u0275dir=q({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var Xd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ce({type:e}),e.\u0275inj=le({});let t=e;return t})();var _s=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:fs,useValue:i.callSetDisabledState??ps}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ce({type:e}),e.\u0275inj=le({imports:[Xd]});let t=e;return t})(),vs=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:Hd,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:fs,useValue:i.callSetDisabledState??ps}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ce({type:e}),e.\u0275inj=le({imports:[Xd]});let t=e;return t})();function bs(t){return t!=null&&`${t}`!="false"}function Oa(t){return Array.isArray(t)?t:[t]}function ka(t){return t instanceof ve?t.nativeElement:t}var Pa;try{Pa=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Pa=!1}var Mi=(()=>{let e=class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?_u(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Pa)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(C(qe))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var xi;function gv(){if(xi==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>xi=!0}))}finally{xi=xi||!1}return xi}function Fa(t){return gv()?t:!!t.capture}function Zd(t){return t.composedPath?t.composedPath()[0]:t.target}function Jd(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var th=new Set,jt,_v=(()=>{let e=class e{constructor(i,r){this._platform=i,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):yv}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&vv(i,this._nonce),this._matchMedia(i)}};e.\u0275fac=function(r){return new(r||e)(C(Mi),C(Gn,8))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function vv(t,e){if(!th.has(t))try{jt||(jt=document.createElement("style"),e&&jt.setAttribute("nonce",e),jt.setAttribute("type","text/css"),document.head.appendChild(jt)),jt.sheet&&(jt.sheet.insertRule(`@media ${t} {body{ }}`,0),th.add(t))}catch(n){console.error(n)}}function yv(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var ih=(()=>{let e=class e{constructor(i,r){this._mediaMatcher=i,this._zone=r,this._queries=new Map,this._destroySubject=new we}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return nh(Oa(i)).some(s=>this._registerQuery(s).mql.matches)}observe(i){let s=nh(Oa(i)).map(a=>this._registerQuery(a).observable),o=Wn(s);return o=ar(o.pipe(ot(1)),o.pipe(Qc(1),Hc(0))),o.pipe(N(a=>{let c={matches:!1,breakpoints:{}};return a.forEach(({matches:l,query:u})=>{c.matches=c.matches||l,c.breakpoints[u]=l}),c}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let r=this._mediaMatcher.matchMedia(i),o={observable:new Bn(a=>{let c=l=>this._zone.run(()=>a.next(l));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(lr(r),N(({matches:a})=>({query:i,matches:a})),cr(this._destroySubject)),mql:r};return this._queries.set(i,o),o}};e.\u0275fac=function(r){return new(r||e)(C(_v),C(fe))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function nh(t){return t.map(e=>e.split(",")).reduce((e,n)=>e.concat(n)).map(e=>e.trim())}function oh(t){return t.buttons===0||t.detail===0}function ah(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Ut=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(Ut||{}),rh="cdk-high-contrast-black-on-white",sh="cdk-high-contrast-white-on-black",La="cdk-high-contrast-active",lh=(()=>{let e=class e{constructor(i,r){this._platform=i,this._document=r,this._breakpointSubscription=y(ih).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ut.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let r=this._document.defaultView||window,s=r&&r.getComputedStyle?r.getComputedStyle(i):null,o=(s&&s.backgroundColor||"").replace(/ /g,"");switch(i.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ut.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ut.BLACK_ON_WHITE}return Ut.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(La,rh,sh),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===Ut.BLACK_ON_WHITE?i.add(La,rh):r===Ut.WHITE_ON_BLACK&&i.add(La,sh)}}};e.\u0275fac=function(r){return new(r||e)(C(Mi),C(X))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Va=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ce({type:e}),e.\u0275inj=le({});let t=e;return t})();function wv(){return!0}var Cv=new k("mat-sanity-checks",{providedIn:"root",factory:wv}),Ba=(()=>{let e=class e{constructor(i,r,s){this._sanityChecks=r,this._document=s,this._hasDoneGlobalChecks=!1,i._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(i){return Jd()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[i]}};e.\u0275fac=function(r){return new(r||e)(C(lh),C(Cv,8),C(X))},e.\u0275mod=ce({type:e}),e.\u0275inj=le({imports:[Va,Va]});let t=e;return t})();var Te=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Te||{}),ja=class{constructor(e,n,i,r=!1){this._renderer=e,this.element=n,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=Te.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},ch=Fa({passive:!0,capture:!0}),Ua=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let n=Zd(e);n&&this._events.get(e.type)?.forEach((i,r)=>{(r===n||r.contains(n))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,n,i,r){let s=this._events.get(n);if(s){let o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(n,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,ch)})}removeHandler(e,n,i){let r=this._events.get(e);if(!r)return;let s=r.get(n);s&&(s.delete(i),s.size===0&&r.delete(n),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,ch)))}},uh={enterDuration:225,exitDuration:150},Ev=800,dh=Fa({passive:!0,capture:!0}),hh=["mousedown","touchstart"],fh=["mouseup","mouseleave","touchend","touchcancel"],Ni=class Ni{constructor(e,n,i,r){this._target=e,this._ngZone=n,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ka(i))}fadeInRipple(e,n,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=g(g({},uh),i.animation);i.centered&&(e=r.left+r.width/2,n=r.top+r.height/2);let o=i.radius||Iv(e,n,r),a=e-r.left,c=n-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-o}px`,u.style.top=`${c-o}px`,u.style.height=`${o*2}px`,u.style.width=`${o*2}px`,i.color!=null&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);let d=window.getComputedStyle(u),h=d.transitionProperty,f=d.transitionDuration,p=h==="none"||f==="0s"||f==="0s, 0s"||r.width===0&&r.height===0,w=new ja(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",w.state=Te.FADING_IN,i.persistent||(this._mostRecentTransientRipple=w);let _=null;return!p&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let D=()=>{_&&(_.fallbackTimer=null),clearTimeout(ee),this._finishRippleTransition(w)},H=()=>this._destroyRipple(w),ee=setTimeout(H,l+100);u.addEventListener("transitionend",D),u.addEventListener("transitioncancel",H),_={onTransitionEnd:D,onTransitionCancel:H,fallbackTimer:ee}}),this._activeRipples.set(w,_),(p||!l)&&this._finishRippleTransition(w),w}fadeOutRipple(e){if(e.state===Te.FADING_OUT||e.state===Te.HIDDEN)return;let n=e.element,i=g(g({},uh),e.config.animation);n.style.transitionDuration=`${i.exitDuration}ms`,n.style.opacity="0",e.state=Te.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let n=ka(e);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,hh.forEach(i=>{Ni._eventManager.addHandler(this._ngZone,i,n,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{fh.forEach(n=>{this._triggerElement.addEventListener(n,this,dh)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Te.FADING_IN?this._startFadeOutTransition(e):e.state===Te.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let n=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=Te.VISIBLE,!i&&(!n||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let n=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Te.HIDDEN,n!==null&&(e.element.removeEventListener("transitionend",n.onTransitionEnd),e.element.removeEventListener("transitioncancel",n.onTransitionCancel),n.fallbackTimer!==null&&clearTimeout(n.fallbackTimer)),e.element.remove()}_onMousedown(e){let n=oh(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+Ev;!this._target.rippleDisabled&&!n&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!ah(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let n=e.changedTouches;if(n)for(let i=0;i<n.length;i++)this.fadeInRipple(n[i].clientX,n[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let n=e.state===Te.VISIBLE||e.config.terminateOnPointerUp&&e.state===Te.FADING_IN;!e.config.persistent&&n&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(hh.forEach(n=>Ni._eventManager.removeHandler(n,e,this)),this._pointerUpEventsRegistered&&(fh.forEach(n=>e.removeEventListener(n,this,dh)),this._pointerUpEventsRegistered=!1))}};Ni._eventManager=new Ua;var ph=Ni;function Iv(t,e,n){let i=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),r=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(i*i+r*r)}var mh=(()=>{let e=class e{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(i){this._vertical=bs(i)}get inset(){return this._inset}set inset(i){this._inset=bs(i)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ie({type:e,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(r,s){r&2&&(xt("aria-orientation",s.vertical?"vertical":"horizontal"),rn("mat-divider-vertical",s.vertical)("mat-divider-horizontal",!s.vertical)("mat-divider-inset",s.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[re],decls:0,vars:0,template:function(r,s){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0});let t=e;return t})(),gh=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ce({type:e}),e.\u0275inj=le({imports:[Ba,Ba]});let t=e;return t})();var Be=(()=>{class t{http;constructor(n){this.http=n}signUp(n,i,r){this.http.post("https://brainyclub-eu.backendless.app/api/users/register",{email:n.getEmail(),password:i,firstName:n.getFirstName(),lastName:n.getLastName(),sex:n.getSex()},{headers:new de({"Content-Type":"application/json"})}).subscribe(s=>{s!==null&&r()})}login(n,i,r){this.http.post("https://brainyclub-eu.backendless.app/api/users/login",{login:n,password:i},{headers:new de({"Content-Type":"application/json"})}).subscribe(s=>{s["user-token"]!==null&&r(s.email,s["user-token"],s.objectId)})}loginWithProvider(n){this.http.post("https://brainyclub-eu.backendless.app/api/users/oauth/googleplus/login",{accessToken:n.credential},{headers:new de({"Content-Type":"application/json"})}).subscribe(i=>{console.log(i)})}logout(){this.http.get("https://brainyclub-eu.backendless.app/api/users/logout",{headers:new de({"user-token":localStorage.getItem("userToken")})})}findUsers(n,i,r){this.http.get(`https://brainyclub-eu.backendless.app/api/data/Users?where=firstName%20%3D%20'${n}'`,{headers:new de({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(s=>{r(s)})}getFullName(n,i){this.http.get(`https://brainyclub-eu.backendless.app/api/data/Users/${n}?property=%60firstName%60&property=%60lastName%60`,{headers:new de({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(r=>{i(r)})}static \u0275fac=function(i){return new(i||t)(C(xo))};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var _h=(()=>{class t{authService;router;constructor(n,i){this.authService=n,this.router=i,google.accounts.id.initialize({client_id:"205706621989-pken44sei0ti29vd95ukk3o2ja4e4gh1.apps.googleusercontent.com",callback:this.handleCredential.bind(this)})}ngOnInit(){}loginGroup=new yn({email:new Ne("",[Me.email]),password:new Ne("",[Me.minLength(8)])});onSubmitLogin(){this.loginGroup.valid&&this.authService.login(this.loginGroup.value.email,this.loginGroup.value.password,(n,i,r)=>{localStorage.setItem("email",n),localStorage.setItem("userToken",i),localStorage.setItem("objectId",r),localStorage.getItem("email")!==null&&localStorage.getItem("userToken")!==null&&localStorage.getItem("objectId")!==null&&this.router.navigate(["/home"])})}login(){google.accounts.id.prompt()}handleCredential(n){this.authService.loginWithProvider(n)}static \u0275fac=function(i){return new(i||t)(v(Be),v(je))};static \u0275cmp=ie({type:t,selectors:[["app-login"]],standalone:!0,features:[re],decls:32,vars:1,consts:[[1,"h-full","w-full","bg-white"],[1,"flex","justify-between","items-center","p-6"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","72px","width","72px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"mr-2"],["routerLink","/signup","routerLinkActive","active",1,"border","border-gray-300","rounded-md","px-2","py-1"],[1,"w-2/6","h-1/2","flex","flex-col","justify-evenly","ml-auto","mr-auto","absolute","left-1/2","top-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"h-9","border","rounded-md","flex","items-center","justify-center","py-2",3,"click"],["src","./assets/google-icon.png",1,"w-7","h-7"],[1,"flex","justify-between","items-center"],[1,"w-[45%]"],[1,"h-3/6","flex","flex-col","justify-between",3,"ngSubmit","formGroup"],[1,"flex","flex-col"],[1,"text-xl","font-bold"],["placeholder","Email","formControlName","email",1,"text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["type","password","placeholder","Password","formControlName","password",1,"text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],[1,"bg-green-600","text-white","h-9","text-xl","font-light","rounded-md"]],template:function(i,r){i&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),lt(),b(3,"svg",3),j(4,"path",4),E(),nn(),b(5,"p",5),F(6,"Chat"),E()(),b(7,"div",2)(8,"p",6),F(9,"New to Chat?"),E(),b(10,"button",7),F(11," Create an account "),E()()(),b(12,"div",8)(13,"button",9),z("click",function(){return r.login()}),j(14,"img",10),F(15,"\xA0Sign in using Google "),E(),b(16,"div",11),j(17,"mat-divider",12),b(18,"p"),F(19,"Or"),E(),j(20,"mat-divider",12),E(),b(21,"form",13),z("ngSubmit",function(){return r.onSubmitLogin()}),b(22,"div",14)(23,"label",15),F(24,"Email"),E(),j(25,"input",16),E(),b(26,"div",14)(27,"label",15),F(28,"Password"),E(),j(29,"input",17),E(),b(30,"button",18),F(31," Login "),E()()()()),i&2&&(W(21),K("formGroup",r.loginGroup))},dependencies:[mn,ns,vs,ms,Ue,vt,ds,Di,Ri,Ye,gh,mh]})}return t})();var ws=class{firstName;lastName;email;sex;objectId;constructor(e,n,i,r,s){this.firstName=e,this.lastName=n,this.email=i,this.sex=r,this.objectId=s}getFirstName(){return this.firstName}getLastName(){return this.lastName}getEmail(){return this.email}getSex(){return this.sex}};var vh=(()=>{class t{authService;router;constructor(n,i){this.authService=n,this.router=i}signUpForm=new yn({firstName:new Ne("",[Me.nullValidator]),lastName:new Ne("",[Me.nullValidator]),sex:new Ne("Sex"),email:new Ne("",[Me.email,Me.nullValidator]),password:new Ne("",[Me.minLength(8)])});onSubmit(){this.signUpForm.valid&&this.authService.signUp(new ws(this.signUpForm.value.firstName,this.signUpForm.value.lastName,this.signUpForm.value.email,this.signUpForm.value.sex,""),this.signUpForm.value.password,()=>{this.router.navigate(["/login"])})}static \u0275fac=function(i){return new(i||t)(v(Be),v(je))};static \u0275cmp=ie({type:t,selectors:[["app-signup"]],standalone:!0,features:[re],decls:27,vars:1,consts:[[1,"h-full","w-full","bg-white"],[1,"h-1/2","flex","flex-col","justify-evenly","items-center","absolute","left-1/2","top-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"flex","justify-center","items-center","w-full"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","72px","width","72px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"text-3xl"],[1,"flex","flex-col",3,"ngSubmit","formGroup"],[1,"flex"],["placeholder","First Name","formControlName","firstName",1,"text-xl","font-light","h-9","px-2","mr-1","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["placeholder","Last Name","formControlName","lastName",1,"text-xl","font-light","h-9","px-2","ml-1","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["formControlName","sex",1,"text-xl","font-light","mt-4","px-2","outline-none","focus:border-blue-600","border-gray-300","border","rounded-md","h-9"],["placeholder","Email","type","email","formControlName","email",1,"text-xl","font-light","h-9","mt-4","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["placeholder","Password","type","password","formControlName","password",1,"text-xl","font-light","h-9","mt-4","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],[1,"bg-green-600","mt-8","text-white","h-9","text-xl","font-light","rounded-md"],[1,"flex","mt-1"],["routerLink","/login","routerLinkActive","active",1,"ml-1","text-blue-600","underline"]],template:function(i,r){i&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),lt(),b(3,"svg",3),j(4,"path",4),E(),nn(),b(5,"p",5),F(6,"Chat"),E()(),b(7,"p",6),F(8,"Create an account"),E(),b(9,"form",7),z("ngSubmit",function(){return r.onSubmit()}),b(10,"div",8),j(11,"input",9)(12,"input",10),E(),b(13,"select",11)(14,"option"),F(15,"Male"),E(),b(16,"option"),F(17,"Female"),E()(),j(18,"input",12)(19,"input",13),b(20,"button",14),F(21," Signup "),E(),b(22,"div",15)(23,"p"),F(24,"Alreay have an account?"),E(),b(25,"a",16),F(26,"Login"),E()()()()()),i&2&&(W(9),K("formGroup",r.signUpForm))},dependencies:[mn,ns,vs,ms,Kd,Qd,Ue,gs,vt,ds,Di,Ri]})}return t})();var $a={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var m=function(t,e){if(!t)throw $t(e)},$t=function(t){return new Error("Firebase Database ("+$a.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var bh=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Tv=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Es={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(h=64)),i.push(n[u],n[d],n[h],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bh(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Tv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let l=r<t.length?n[t.charAt(r)]:64;++r;let d=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||l==null||d==null)throw new Wa;let h=s<<2|a>>4;if(i.push(h),l!==64){let f=a<<4&240|l>>2;if(i.push(f),d!==64){let p=l<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Wa=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Ga=function(t){let e=bh(t);return Es.encodeByteArray(e,!0)},ki=function(t){return Ga(t).replace(/\./g,"")},za=function(t){try{return Es.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function wh(t){return Ch(void 0,t)}function Ch(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!Av(n)||(t[n]=Ch(t[n],e[n]));return t}function Av(t){return t!=="__proto__"}function Dv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Rv=()=>Dv().__FIREBASE_DEFAULTS__,xv=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Mv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&za(t[1]);return e&&JSON.parse(e)},Eh=()=>{try{return Rv()||xv()||Mv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Nv=t=>{var e,n;return(n=(e=Eh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Ih=t=>{let e=Nv(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},Ha=()=>{var t;return(t=Eh())===null||t===void 0?void 0:t.config};var yt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function Sh(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ki(JSON.stringify(n)),ki(JSON.stringify(o)),""].join(".")}function Ov(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qa(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ov())}function Th(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $e(){return $a.NODE_CLIENT===!0||$a.NODE_ADMIN===!0}function Ah(){try{return typeof indexedDB=="object"}catch{return!1}}function Dh(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var kv="FirebaseError",Bt=class t extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=kv,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pi.prototype.create)}},Pi=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Pv(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Bt(r,a,i)}};function Pv(t,e){return t.replace(Fv,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Fv=/\{\$([^}]+)}/g;function bn(t){return JSON.parse(t)}function Z(t){return JSON.stringify(t)}var Rh=function(t){let e={},n={},i={},r="";try{let s=t.split(".");e=bn(za(s[0])||""),n=bn(za(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}};var xh=function(t){let e=Rh(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Mh=function(t){let e=Rh(t).claims;return typeof e=="object"&&e.admin===!0};function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Wt(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ka(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fi(t,e,n){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function Is(t,e){if(t===e)return!0;let n=Object.keys(t),i=Object.keys(e);for(let r of n){if(!i.includes(r))return!1;let s=t[r],o=e[r];if(yh(s)&&yh(o)){if(!Is(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!n.includes(r))return!1;return!0}function yh(t){return t!==null&&typeof t=="object"}function Nh(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Cs=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){let h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(h<<1|h>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let d=0;d<80;d++){d<40?d<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):d<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let h=(r<<5|r>>>27)+l+c+u+i[d]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let i=n-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function Ss(t,e){return`${t} failed: ${e} argument `}var Oh=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,m(i<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Li=function(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};var CI=4*60*60*1e3;function wn(t){return t&&t._delegate?t._delegate:t}var Je=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var zt="[DEFAULT]";var Ts=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let i=new yt;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Vv(e))try{this.getOrInitializeService({instanceIdentifier:zt})}catch{}for(let[n,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=zt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return Q(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=zt){return this.instances.has(e)}getOptions(e=zt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;let r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let i=this.onInitCallbacks.get(n);if(i)for(let r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Lv(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=zt){return this.component?this.component.multipleInstances?e:zt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Lv(t){return t===zt?void 0:t}function Vv(t){return t.instantiationMode==="EAGER"}var Vi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new Ts(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var jv=[],B=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(B||{}),Uv={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},Bv=B.INFO,$v={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},Wv=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=$v[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Cn=class{constructor(e){this.name=e,this._logLevel=Bv,this._logHandler=Wv,this._userLogHandler=null,jv.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in B))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Uv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...e),this._logHandler(this,B.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...e),this._logHandler(this,B.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,B.INFO,...e),this._logHandler(this,B.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,B.WARN,...e),this._logHandler(this,B.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,B.ERROR,...e),this._logHandler(this,B.ERROR,...e)}};var zv=(t,e)=>e.some(n=>t instanceof n),kh,Ph;function Gv(){return kh||(kh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hv(){return Ph||(Ph=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Fh=new WeakMap,Qa=new WeakMap,Lh=new WeakMap,Ya=new WeakMap,Za=new WeakMap;function qv(t){let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ze(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Fh.set(n,t)}).catch(()=>{}),Za.set(e,t),e}function Kv(t){if(Qa.has(t))return;let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Qa.set(t,e)}var Xa={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Qa.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Lh.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ze(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Vh(t){Xa=t(Xa)}function Yv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let i=t.call(As(this),e,...n);return Lh.set(i,e.sort?e.sort():[e]),ze(i)}:Hv().includes(t)?function(...e){return t.apply(As(this),e),ze(Fh.get(this))}:function(...e){return ze(t.apply(As(this),e))}}function Qv(t){return typeof t=="function"?Yv(t):(t instanceof IDBTransaction&&Kv(t),zv(t,Gv())?new Proxy(t,Xa):t)}function ze(t){if(t instanceof IDBRequest)return qv(t);if(Ya.has(t))return Ya.get(t);let e=Qv(t);return e!==t&&(Ya.set(t,e),Za.set(e,t)),e}var As=t=>Za.get(t);function Uh(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(t,e),a=ze(o);return i&&o.addEventListener("upgradeneeded",c=>{i(ze(o.result),c.oldVersion,c.newVersion,ze(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var Xv=["get","getKey","getAll","getAllKeys","count"],Zv=["put","add","delete","clear"],Ja=new Map;function jh(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ja.get(e))return Ja.get(e);let n=e.replace(/FromIndex$/,""),i=e!==n,r=Zv.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Xv.includes(n)))return;let s=function(o,...a){return Q(this,null,function*(){let c=this.transaction(o,r?"readwrite":"readonly"),l=c.store;return i&&(l=l.index(a.shift())),(yield Promise.all([l[n](...a),r&&c.done]))[0]})};return Ja.set(e,s),s}Vh(t=>V(g({},t),{get:(e,n,i)=>jh(e,n)||t.get(e,n,i),has:(e,n)=>!!jh(e,n)||t.has(e,n)}));var tl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Jv(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function Jv(t){let e=t.getComponent();return e?.type==="VERSION"}var nl="@firebase/app",Bh="0.10.7";var Gt=new Cn("@firebase/app"),ey="@firebase/app-compat",ty="@firebase/analytics-compat",ny="@firebase/analytics",iy="@firebase/app-check-compat",ry="@firebase/app-check",sy="@firebase/auth",oy="@firebase/auth-compat",ay="@firebase/database",ly="@firebase/database-compat",cy="@firebase/functions",uy="@firebase/functions-compat",dy="@firebase/installations",hy="@firebase/installations-compat",fy="@firebase/messaging",py="@firebase/messaging-compat",my="@firebase/performance",gy="@firebase/performance-compat",_y="@firebase/remote-config",vy="@firebase/remote-config-compat",yy="@firebase/storage",by="@firebase/storage-compat",wy="@firebase/firestore",Cy="@firebase/vertexai-preview",Ey="@firebase/firestore-compat",Iy="firebase",Sy="10.12.4";var il="[DEFAULT]",Ty={[nl]:"fire-core",[ey]:"fire-core-compat",[ny]:"fire-analytics",[ty]:"fire-analytics-compat",[ry]:"fire-app-check",[iy]:"fire-app-check-compat",[sy]:"fire-auth",[oy]:"fire-auth-compat",[ay]:"fire-rtdb",[ly]:"fire-rtdb-compat",[cy]:"fire-fn",[uy]:"fire-fn-compat",[dy]:"fire-iid",[hy]:"fire-iid-compat",[fy]:"fire-fcm",[py]:"fire-fcm-compat",[my]:"fire-perf",[gy]:"fire-perf-compat",[_y]:"fire-rc",[vy]:"fire-rc-compat",[yy]:"fire-gcs",[by]:"fire-gcs-compat",[wy]:"fire-fst",[Ey]:"fire-fst-compat",[Cy]:"fire-vertex","fire-js":"fire-js",[Iy]:"fire-js-all"};var Ds=new Map,Ay=new Map,rl=new Map;function $h(t,e){try{t.container.addComponent(e)}catch(n){Gt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ji(t){let e=t.name;if(rl.has(e))return Gt.debug(`There were multiple attempts to register component ${e}.`),!1;rl.set(e,t);for(let n of Ds.values())$h(n,t);for(let n of Ay.values())$h(n,t);return!0}function Hh(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var Dy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bt=new Pi("app","Firebase",Dy);var sl=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Je("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bt.create("app-deleted",{appName:this._name})}};var qh=Sy;function ll(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let i=Object.assign({name:il,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw bt.create("bad-app-name",{appName:String(r)});if(n||(n=Ha()),!n)throw bt.create("no-options");let s=Ds.get(r);if(s){if(Is(n,s.options)&&Is(i,s.config))return s;throw bt.create("duplicate-app",{appName:r})}let o=new Vi(r);for(let c of rl.values())o.addComponent(c);let a=new sl(n,i,o);return Ds.set(r,a),a}function Kh(t=il){let e=Ds.get(t);if(!e&&t===il&&Ha())return ll();if(!e)throw bt.create("no-app",{appName:t});return e}function wt(t,e,n){var i;let r=(i=Ty[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gt.warn(a.join(" "));return}ji(new Je(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var Ry="firebase-heartbeat-database",xy=1,Ui="firebase-heartbeat-store",el=null;function Yh(){return el||(el=Uh(Ry,xy,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ui)}catch(n){console.warn(n)}}}}).catch(t=>{throw bt.create("idb-open",{originalErrorMessage:t.message})})),el}function My(t){return Q(this,null,function*(){try{let n=(yield Yh()).transaction(Ui),i=yield n.objectStore(Ui).get(Qh(t));return yield n.done,i}catch(e){if(e instanceof Bt)Gt.warn(e.message);else{let n=bt.create("idb-get",{originalErrorMessage:e?.message});Gt.warn(n.message)}}})}function Wh(t,e){return Q(this,null,function*(){try{let i=(yield Yh()).transaction(Ui,"readwrite");yield i.objectStore(Ui).put(e,Qh(t)),yield i.done}catch(n){if(n instanceof Bt)Gt.warn(n.message);else{let i=bt.create("idb-set",{originalErrorMessage:n?.message});Gt.warn(i.message)}}})}function Qh(t){return`${t.name}!${t.options.appId}`}var Ny=1024,Oy=30*24*60*60*1e3,ol=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new al(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return Q(this,null,function*(){var e,n;let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zh();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=Oy}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return Q(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=zh(),{heartbeatsToSend:i,unsentEntries:r}=ky(this._heartbeatsCache.heartbeats),s=ki(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function zh(){return new Date().toISOString().substring(0,10)}function ky(t,e=Ny){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Gh(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Gh(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var al=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Q(this,null,function*(){return Ah()?Dh().then(()=>!0).catch(()=>!1):!1})}read(){return Q(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield My(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return Q(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return Wh(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return Q(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return Wh(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function Gh(t){return ki(JSON.stringify({version:2,heartbeats:t})).length}function Py(t){ji(new Je("platform-logger",e=>new tl(e),"PRIVATE")),ji(new Je("heartbeat",e=>new ol(e),"PRIVATE")),wt(nl,Bh,t),wt(nl,Bh,"esm2017"),wt("fire-js","")}Py("");var Xh="@firebase/database",Zh="1.0.6";var fc="";function Fy(t){fc=t}var gl=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Z(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:bn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var _l=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return We(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Nf=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new gl(e)}}catch{}return new _l},qt=Nf("localStorage"),vl=Nf("sessionStorage");var Sn=new Cn("@firebase/database"),Ly=function(){let t=1;return function(){return t++}}(),Of=function(t){let e=Oh(t),n=new Cs;n.update(e);let i=n.digest();return Es.encodeByteArray(i)},nr=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=nr.apply(null,i):typeof i=="object"?e+=Z(i):e+=i,e+=" "}return e},Yt=null,Jh=!0,Vy=function(t,e){m(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Sn.logLevel=B.VERBOSE,Yt=Sn.log.bind(Sn),e&&vl.set("logging_enabled",!0)):typeof t=="function"?Yt=t:(Yt=null,vl.remove("logging_enabled"))},he=function(...t){if(Jh===!0&&(Jh=!1,Yt===null&&vl.get("logging_enabled")===!0&&Vy(!0)),Yt){let e=nr.apply(null,t);Yt(e)}},ir=function(t){return function(...e){he(t,...e)}},yl=function(...t){let e="FIREBASE INTERNAL ERROR: "+nr(...t);Sn.error(e)},et=function(...t){let e=`FIREBASE FATAL ERROR: ${nr(...t)}`;throw Sn.error(e),new Error(e)},me=function(...t){let e="FIREBASE WARNING: "+nr(...t);Sn.warn(e)},jy=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&me("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},kf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Uy=function(t){if($e()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Dn="[MIN_NAME]",Qt="[MAX_NAME]",Pn=function(t,e){if(t===e)return 0;if(t===Dn||e===Qt)return-1;if(e===Dn||t===Qt)return 1;{let n=ef(t),i=ef(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},By=function(t,e){return t===e?0:t<e?-1:1},Bi=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Z(e))},pc=function(t){if(typeof t!="object"||t===null)return Z(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Z(e[i]),n+=":",n+=pc(t[e[i]]);return n+="}",n},Pf=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function ge(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var Ff=function(t){m(!kf(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,c;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(r?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(u.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},$y=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Wy=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zy(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var Gy=new RegExp("^-?(0*)\\d{1,10}$"),Hy=-2147483648,qy=2147483647,ef=function(t){if(Gy.test(t)){let e=Number(t);if(e>=Hy&&e<=qy)return e}return null},Fn=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw me("Exception was thrown by user callback.",n),e},Math.floor(0))}},Ky=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Hi=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var bl=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){me(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var wl=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(he("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',me(e)}},qi=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),xs="5",Lf="v",Vf="s",jf="r",Uf="f",Bf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,$f="ls",Wf="p",Cl="ac",zf="websocket",Gf="long_polling";var Ms=class{constructor(e,n,i,r,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=qt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&qt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Yy(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Hf(t,e,n){m(typeof e=="string","typeof type must == string"),m(typeof n=="object","typeof params must == object");let i;if(e===zf)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Gf)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Yy(t)&&(n.ns=t.namespace);let r=[];return ge(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var El=class{constructor(){this.counters_={}}incrementCounter(e,n=1){We(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return wh(this.counters_)}};var cl={},ul={};function mc(t){let e=t.toString();return cl[e]||(cl[e]=new El),cl[e]}function Qy(t,e){let n=t.toString();return ul[n]||(ul[n]=e()),ul[n]}var Il=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Fn(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var tf="start",Xy="close",Zy="pLPCommand",Jy="pRTLPCB",qf="id",Kf="pw",Yf="ser",eb="cb",tb="seg",nb="ts",ib="d",rb="dframe",Qf=1870,Xf=30,sb=Qf-Xf,ob=25e3,ab=3e4,Sl=class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ir(e),this.stats_=mc(n),this.urlFn=c=>(this.appCheckToken&&(c[Cl]=this.appCheckToken),Hf(n,Gf,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Il(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(ab)),Uy(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Tl((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===tf)this.id=a,this.password=c;else if(o===Xy)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[tf]="t",i[Yf]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[eb]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Lf]=xs,this.transportSessionId&&(i[Vf]=this.transportSessionId),this.lastSessionId&&(i[$f]=this.lastSessionId),this.applicationId&&(i[Wf]=this.applicationId),this.appCheckToken&&(i[Cl]=this.appCheckToken),typeof location<"u"&&location.hostname&&Bf.test(location.hostname)&&(i[jf]=Uf);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return $e()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!$y()&&!Wy()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Z(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=Ga(n),r=Pf(i,sb);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if($e())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[rb]="t",i[qf]=e,i[Kf]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Z(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Tl=class t{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,$e())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=Ly(),window[Zy+this.uniqueCallbackIdentifier]=e,window[Jy+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){he("frame writing exception"),a.stack&&he(a.stack),he(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||he("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[qf]=this.myID,e[Kf]=this.myPW,e[Yf]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Xf+i.length<=Qf;){let o=this.pendingSegs.shift();i=i+"&"+tb+r+"="+o.seg+"&"+nb+r+"="+o.ts+"&"+ib+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(ob)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){$e()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{he("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var lb=16384,cb=45e3,Ns=null;typeof MozWebSocket<"u"?Ns=MozWebSocket:typeof WebSocket<"u"&&(Ns=WebSocket);var $i=(()=>{class t{constructor(n,i,r,s,o,a,c){this.connId=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ir(this.connId),this.stats_=mc(i),this.connURL=t.connectionURL_(i,a,c,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,r,s,o){let a={};return a[Lf]=xs,!$e()&&typeof location<"u"&&location.hostname&&Bf.test(location.hostname)&&(a[jf]=Uf),i&&(a[Vf]=i),r&&(a[$f]=r),s&&(a[Cl]=s),o&&(a[Wf]=o),Hf(n,zf,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,qt.set("previous_websocket_failure",!0);try{let r;if($e()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${xs}/${fc}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new Ns(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(n=!0)}return!n&&Ns!==null&&!t.forceDisallow_}static previouslyFailed(){return qt.isInMemoryStorage||qt.get("previous_websocket_failure")===!0}markConnectionHealthy(){qt.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=bn(i);this.onMessage(r)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(m(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(n){this.resetKeepAlive();let i=Z(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=Pf(i,lb);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(cb))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),ub=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Sl,$i]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=$i&&$i.isAvailable(),r=i&&!$i.previouslyFailed();if(n.webSocketOnly&&(i||me("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[$i];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),db=6e4,hb=5e3,fb=10*1024,pb=100*1024,dl="t",nf="d",mb="s",rf="r",gb="e",sf="o",of="a",af="n",lf="p",_b="h",Al=class{constructor(e,n,i,r,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ir("c:"+this.id+":"),this.transportManager_=new ub(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Hi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pb?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fb?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(dl in e){let n=e[dl];n===of?this.upgradeIfSecondaryHealthy_():n===rf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===sf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Bi("t",e),i=Bi("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:lf,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:of,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:af,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Bi("t",e),i=Bi("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Bi(dl,e);if(nf in e){let i=e[nf];if(n===_b){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===af){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===mb?this.onConnectionShutdown_(i):n===rf?this.onReset_(i):n===gb?yl("Server Error: "+i):n===sf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):yl("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),xs!==i&&me("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Hi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(db))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Hi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(hb))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:lf,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(qt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Os=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var ks=class{constructor(e){this.allowedEvents_=e,this.listeners_={},m(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){m(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Ps=class t extends ks{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!qa()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return m(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var cf=32,uf=768,L=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function O(){return new L("")}function R(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Et(t){return t.pieces_.length-t.pieceNum_}function $(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new L(t.pieces_,e)}function Zf(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function vb(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Jf(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function ep(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new L(e,0)}function J(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof L)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new L(n,0)}function M(t){return t.pieceNum_>=t.pieces_.length}function pe(t,e){let n=R(t),i=R(e);if(n===null)return e;if(n===i)return pe($(t),$(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function gc(t,e){if(Et(t)!==Et(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function ke(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Et(t)>Et(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var Dl=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Jf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Li(this.parts_[i]);tp(this)}};function yb(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Li(e),tp(t)}function bb(t){let e=t.parts_.pop();t.byteLength_-=Li(e),t.parts_.length>0&&(t.byteLength_-=1)}function tp(t){if(t.byteLength_>uf)throw new Error(t.errorPrefix_+"has a key path longer than "+uf+" bytes ("+t.byteLength_+").");if(t.parts_.length>cf)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+cf+") or object contains a cycle "+Ht(t))}function Ht(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Rl=class t extends ks{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return m(e==="visible","Unknown event type: "+e),[this.visible_]}};var Wi=1e3,wb=60*5*1e3,df=30*1e3,Cb=1.3,Eb=3e4,Ib="server_kill",hf=3,_c=(()=>{class t extends Os{constructor(n,i,r,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=ir("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Wi,this.maxReconnectDelay_=wb,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!$e())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Rl.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Ps.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,r){let s=++this.requestNumber_,o={r:s,a:n,b:i};this.log_(Z(o)),m(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(n){this.initConnection_();let i=new yt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?i.resolve(c):i.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,r,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),m(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:i,query:n,tag:r};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(n){let i=n.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,i),(this.listens.get(r)&&this.listens.get(r).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(r,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&We(n,"w")){let r=Wt(n,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();me(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Mh(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=df)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=xh(n)?"auth":"gauth",r={cred:n};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,r=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(n,i){let r=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,n._queryObject,i)}sendUnlisten_(n,i,r,s){this.log_("Unlisten on "+n+" for "+i);let o={p:n},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:r})}onDisconnectMerge(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:r})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,i,r,s){this.putInternal("p",n,i,r,s)}merge(n,i,r,s){this.putInternal("m",n,i,r,s)}putInternal(n,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,r=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Z(n));let i=n.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):yl("Unrecognized action received from server: "+Z(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){m(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Wi,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Wi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Eb&&(this.reconnectDelay_=Wi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Cb)}this.onConnectStatus_(!1)}establishConnection_(){return Q(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,r())},u=function(h){m(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?he("getToken() completed but was canceled"):(he("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new Al(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,r,p=>{me(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(Ib)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&me(h),l())}}})}interrupt(n){he("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){he("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Ka(this.interruptReasons_)&&(this.reconnectDelay_=Wi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let r;i?r=i.map(o=>pc(o)).join("$"):r="default";let s=this.removeListen_(n,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,i){let r=new L(n).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(n,i){he("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=hf&&(this.reconnectDelay_=df,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){he("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=hf&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";$e()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+fc.replace(/\./g,"-")]=1,qa()?n["framework.cordova"]=1:Th()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Ps.getInstance().currentlyOnline();return Ka(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),x=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Rn=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new x(Dn,e),r=new x(Dn,n);return this.compare(i,r)!==0}minPost(){return x.MIN}};var Rs,Fs=class extends Rn{static get __EMPTY_NODE(){return Rs}static set __EMPTY_NODE(e){Rs=e}compare(e,n){return Pn(e.name,n.name)}isDefinedOn(e){throw $t("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return x.MIN}maxPost(){return new x(Qt,Rs)}makePost(e,n){return m(typeof e=="string","KeyIndex indexValue must always be a string."),new x(e,Rs)}toString(){return".key"}},Tn=new Fs;var In=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Oe=(()=>{class t{constructor(n,i,r,s,o){this.key=n,this.value=i,this.color=r??t.RED,this.left=s??Ae.EMPTY_NODE,this.right=o??Ae.EMPTY_NODE}copy(n,i,r,s,o){return new t(n??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,r){let s=this,o=r(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ae.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let r,s;if(r=this,i(n,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(n,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(n,r.key)===0){if(r.right.isEmpty())return Ae.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(n,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),xl=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new Oe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ae=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Oe.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Oe.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new In(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new In(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new In(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new In(this.root_,null,this.comparator_,!0,e)}};Ae.EMPTY_NODE=new xl;function Sb(t,e){return Pn(t.name,e.name)}function vc(t,e){return Pn(t,e)}var Ml;function Tb(t){Ml=t}var np=function(t){return typeof t=="number"?"number:"+Ff(t):"string:"+t},ip=function(t){if(t.isLeafNode()){let e=t.val();m(typeof e=="string"||typeof e=="number"||typeof e=="object"&&We(e,".sv"),"Priority must be a string or number.")}else m(t===Ml||t.isEmpty(),"priority of unexpected type.");m(t===Ml||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var ff,xn=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,m(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ip(this.priorityNode_)}static set __childrenNodeConstructor(n){ff=n}static get __childrenNodeConstructor(){return ff}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return M(n)?this:R(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let r=R(n);return r===null?i:i.isEmpty()&&r!==".priority"?this:(m(r!==".priority"||Et(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild($(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+np(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=Ff(this.value_):n+=this.value_,this.lazyHash_=Of(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(m(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(r);return m(s>=0,"Unknown leaf type: "+i),m(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),rp,sp;function Ab(t){rp=t}function Db(t){sp=t}var Nl=class extends Rn{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Pn(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return x.MIN}maxPost(){return new x(Qt,new xn("[PRIORITY-POST]",sp))}makePost(e,n){let i=rp(e);return new x(n,new xn("[PRIORITY-POST]",i))}toString(){return".priority"}},G=new Nl;var Rb=Math.log(2),Ol=class{constructor(e){let n=s=>parseInt(Math.log(s)/Rb,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Ls=function(t,e,n,i){t.sort(e);let r=function(c,l){let u=l-c,d,h;if(u===0)return null;if(u===1)return d=t[c],h=n?n(d):d,new Oe(h,d.node,Oe.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=r(c,f),w=r(f+1,l);return d=t[f],h=n?n(d):d,new Oe(h,d.node,Oe.BLACK,p,w)}},s=function(c){let l=null,u=null,d=t.length,h=function(p,w){let _=d-p,D=d;d-=p;let H=r(_+1,D),ee=t[_],Y=n?n(ee):ee;f(new Oe(Y,ee.node,w,null,H))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let w=c.nextBitIsOne(),_=Math.pow(2,c.count-(p+1));w?h(_,Oe.BLACK):(h(_,Oe.BLACK),h(_,Oe.RED))}return u},o=new Ol(t.length),a=s(o);return new Ae(i||e,a)};var hl,En={},Mn=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return m(En&&G,"ChildrenNode.ts has not been loaded"),hl=hl||new t({".priority":En},{".priority":G}),hl}get(e){let n=Wt(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ae?n:null}hasIndex(e){return We(this.indexSet_,e.toString())}addIndex(e,n){m(e!==Tn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(x.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Ls(i,e.getCompare()):a=En;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let i=Fi(this.indexes_,(r,s)=>{let o=Wt(this.indexSet_,s);if(m(o,"Missing index implementation for "+s),r===En)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(x.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Ls(a,o.getCompare())}else return En;else{let a=n.get(e.name),c=r;return a&&(c=c.remove(new x(e.name,a))),c.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=Fi(this.indexes_,r=>{if(r===En)return r;{let s=n.get(e.name);return s?r.remove(new x(e.name,s)):r}});return new t(i,this.indexSet_)}};var zi,A=(()=>{class t{constructor(n,i,r){this.children_=n,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&ip(this.priorityNode_),this.children_.isEmpty()&&m(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return zi||(zi=new t(new Ae(vc),null,Mn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zi}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?zi:i}}getChild(n){let i=R(n);return i===null?this:this.getImmediateChild(i).getChild($(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(m(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let r=new x(n,i),s,o;i.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?zi:this.priorityNode_;return new t(s,a,o)}}updateChild(n,i){let r=R(n);if(r===null)return i;{m(R(n)!==".priority"||Et(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild($(n),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(G,(a,c)=>{i[a]=c.val(n),r++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*r){let a=[];for(let c in i)a[c]=i[c];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+np(this.getPriority().val())+":"),this.forEachChild(G,(i,r)=>{let s=r.hash();s!==""&&(n+=":"+i+":"+s)}),this.lazyHash_=n===""?"":Of(n)}return this.lazyHash_}getPredecessorChildName(n,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new x(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new x(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new x(i,this.children_.get(i)):null}forEachChild(n,i){let r=this.resolveIndex_(n);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,x.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,x.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===rr?-1:0}withIndex(n){if(n===Tn||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===Tn||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(G),s=i.getIterator(G),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Tn?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),kl=class extends A{constructor(){super(new Ae(vc),A.EMPTY_NODE,Mn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return A.EMPTY_NODE}isEmpty(){return!1}},rr=new kl;Object.defineProperties(x,{MIN:{value:new x(Dn,A.EMPTY_NODE)},MAX:{value:new x(Qt,rr)}});Fs.__EMPTY_NODE=A.EMPTY_NODE;xn.__childrenNodeConstructor=A;Tb(rr);Db(rr);var xb=!0;function oe(t,e=null){if(t===null)return A.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),m(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new xn(n,oe(e))}if(!(t instanceof Array)&&xb){let n=[],i=!1;if(ge(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=oe(a);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new x(o,c)))}}),n.length===0)return A.EMPTY_NODE;let s=Ls(n,Sb,o=>o.name,vc);if(i){let o=Ls(n,G.getCompare());return new A(s,oe(e),new Mn({".priority":o},{".priority":G}))}else return new A(s,oe(e),Mn.Default)}else{let n=A.EMPTY_NODE;return ge(t,(i,r)=>{if(We(t,i)&&i.substring(0,1)!=="."){let s=oe(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(oe(e))}}Ab(oe);var Pl=class extends Rn{constructor(e){super(),this.indexPath_=e,m(!M(e)&&R(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Pn(e.name,n.name):s}makePost(e,n){let i=oe(e),r=A.EMPTY_NODE.updateChild(this.indexPath_,i);return new x(n,r)}maxPost(){let e=A.EMPTY_NODE.updateChild(this.indexPath_,rr);return new x(Qt,e)}toString(){return Jf(this.indexPath_,0).join("/")}};var Fl=class extends Rn{compare(e,n){let i=e.node.compareTo(n.node);return i===0?Pn(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return x.MIN}maxPost(){return x.MAX}makePost(e,n){let i=oe(e);return new x(n,i)}toString(){return".value"}},Mb=new Fl;function op(t){return{type:"value",snapshotNode:t}}function Nn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Xi(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Zi(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Nb(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Ji=class{constructor(e){this.index_=e}updateChild(e,n,i,r,s,o){m(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Xi(n,a)):m(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Nn(n,i)):o.trackChildChange(Zi(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(G,(r,s)=>{n.hasChild(r)||i.trackChildChange(Xi(r,s))}),n.isLeafNode()||n.forEachChild(G,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Zi(r,s,o))}else i.trackChildChange(Nn(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?A.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Vs=class t{constructor(e){this.indexedFilter_=new Ji(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,r,s,o){return this.matches(new x(n,i))||(i=A.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=A.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(A.EMPTY_NODE);let s=this;return n.forEachChild(G,(o,a)=>{s.matches(new x(o,a))||(r=r.updateImmediateChild(o,A.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Ll=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Vs(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,r,s,o){return this.rangedFilter_.matches(new x(n,i))||(i=A.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,o):this.fullLimitUpdateChild_(e,n,i,s,o)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=A.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=A.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(A.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,A.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;m(a.numChildren()===this.limit_,"");let c=new x(n,i),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=r.getChildAfterChild(this.index_,l,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(u&&!i.isEmpty()&&f>=0)return s?.trackChildChange(Zi(n,i,d)),a.updateImmediateChild(n,i);{s?.trackChildChange(Xi(n,d));let w=a.updateImmediateChild(n,A.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Nn(h.name,h.node)),w.updateImmediateChild(h.name,h.node)):w}}else return i.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Xi(l.name,l.node)),s.trackChildChange(Nn(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(l.name,A.EMPTY_NODE)):e}};var Vl=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=G}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return m(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return m(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Dn}hasEnd(){return this.endSet_}getIndexEndValue(){return m(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return m(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return m(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===G}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Ob(t){return t.loadsAllData()?new Ji(t.getIndex()):t.hasLimit()?new Ll(t):new Vs(t)}function pf(t){let e={};if(t.isDefault())return e;let n;if(t.index_===G?n="$priority":t.index_===Mb?n="$value":t.index_===Tn?n="$key":(m(t.index_ instanceof Pl,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Z(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=Z(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Z(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Z(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Z(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function mf(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==G&&(e.i=t.index_.toString()),e}var jl=class t extends Os{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=ir("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(m(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,i),a={};this.listens_[o]=a;let c=pf(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,i),Wt(this.listens_,o)===a){let h;l?l===401?h="permission_denied":h="rest_error:"+l:h="ok",r(h,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=pf(e._queryParams),i=e._path.toString(),r=new yt;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Nh(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=bn(a.responseText)}catch{me("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,c)}else a.status!==401&&a.status!==404&&me("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var Ul=class{constructor(){this.rootNode_=A.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function js(){return{value:null,children:new Map}}function ap(t,e,n){if(M(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=R(e);t.children.has(i)||t.children.set(i,js());let r=t.children.get(i);e=$(e),ap(r,e,n)}}function Bl(t,e,n){t.value!==null?n(e,t.value):kb(t,(i,r)=>{let s=new L(e.toString()+"/"+i);Bl(r,s,n)})}function kb(t,e){t.children.forEach((n,i)=>{e(i,n)})}var $l=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ge(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var gf=10*1e3,Pb=30*1e3,Fb=5*60*1e3,Wl=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new $l(e);let i=gf+(Pb-gf)*Math.random();Hi(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;ge(e,(r,s)=>{s>0&&We(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),Hi(this.reportStats_.bind(this),Math.floor(Math.random()*2*Fb))}};var Ge=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Ge||{});function lp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yc(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function bc(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var zl=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Ge.ACK_USER_WRITE,this.source=lp()}operationForChild(e){if(M(this.path)){if(this.affectedTree.value!=null)return m(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new L(e));return new t(O(),n,this.revert)}}else return m(R(this.path)===e,"operationForChild called for unrelated child."),new t($(this.path),this.affectedTree,this.revert)}};var Us=class t{constructor(e,n){this.source=e,this.path=n,this.type=Ge.LISTEN_COMPLETE}operationForChild(e){return M(this.path)?new t(this.source,O()):new t(this.source,$(this.path))}};var On=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Ge.OVERWRITE}operationForChild(e){return M(this.path)?new t(this.source,O(),this.snap.getImmediateChild(e)):new t(this.source,$(this.path),this.snap)}};var Bs=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Ge.MERGE}operationForChild(e){if(M(this.path)){let n=this.children.subtree(new L(e));return n.isEmpty()?null:n.value?new On(this.source,O(),n.value):new t(this.source,O(),n)}else return m(R(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,$(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var tt=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(M(e))return this.isFullyInitialized()&&!this.filtered_;let n=R(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Gl=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function Lb(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Nb(o.childName,o.snapshotNode))}),Gi(t,r,"child_removed",e,i,n),Gi(t,r,"child_added",e,i,n),Gi(t,r,"child_moved",s,i,n),Gi(t,r,"child_changed",e,i,n),Gi(t,r,"value",e,i,n),r}function Gi(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,c)=>jb(t,a,c)),o.forEach(a=>{let c=Vb(t,a,s);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function Vb(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function jb(t,e,n){if(e.childName==null||n.childName==null)throw $t("Should only compare child_ events.");let i=new x(e.childName,e.snapshotNode),r=new x(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function Js(t,e){return{eventCache:t,serverCache:e}}function Ki(t,e,n,i){return Js(new tt(e,n,i),t.serverCache)}function cp(t,e,n,i){return Js(t.eventCache,new tt(e,n,i))}function Hl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Xt(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var fl,Ub=()=>(fl||(fl=new Ae(By)),fl),_e=class t{constructor(e,n=Ub()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return ge(e,(i,r)=>{n=n.set(new L(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:O(),value:this.value};if(M(e))return null;{let i=R(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue($(e),n);return s!=null?{path:J(new L(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(M(e))return this;{let n=R(e),i=this.children.get(n);return i!==null?i.subtree($(e)):new t(null)}}set(e,n){if(M(e))return new t(n,this.children);{let i=R(e),s=(this.children.get(i)||new t(null)).set($(e),n),o=this.children.insert(i,s);return new t(this.value,o)}}remove(e){if(M(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=R(e),i=this.children.get(n);if(i){let r=i.remove($(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(M(e))return this.value;{let n=R(e),i=this.children.get(n);return i?i.get($(e)):null}}setTree(e,n){if(M(e))return n;{let i=R(e),s=(this.children.get(i)||new t(null)).setTree($(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new t(this.value,o)}}fold(e){return this.fold_(O(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(J(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,O(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(M(e))return null;{let s=R(e),o=this.children.get(s);return o?o.findOnPath_($(e),J(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,O(),n)}foreachOnPath_(e,n,i){if(M(e))return this;{this.value&&i(n,this.value);let r=R(e),s=this.children.get(r);return s?s.foreachOnPath_($(e),J(n,r),i):new t(null)}}foreach(e){this.foreach_(O(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(J(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var Pe=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new _e(null))}};function Yi(t,e,n){if(M(e))return new Pe(new _e(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=pe(r,e);return s=s.updateChild(o,n),new Pe(t.writeTree_.set(r,s))}else{let r=new _e(n),s=t.writeTree_.setTree(e,r);return new Pe(s)}}}function _f(t,e,n){let i=t;return ge(n,(r,s)=>{i=Yi(i,J(e,r),s)}),i}function vf(t,e){if(M(e))return Pe.empty();{let n=t.writeTree_.setTree(e,new _e(null));return new Pe(n)}}function ql(t,e){return Zt(t,e)!=null}function Zt(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(pe(n.path,e)):null}function yf(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(G,(i,r)=>{e.push(new x(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new x(i,r.value))}),e}function Ct(t,e){if(M(e))return t;{let n=Zt(t,e);return n!=null?new Pe(new _e(n)):new Pe(t.writeTree_.subtree(e))}}function Kl(t){return t.writeTree_.isEmpty()}function kn(t,e){return up(O(),t.writeTree_,e)}function up(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(m(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=up(J(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(J(t,".priority"),i)),n}}function wc(t,e){return pp(e,t)}function Bb(t,e,n,i,r){m(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Yi(t.visibleWrites,e,n)),t.lastWriteId=i}function $b(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function Wb(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);m(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&zb(a,i.path)?r=!1:ke(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return Gb(t),!0;if(i.snap)t.visibleWrites=vf(t.visibleWrites,i.path);else{let a=i.children;ge(a,c=>{t.visibleWrites=vf(t.visibleWrites,J(i.path,c))})}return!0}else return!1}function zb(t,e){if(t.snap)return ke(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&ke(J(t.path,n),e))return!0;return!1}function Gb(t){t.visibleWrites=dp(t.allWrites,Hb,O()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Hb(t){return t.visible}function dp(t,e,n){let i=Pe.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)ke(n,o)?(a=pe(n,o),i=Yi(i,a,s.snap)):ke(o,n)&&(a=pe(o,n),i=Yi(i,O(),s.snap.getChild(a)));else if(s.children){if(ke(n,o))a=pe(n,o),i=_f(i,a,s.children);else if(ke(o,n))if(a=pe(o,n),M(a))i=_f(i,O(),s.children);else{let c=Wt(s.children,R(a));if(c){let l=c.getChild($(a));i=Yi(i,O(),l)}}}else throw $t("WriteRecord should have .snap or .children")}}return i}function hp(t,e,n,i,r){if(!i&&!r){let s=Zt(t.visibleWrites,e);if(s!=null)return s;{let o=Ct(t.visibleWrites,e);if(Kl(o))return n;if(n==null&&!ql(o,O()))return null;{let a=n||A.EMPTY_NODE;return kn(o,a)}}}else{let s=Ct(t.visibleWrites,e);if(!r&&Kl(s))return n;if(!r&&n==null&&!ql(s,O()))return null;{let o=function(l){return(l.visible||r)&&(!i||!~i.indexOf(l.writeId))&&(ke(l.path,e)||ke(e,l.path))},a=dp(t.allWrites,o,e),c=n||A.EMPTY_NODE;return kn(a,c)}}}function qb(t,e,n){let i=A.EMPTY_NODE,r=Zt(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(G,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=Ct(t.visibleWrites,e);return n.forEachChild(G,(o,a)=>{let c=kn(Ct(s,new L(o)),a);i=i.updateImmediateChild(o,c)}),yf(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Ct(t.visibleWrites,e);return yf(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Kb(t,e,n,i,r){m(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=J(e,n);if(ql(t.visibleWrites,s))return null;{let o=Ct(t.visibleWrites,s);return Kl(o)?r.getChild(n):kn(o,r.getChild(n))}}function Yb(t,e,n,i){let r=J(e,n),s=Zt(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=Ct(t.visibleWrites,r);return kn(o,i.getNode().getImmediateChild(n))}else return null}function Qb(t,e){return Zt(t.visibleWrites,e)}function Xb(t,e,n,i,r,s,o){let a,c=Ct(t.visibleWrites,e),l=Zt(c,O());if(l!=null)a=l;else if(n!=null)a=kn(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),f=h.getNext();for(;f&&u.length<r;)d(f,i)!==0&&u.push(f),f=h.getNext();return u}else return[]}function Zb(){return{visibleWrites:Pe.empty(),allWrites:[],lastWriteId:-1}}function $s(t,e,n,i){return hp(t.writeTree,t.treePath,e,n,i)}function Cc(t,e){return qb(t.writeTree,t.treePath,e)}function bf(t,e,n,i){return Kb(t.writeTree,t.treePath,e,n,i)}function Ws(t,e){return Qb(t.writeTree,J(t.treePath,e))}function Jb(t,e,n,i,r,s){return Xb(t.writeTree,t.treePath,e,n,i,r,s)}function Ec(t,e,n){return Yb(t.writeTree,t.treePath,e,n)}function fp(t,e){return pp(J(t.treePath,e),t.writeTree)}function pp(t,e){return{treePath:t,writeTree:e}}var Yl=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;m(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),m(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Zi(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Xi(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Nn(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Zi(i,e.snapshotNode,r.oldSnap));else throw $t("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Ql=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},mp=new Ql,er=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new tt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ec(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xt(this.viewCache_),s=Jb(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function ew(t){return{filter:t}}function tw(t,e){m(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),m(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function nw(t,e,n,i,r){let s=new Yl,o,a;if(n.type===Ge.OVERWRITE){let l=n;l.source.fromUser?o=Xl(t,e,l.path,l.snap,i,r,s):(m(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!M(l.path),o=zs(t,e,l.path,l.snap,i,r,a,s))}else if(n.type===Ge.MERGE){let l=n;l.source.fromUser?o=rw(t,e,l.path,l.children,i,r,s):(m(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Zl(t,e,l.path,l.children,i,r,a,s))}else if(n.type===Ge.ACK_USER_WRITE){let l=n;l.revert?o=aw(t,e,l.path,i,r,s):o=sw(t,e,l.path,l.affectedTree,i,r,s)}else if(n.type===Ge.LISTEN_COMPLETE)o=ow(t,e,n.path,i,s);else throw $t("Unknown operation type: "+n.type);let c=s.getChanges();return iw(e,o,c),{viewCache:o,changes:c}}function iw(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Hl(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(op(Hl(e)))}}function gp(t,e,n,i,r,s){let o=e.eventCache;if(Ws(i,n)!=null)return e;{let a,c;if(M(n))if(m(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Xt(e),u=l instanceof A?l:A.EMPTY_NODE,d=Cc(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=$s(i,Xt(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=R(n);if(l===".priority"){m(Et(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=bf(i,n,u,c);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=$(n),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let h=bf(i,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(l).updateChild(u,h):d=o.getNode().getImmediateChild(l)}else d=Ec(i,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,u,r,s):a=o.getNode()}}return Ki(e,a,o.isFullyInitialized()||M(n),t.filter.filtersNodes())}}function zs(t,e,n,i,r,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(M(n))l=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,i);l=u.updateFullNode(c.getNode(),f,null)}else{let f=R(n);if(!c.isCompleteForPath(n)&&Et(n)>1)return e;let p=$(n),_=c.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?l=u.updatePriority(c.getNode(),_):l=u.updateChild(c.getNode(),f,_,p,mp,null)}let d=cp(e,l,c.isFullyInitialized()||M(n),u.filtersNodes()),h=new er(r,d,s);return gp(t,d,n,r,h,a)}function Xl(t,e,n,i,r,s,o){let a=e.eventCache,c,l,u=new er(r,e,s);if(M(n))l=t.filter.updateFullNode(e.eventCache.getNode(),i,o),c=Ki(e,l,!0,t.filter.filtersNodes());else{let d=R(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),i),c=Ki(e,l,a.isFullyInitialized(),a.isFiltered());else{let h=$(n),f=a.getNode().getImmediateChild(d),p;if(M(h))p=i;else{let w=u.getCompleteChild(d);w!=null?Zf(h)===".priority"&&w.getChild(ep(h)).isEmpty()?p=w:p=w.updateChild(h,i):p=A.EMPTY_NODE}if(f.equals(p))c=e;else{let w=t.filter.updateChild(a.getNode(),d,p,h,u,o);c=Ki(e,w,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function wf(t,e){return t.eventCache.isCompleteForChild(e)}function rw(t,e,n,i,r,s,o){let a=e;return i.foreach((c,l)=>{let u=J(n,c);wf(e,R(u))&&(a=Xl(t,a,u,l,r,s,o))}),i.foreach((c,l)=>{let u=J(n,c);wf(e,R(u))||(a=Xl(t,a,u,l,r,s,o))}),a}function Cf(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Zl(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;M(n)?l=i:l=new _e(null).setTree(n,i);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=Cf(t,f,h);c=zs(t,c,new L(d),p,r,s,o,a)}}),l.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),w=Cf(t,p,h);c=zs(t,c,new L(d),w,r,s,o,a)}}),c}function sw(t,e,n,i,r,s,o){if(Ws(r,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(i.value!=null){if(M(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return zs(t,e,n,c.getNode().getChild(n),r,s,a,o);if(M(n)){let l=new _e(null);return c.getNode().forEachChild(Tn,(u,d)=>{l=l.set(new L(u),d)}),Zl(t,e,n,l,r,s,a,o)}else return e}else{let l=new _e(null);return i.foreach((u,d)=>{let h=J(n,u);c.isCompleteForPath(h)&&(l=l.set(u,c.getNode().getChild(h)))}),Zl(t,e,n,l,r,s,a,o)}}function ow(t,e,n,i,r){let s=e.serverCache,o=cp(e,s.getNode(),s.isFullyInitialized()||M(n),s.isFiltered());return gp(t,o,n,i,mp,r)}function aw(t,e,n,i,r,s){let o;if(Ws(i,n)!=null)return e;{let a=new er(i,e,r),c=e.eventCache.getNode(),l;if(M(n)||R(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=$s(i,Xt(e));else{let d=e.serverCache.getNode();m(d instanceof A,"serverChildren would be complete if leaf node"),u=Cc(i,d)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=R(n),d=Ec(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=t.filter.updateChild(c,u,d,$(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,A.EMPTY_NODE,$(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=$s(i,Xt(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Ws(i,O())!=null,Ki(e,l,o,t.filter.filtersNodes())}}var Jl=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new Ji(i.getIndex()),s=Ob(i);this.processor_=ew(s);let o=n.serverCache,a=n.eventCache,c=r.updateFullNode(A.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(A.EMPTY_NODE,a.getNode(),null),u=new tt(c,o.isFullyInitialized(),r.filtersNodes()),d=new tt(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Js(d,u),this.eventGenerator_=new Gl(this.query_)}get query(){return this.query_}};function lw(t){return t.viewCache_.serverCache.getNode()}function cw(t,e){let n=Xt(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!M(e)&&!n.getImmediateChild(R(e)).isEmpty())?n.getChild(e):null}function Ef(t){return t.eventRegistrations_.length===0}function uw(t,e){t.eventRegistrations_.push(e)}function If(t,e,n){let i=[];if(n){m(e==null,"A cancel should cancel all event registrations.");let r=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return i}function Sf(t,e,n,i){e.type===Ge.MERGE&&e.source.queryId!==null&&(m(Xt(t.viewCache_),"We should always have a full cache before handling merges"),m(Hl(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=nw(t.processor_,r,e,n,i);return tw(t.processor_,s.viewCache),m(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,_p(t,s.changes,s.viewCache.eventCache.getNode(),null)}function dw(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(G,(s,o)=>{i.push(Nn(s,o))}),n.isFullyInitialized()&&i.push(op(n.getNode())),_p(t,i,n.getNode(),e)}function _p(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return Lb(t.eventGenerator_,e,n,r)}var Gs,ec=class{constructor(){this.views=new Map}};function hw(t){m(!Gs,"__referenceConstructor has already been defined"),Gs=t}function fw(){return m(Gs,"Reference.ts has not been loaded"),Gs}function pw(t){return t.views.size===0}function Ic(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return m(s!=null,"SyncTree gave us an op for an invalid query."),Sf(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(Sf(o,e,n,i));return s}}function mw(t,e,n,i,r){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=$s(n,r?i:null),c=!1;a?c=!0:i instanceof A?(a=Cc(n,i),c=!1):(a=A.EMPTY_NODE,c=!1);let l=Js(new tt(a,c,!1),new tt(i,r,!1));return new Jl(e,l)}return o}function gw(t,e,n,i,r,s){let o=mw(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),uw(o,n),dw(o,n)}function _w(t,e,n,i){let r=e._queryIdentifier,s=[],o=[],a=It(t);if(r==="default")for(let[c,l]of t.views.entries())o=o.concat(If(l,n,i)),Ef(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(r);c&&(o=o.concat(If(c,n,i)),Ef(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!It(t)&&s.push(new(fw())(e._repo,e._path)),{removed:s,events:o}}function vp(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function An(t,e){let n=null;for(let i of t.views.values())n=n||cw(i,e);return n}function yp(t,e){if(e._queryParams.loadsAllData())return eo(t);{let i=e._queryIdentifier;return t.views.get(i)}}function bp(t,e){return yp(t,e)!=null}function It(t){return eo(t)!=null}function eo(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Hs;function vw(t){m(!Hs,"__referenceConstructor has already been defined"),Hs=t}function yw(){return m(Hs,"Reference.ts has not been loaded"),Hs}var bw=1,qs=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new _e(null),this.pendingWriteTree_=Zb(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function wp(t,e,n,i,r){return Bb(t.pendingWriteTree_,e,n,i,r),r?sr(t,new On(lp(),e,n)):[]}function Kt(t,e,n=!1){let i=$b(t.pendingWriteTree_,e);if(Wb(t.pendingWriteTree_,e)){let s=new _e(null);return i.snap!=null?s=s.set(O(),!0):ge(i.children,o=>{s=s.set(new L(o),!0)}),sr(t,new zl(i.path,s,n))}else return[]}function to(t,e,n){return sr(t,new On(yc(),e,n))}function ww(t,e,n){let i=_e.fromObject(n);return sr(t,new Bs(yc(),e,i))}function Cw(t,e){return sr(t,new Us(yc(),e))}function Ew(t,e,n){let i=Tc(t,n);if(i){let r=Ac(i),s=r.path,o=r.queryId,a=pe(s,e),c=new Us(bc(o),a);return Dc(t,s,c)}else return[]}function tc(t,e,n,i,r=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||bp(o,e))){let c=_w(o,e,n,i);pw(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!r){let u=l.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>It(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=Tw(h);for(let p=0;p<f.length;++p){let w=f[p],_=w.query,D=Ip(t,w);t.listenProvider_.startListening(Qi(_),Ks(t,_),D.hashFn,D.onComplete)}}}!d&&l.length>0&&!i&&(u?t.listenProvider_.stopListening(Qi(e),null):l.forEach(h=>{let f=t.queryToTagMap.get(no(h));t.listenProvider_.stopListening(Qi(h),f)}))}Aw(t,l)}return a}function Iw(t,e,n,i){let r=Tc(t,i);if(r!=null){let s=Ac(r),o=s.path,a=s.queryId,c=pe(o,e),l=new On(bc(a),c,n);return Dc(t,o,l)}else return[]}function Sw(t,e,n,i){let r=Tc(t,i);if(r){let s=Ac(r),o=s.path,a=s.queryId,c=pe(o,e),l=_e.fromObject(n),u=new Bs(bc(a),c,l);return Dc(t,o,u)}else return[]}function Tf(t,e,n,i=!1){let r=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(r,(h,f)=>{let p=pe(h,r);s=s||An(f,p),o=o||It(f)});let a=t.syncPointTree_.get(r);a?(o=o||It(a),s=s||An(a,O())):(a=new ec,t.syncPointTree_=t.syncPointTree_.set(r,a));let c;s!=null?c=!0:(c=!1,s=A.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,p)=>{let w=An(p,O());w&&(s=s.updateImmediateChild(f,w))}));let l=bp(a,e);if(!l&&!e._queryParams.loadsAllData()){let h=no(e);m(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=Dw();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=wc(t.pendingWriteTree_,r),d=gw(a,e,n,u,s,c);if(!l&&!o&&!i){let h=yp(a,e);d=d.concat(Rw(t,e,h))}return d}function Sc(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=pe(o,e),l=An(a,c);if(l)return l});return hp(r,e,s,n,!0)}function sr(t,e){return Cp(e,t.syncPointTree_,null,wc(t.pendingWriteTree_,O()))}function Cp(t,e,n,i){if(M(t.path))return Ep(t,e,n,i);{let r=e.get(O());n==null&&r!=null&&(n=An(r,O()));let s=[],o=R(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=fp(i,o);s=s.concat(Cp(a,c,l,u))}return r&&(s=s.concat(Ic(r,t,i,n))),s}}function Ep(t,e,n,i){let r=e.get(O());n==null&&r!=null&&(n=An(r,O()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=fp(i,o),u=t.operationForChild(o);u&&(s=s.concat(Ep(u,a,c,l)))}),r&&(s=s.concat(Ic(r,t,i,n))),s}function Ip(t,e){let n=e.query,i=Ks(t,n);return{hashFn:()=>(lw(e)||A.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?Ew(t,n._path,i):Cw(t,n._path);{let s=zy(r,n);return tc(t,n,null,s)}}}}function Ks(t,e){let n=no(e);return t.queryToTagMap.get(n)}function no(t){return t._path.toString()+"$"+t._queryIdentifier}function Tc(t,e){return t.tagToQueryMap.get(e)}function Ac(t){let e=t.indexOf("$");return m(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new L(t.substr(0,e))}}function Dc(t,e,n){let i=t.syncPointTree_.get(e);m(i,"Missing sync point for query tag that we're tracking");let r=wc(t.pendingWriteTree_,e);return Ic(i,n,r,null)}function Tw(t){return t.fold((e,n,i)=>{if(n&&It(n))return[eo(n)];{let r=[];return n&&(r=vp(n)),ge(i,(s,o)=>{r=r.concat(o)}),r}})}function Qi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(yw())(t._repo,t._path):t}function Aw(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let r=no(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function Dw(){return bw++}function Rw(t,e,n){let i=e._path,r=Ks(t,e),s=Ip(t,n),o=t.listenProvider_.startListening(Qi(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)m(!It(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!M(l)&&u&&It(u))return[eo(u).query];{let h=[];return u&&(h=h.concat(vp(u).map(f=>f.query))),ge(d,(f,p)=>{h=h.concat(p)}),h}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(Qi(u),Ks(t,u))}}return o}var nc=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},ic=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=J(this.path_,e);return new t(this.syncTree_,n)}node(){return Sc(this.syncTree_,this.path_)}},xw=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Af=function(t,e,n){if(!t||typeof t!="object")return t;if(m(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Mw(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Nw(t[".sv"],e);m(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Mw=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:m(!1,"Unexpected server value: "+t)}},Nw=function(t,e,n){t.hasOwnProperty("increment")||m(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&m(!1,"Unexpected increment value: "+i);let r=e.node();if(m(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},Ow=function(t,e,n,i){return Rc(e,new ic(n,t),i)},Sp=function(t,e,n){return Rc(t,new nc(e),n)};function Rc(t,e,n){let i=t.getPriority().val(),r=Af(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=Af(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new xn(a,oe(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new xn(r))),o.forEachChild(G,(a,c)=>{let l=Rc(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var tr=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function xc(t,e){let n=e instanceof L?e:new L(e),i=t,r=R(n);for(;r!==null;){let s=Wt(i.node.children,r)||{children:{},childCount:0};i=new tr(r,i,s),n=$(n),r=R(n)}return i}function Ln(t){return t.node.value}function Tp(t,e){t.node.value=e,rc(t)}function Ap(t){return t.node.childCount>0}function kw(t){return Ln(t)===void 0&&!Ap(t)}function io(t,e){ge(t.node.children,(n,i)=>{e(new tr(n,t,i))})}function Dp(t,e,n,i){n&&!i&&e(t),io(t,r=>{Dp(r,e,!0,i)}),n&&i&&e(t)}function Pw(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function or(t){return new L(t.parent===null?t.name:or(t.parent)+"/"+t.name)}function rc(t){t.parent!==null&&Fw(t.parent,t.name,t)}function Fw(t,e,n){let i=kw(n),r=We(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,rc(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,rc(t))}var Lw=/[\[\].#$\/\u0000-\u001F\u007F]/,Vw=/[\[\].#$\u0000-\u001F\u007F]/,pl=10*1024*1024,Rp=function(t){return typeof t=="string"&&t.length!==0&&!Lw.test(t)},xp=function(t){return typeof t=="string"&&t.length!==0&&!Vw.test(t)},jw=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xp(t)};var Uw=function(t,e,n,i){i&&e===void 0||Mc(Ss(t,"value"),e,n)},Mc=function(t,e,n){let i=n instanceof L?new Dl(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ht(i));if(typeof e=="function")throw new Error(t+"contains a function "+Ht(i)+" with contents = "+e.toString());if(kf(e))throw new Error(t+"contains "+e.toString()+" "+Ht(i));if(typeof e=="string"&&e.length>pl/3&&Li(e)>pl)throw new Error(t+"contains a string greater than "+pl+" utf8 bytes "+Ht(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(ge(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Rp(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ht(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);yb(i,o),Mc(t,a,i),bb(i)}),r&&s)throw new Error(t+' contains ".value" child '+Ht(i)+" in addition to actual children.")}};var Mp=function(t,e,n,i){if(!(i&&n===void 0)&&!xp(n))throw new Error(Ss(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Bw=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mp(t,e,n,i)},$w=function(t,e){if(R(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Ww=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Rp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!jw(n))throw new Error(Ss(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var sc=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Nc(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!gc(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Np(t,e,n){Nc(t,n),Op(t,i=>gc(i,e))}function nt(t,e,n){Nc(t,n),Op(t,i=>ke(i,e)||ke(e,i))}function Op(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(zw(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function zw(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();Yt&&he("event: "+n.toString()),Fn(i)}}}var Gw="repo_interrupt",Hw=25,oc=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new sc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=js(),this.transactionQueueTree_=new tr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function qw(t,e,n){if(t.stats_=mc(t.repoInfo_),t.forceRestClient_||Ky())t.server_=new jl(t.repoInfo_,(i,r,s,o)=>{Df(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Rf(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Z(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new _c(t.repoInfo_,e,(i,r,s,o)=>{Df(t,i,r,s,o)},i=>{Rf(t,i)},i=>{Yw(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=Qy(t.repoInfo_,()=>new Wl(t.stats_,t.server_)),t.infoData_=new Ul,t.infoSyncTree_=new qs({startListening:(i,r,s,o)=>{let a=[],c=t.infoData_.getNode(i._path);return c.isEmpty()||(a=to(t.infoSyncTree_,i._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),kc(t,"connected",!1),t.serverSyncTree_=new qs({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,c)=>{let l=o(a,c);nt(t.eventQueue_,i._path,l)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function Kw(t){let n=t.infoData_.getNode(new L(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Oc(t){return xw({timestamp:Kw(t)})}function Df(t,e,n,i,r){t.dataUpdateCount++;let s=new L(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let c=Fi(n,l=>oe(l));o=Sw(t.serverSyncTree_,s,c,r)}else{let c=oe(n);o=Iw(t.serverSyncTree_,s,c,r)}else if(i){let c=Fi(n,l=>oe(l));o=ww(t.serverSyncTree_,s,c)}else{let c=oe(n);o=to(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=ro(t,s)),nt(t.eventQueue_,a,o)}function Rf(t,e){kc(t,"connected",e),e===!1&&Xw(t)}function Yw(t,e){ge(e,(n,i)=>{kc(t,n,i)})}function kc(t,e,n){let i=new L("/.info/"+e),r=oe(n);t.infoData_.updateSnapshot(i,r);let s=to(t.infoSyncTree_,i,r);nt(t.eventQueue_,i,s)}function kp(t){return t.nextWriteId_++}function Qw(t,e,n,i,r){Pc(t,"set",{path:e.toString(),value:n,priority:i});let s=Oc(t),o=oe(n,i),a=Sc(t.serverSyncTree_,e),c=Sp(o,a,s),l=kp(t),u=wp(t.serverSyncTree_,e,c,l,!0);Nc(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||me("set at "+e+" failed: "+h);let w=Kt(t.serverSyncTree_,l,!p);nt(t.eventQueue_,e,w),e0(t,r,h,f)});let d=jp(t,e);ro(t,d),nt(t.eventQueue_,d,[])}function Xw(t){Pc(t,"onDisconnectEvents");let e=Oc(t),n=js();Bl(t.onDisconnect_,O(),(r,s)=>{let o=Ow(r,s,t.serverSyncTree_,e);ap(n,r,o)});let i=[];Bl(n,O(),(r,s)=>{i=i.concat(to(t.serverSyncTree_,r,s));let o=jp(t,r);ro(t,o)}),t.onDisconnect_=js(),nt(t.eventQueue_,O(),i)}function Zw(t,e,n){let i;R(e._path)===".info"?i=Tf(t.infoSyncTree_,e,n):i=Tf(t.serverSyncTree_,e,n),Np(t.eventQueue_,e._path,i)}function xf(t,e,n){let i;R(e._path)===".info"?i=tc(t.infoSyncTree_,e,n):i=tc(t.serverSyncTree_,e,n),Np(t.eventQueue_,e._path,i)}function Jw(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Gw)}function Pc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),he(n,...e)}function e0(t,e,n,i){e&&Fn(()=>{if(n==="ok")e(null);else{let r=(n||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function Pp(t,e,n){return Sc(t.serverSyncTree_,e,n)||A.EMPTY_NODE}function Fc(t,e=t.transactionQueueTree_){if(e||so(t,e),Ln(e)){let n=Lp(t,e);m(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&t0(t,or(e),n)}else Ap(e)&&io(e,n=>{Fc(t,n)})}function t0(t,e,n){let i=n.map(l=>l.currentWriteId),r=Pp(t,e,i),s=r,o=r.hash();for(let l=0;l<n.length;l++){let u=n[l];m(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=pe(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{Pc(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(Kt(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();so(t,xc(t.transactionQueueTree_,e)),Fc(t,t.transactionQueueTree_),nt(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Fn(d[h])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{me("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}ro(t,e)}},o)}function ro(t,e){let n=Fp(t,e),i=or(n),r=Lp(t,n);return n0(t,r,i),i}function n0(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=pe(n,c.path),u=!1,d;if(m(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,r=r.concat(Kt(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Hw)u=!0,d="maxretry",r=r.concat(Kt(t.serverSyncTree_,c.currentWriteId,!0));else{let h=Pp(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Mc("transaction failed: Data returned ",f,c.path);let p=oe(f);typeof f=="object"&&f!=null&&We(f,".priority")||(p=p.updatePriority(h.getPriority()));let _=c.currentWriteId,D=Oc(t),H=Sp(p,h,D);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=H,c.currentWriteId=kp(t),o.splice(o.indexOf(_),1),r=r.concat(wp(t.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),r=r.concat(Kt(t.serverSyncTree_,_,!0))}else u=!0,d="nodata",r=r.concat(Kt(t.serverSyncTree_,c.currentWriteId,!0))}nt(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}so(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)Fn(i[a]);Fc(t,t.transactionQueueTree_)}function Fp(t,e){let n,i=t.transactionQueueTree_;for(n=R(e);n!==null&&Ln(i)===void 0;)i=xc(i,n),e=$(e),n=R(e);return i}function Lp(t,e){let n=[];return Vp(t,e,n),n.sort((i,r)=>i.order-r.order),n}function Vp(t,e,n){let i=Ln(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);io(e,r=>{Vp(t,r,n)})}function so(t,e){let n=Ln(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,Tp(e,n.length>0?n:void 0)}io(e,i=>{so(t,i)})}function jp(t,e){let n=or(Fp(t,e)),i=xc(t.transactionQueueTree_,e);return Pw(i,r=>{ml(t,r)}),ml(t,i),Dp(i,r=>{ml(t,r)}),n}function ml(t,e){let n=Ln(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(m(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(m(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Kt(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Tp(e,void 0):n.length=s+1,nt(t.eventQueue_,or(e),r);for(let o=0;o<i.length;o++)Fn(i[o])}}function i0(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function r0(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):me(`Invalid query segment '${n}' in query '${t}'`)}return e}var Mf=function(t,e){let n=s0(t),i=n.namespace;n.domain==="firebase.com"&&et(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&et("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||jy();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Ms(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new L(n.pathString)}},s0=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(r=i0(t.substring(u,d)));let h=r0(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var Ys=class{constructor(e,n,i,r){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Z(this.snapshot.exportVal())}},Qs=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var ac=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return m(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var lc=class t{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return M(this._path)?null:Zf(this._path)}get ref(){return new it(this._repo,this._path)}get _queryIdentifier(){let e=mf(this._queryParams),n=pc(e);return n==="{}"?"default":n}get _queryObject(){return mf(this._queryParams)}isEqual(e){if(e=wn(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=gc(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+vb(this._path)}};var it=class t extends lc{constructor(e,n){super(e,n,new Vl,!1)}get parent(){let e=ep(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Xs=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new L(e),i=Zs(this.ref,e);return new t(this._node.getChild(n),i,G)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new t(r,Zs(this.ref,i),G)))}hasChild(e){let n=new L(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function oo(t,e){return t=wn(t),t._checkNotDeleted("ref"),e!==void 0?Zs(t._root,e):t._root}function Zs(t,e){return t=wn(t),R(t._path)===null?Bw("child","path",e,!1):Mp("child","path",e,!1),new it(t._repo,J(t._path,e))}function Lc(t,e){t=wn(t),$w("set",t._path),Uw("set",e,t._path,!1);let n=new yt;return Qw(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}var cc=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new Ys("value",this,new Xs(e.snapshotNode,new it(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Qs(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},uc=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Qs(this,e,n):null}createEvent(e,n){m(e.childName!=null,"Child events should have a childName.");let i=Zs(new it(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new Ys(e.type,this,new Xs(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function o0(t,e,n,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){let c=n,l=(u,d)=>{xf(t._repo,t,a),c(u,d)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new ac(n,s||void 0),a=e==="value"?new cc(o):new uc(e,o);return Zw(t._repo,t,a),()=>xf(t._repo,t,a)}function Up(t,e,n,i){return o0(t,"value",e,n,i)}hw(it);vw(it);var a0="FIREBASE_DATABASE_EMULATOR_HOST",dc={},l0=!1;function c0(t,e,n,i){t.repoInfo_=new Ms(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function u0(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||et("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),he("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Mf(s,r),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[a0]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=Mf(s,r),a=o.repoInfo):c=!o.repoInfo.secure;let u=r&&c?new qi(qi.OWNER):new wl(t.name,t.options,e);Ww("Invalid Firebase Database URL",o),M(o.path)||et("Database URL must point to the root of a Firebase Database (not including a child path).");let d=h0(a,t,u,new bl(t.name,n));return new hc(d,t)}function d0(t,e){let n=dc[e];(!n||n[t.key]!==t)&&et(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Jw(t),delete n[t.key]}function h0(t,e,n,i){let r=dc[e.name];r||(r={},dc[e.name]=r);let s=r[t.toURLString()];return s&&et("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new oc(t,l0,n,i),r[t.toURLString()]=s,s}var hc=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(qw(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new it(this._repo,O())),this._rootInternal}_delete(){return this._rootInternal!==null&&(d0(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&et("Cannot call "+e+" on a deleted database.")}};function Bp(t=Kh(),e){let n=Hh(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let i=Ih("database");i&&f0(n,...i)}return n}function f0(t,e,n,i={}){t=wn(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&et("Cannot call useEmulator() after instance has already been initialized.");let r=t._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&et('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new qi(qi.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:Sh(i.mockUserToken,t.app.options.projectId);s=new qi(o)}c0(r,e,n,s)}function p0(t){Fy(qh),ji(new Je("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return u0(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),wt(Xh,Zh,t),wt(Xh,Zh,"esm2017")}_c.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};_c.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};p0();var Vn=(()=>{class t{openChat=new ue;receiverObjectId="";db=Bp();constructor(){}openChatWindow(n){this.receiverObjectId=n,this.openChat.emit(!0)}closeChatWindow(){this.openChat.emit(!1)}sendMessage(n){let i=oo(this.db,"chats/"+n.senderId+"/"+n.receiverId+"/"+n.timestamp),r=oo(this.db,"chats/"+n.receiverId+"/"+n.senderId+"/"+n.timestamp);Lc(i,{messageText:n.messageText,senderId:n.senderId,receiverId:n.receiverId,timestamp:n.timestamp}),Lc(r,{messageText:n.messageText,senderId:n.senderId,receiverId:n.receiverId,timestamp:n.timestamp})}listenForMessages(n){let i=oo(this.db,"chats/"+localStorage.getItem("objectId")+"/"+this.receiverObjectId),r=[];Up(i,s=>{r=[],s.forEach(o=>{r.push(o.val())}),n(r),console.log("listen called")})}static \u0275fac=function(i){return new(i||t)};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function m0(t,e){if(t&1){let n=_r();b(0,"div",4),z("click",function(){let r=ur(n),s=r.$implicit,o=r.index,a=Le();return dr(a.openChatWindow(s.objectId,o))}),b(1,"div",5)(2,"div",6),j(3,"img",7),E(),b(4,"div",8)(5,"div",9)(6,"p"),F(7),E()()()()()}if(t&2){let n=e.$implicit;W(7),sn("",n.firstName," ",n.lastName,"")}}var $p=(()=>{class t{authService;messagingService;constructor(n,i){this.authService=n,this.messagingService=i}searchInput="";users=[];findUsers(){let n=localStorage.getItem("userToken");this.authService.findUsers(this.searchInput,n,i=>{this.users=i})}openChatWindow(n,i){this.messagingService.closeChatWindow(),this.messagingService.openChatWindow(n),document.querySelectorAll(".users-list").forEach((s,o)=>{let a=s.querySelector(".name-class");o!==i?(s.classList.remove("bg-green-600"),a?.classList.remove("text-white"),a?.classList.add("text-gray-700")):(s.classList.add("bg-green-600"),s.classList.add("text-gray-600"),a?.classList.add("text-white"),a?.classList.remove("text-gray-700"))})}static \u0275fac=function(i){return new(i||t)(v(Be),v(Vn))};static \u0275cmp=ie({type:t,selectors:[["app-users"]],standalone:!0,features:[re],decls:4,vars:2,consts:[[1,"h-full","px-5","pt-3","bg-[#EEF2F1]"],[1,"w-full"],["placeholder","Search",1,"basis-[95%]","w-full","px-2","text-xl","font-light","border","outline-none","rounded-md","border-gray-300","focus:border-blue-600",3,"ngModelChange","ngModel"],["class","users-list basis-[94%] flex flex-col-reverse p-5 mt-5 rounded-md  cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"users-list","basis-[94%]","flex","flex-col-reverse","p-5","mt-5","rounded-md","cursor-pointer",3,"click"],[1,"flex"],[1,"h-11","w-11","rounded-full"],["src","./assets/user.jpg",1,"rounded-full"],[1,"name-class","w-full","flex","flex-col","justify-center","pl-3","text-gray-700"],[1,"w-full","flex","items-center","text-xl"]],template:function(i,r){i&1&&(b(0,"div",0)(1,"div",1)(2,"input",2),wr("ngModelChange",function(o){return br(r.searchInput,o)||(r.searchInput=o),o}),z("ngModelChange",function(){return r.findUsers()}),E()(),Re(3,m0,8,2,"div",3),E()),i&2&&(W(2),yr("ngModel",r.searchInput),W(),K("ngForOf",r.users))},dependencies:[Ye,Dr,_s,Ue,vt,Ai]})}return t})();var ao=class{messageText;senderId;receiverId;timestamp;constructor(e,n,i,r){this.messageText=e,this.senderId=n,this.receiverId=i,this.timestamp=r}};function g0(t,e){t&1&&(b(0,"p",11),F(1," No messages here "),E())}function _0(t,e){t&1&&j(0,"img",21)}function v0(t,e){if(t&1&&(b(0,"p"),F(1),E()),t&2){let n=Le().$implicit,i=Le();W(),sn(" ",n.senderId===(i.senderUser==null?null:i.senderUser.objectId)?i.senderUser==null?null:i.senderUser.firstName:i.receiverUser==null?null:i.receiverUser.firstName," ",n.senderId===(i.senderUser==null?null:i.senderUser.objectId)?i.senderUser==null?null:i.senderUser.lastName:i.receiverUser==null?null:i.receiverUser.lastName," ")}}function y0(t,e){if(t&1&&(b(0,"ul",12)(1,"li",13),Re(2,_0,1,0,"img",14),E(),b(3,"li",15)(4,"div",16),Re(5,v0,2,2,"p",17),E(),b(6,"div",18)(7,"p",19),F(8),E(),b(9,"p",20),F(10),lu(11,"date"),E()()()()),t&2){let n=e.$implicit,i=e.index,r=Le();K("ngClass",n.senderId===r.getCurrentObjectId()?"justify-end flex-row-reverse":"justify-start flex-row"),W(2),K("ngIf",i===0||r.messages[i].senderId!==r.messages[i-1].senderId),W(2),K("ngClass",n.senderId===r.getCurrentObjectId()?"justify-end pr-2":"justify-start pl-2"),W(),K("ngIf",i===0||r.messages[i].senderId!==r.messages[i-1].senderId),W(),K("ngClass",n.senderId===r.getCurrentObjectId()?"pr-2 flex-row-reverse":"flex-row pl-2"),W(2),vr(" ",n.messageText," "),W(2),vr(" ",cu(11,7,n.timestamp,"hh:mm aa")," ")}}var Wp=(()=>{class t{messagingService;authService;messages=[];senderUser;receiverUser;text="";constructor(n,i){this.messagingService=n,this.authService=i,this.messagingService.listenForMessages(r=>{this.messages=r}),this.messagingService.openChat.subscribe(r=>{r&&this.messagingService.listenForMessages(s=>{this.messages=s})}),this.authService.getFullName(localStorage.getItem("objectId"),r=>{this.senderUser=r}),this.authService.getFullName(this.messagingService.receiverObjectId,r=>{this.receiverUser=r})}sendMessage(){if(this.text!==""){let n=new ao(this.text,localStorage.getItem("objectId"),this.messagingService.receiverObjectId,Date.now().toString());this.text="",this.messagingService.sendMessage(n)}}getCurrentObjectId(){return localStorage.getItem("objectId")}static \u0275fac=function(i){return new(i||t)(v(Vn),v(Be))};static \u0275cmp=ie({type:t,selectors:[["app-chat"]],standalone:!0,features:[re],decls:11,vars:3,consts:[[1,"h-full","w-full","flex","flex-col","pt-3","px-3","bg-[#F6EFEE]"],["class","w-full text-center bg-gray-500 text-white",4,"ngIf"],[1,"basis-[94%]","flex","flex-col","mb-3","py-3","bg-white","rounded-md","overflow-y-auto"],["class","flex px-5",3,"ngClass",4,"ngFor","ngForOf"],[1,"basis-[6%]","flex","mb-3"],["placeholder","Type a message",1,"basis-[95%]","w-full","h-full","px-2","text-xl","border-gray-300","outline-none","border","rounded-md","focus:border-blue-600","font-lightborder",3,"ngModelChange","keydown.enter","ngModel"],[1,"basis-[5%]","p-2"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","32px","width","32px","version","1.1","id","Capa_1","viewBox","0 0 495.003 495.003",0,"xml","space","preserve",1,"cursor-pointer",3,"click"],["id","XMLID_51_"],["id","XMLID_53_","d","M164.711,456.687c0,2.966,1.647,5.686,4.266,7.072c2.617,1.385,5.799,1.207,8.245-0.468l55.09-37.616   l-67.6-32.22V456.687z"],["id","XMLID_52_","d","M492.431,32.443c-1.513-1.395-3.466-2.125-5.44-2.125c-1.19,0-2.377,0.264-3.5,0.816L7.905,264.422   c-4.861,2.389-7.937,7.353-7.904,12.783c0.033,5.423,3.161,10.353,8.057,12.689l125.342,59.724l250.62-205.99L164.455,364.414   l156.145,74.4c1.918,0.919,4.012,1.376,6.084,1.376c1.768,0,3.519-0.322,5.186-0.977c3.637-1.438,6.527-4.318,7.97-7.956   L494.436,41.257C495.66,38.188,494.862,34.679,492.431,32.443z"],[1,"w-full","text-center","bg-gray-500","text-white"],[1,"flex","px-5",3,"ngClass"],[1,"w-11","rounded-full"],["src","./assets/user.jpg","class","rounded-full",4,"ngIf"],[1,"w-full","flex","flex-col"],[1,"w-full","flex","text-xl",3,"ngClass"],[4,"ngIf"],[1,"flex","items-center",3,"ngClass"],[1,"text-lg","font-light"],[1,"ml-2","font-light","text-xs","px-2"],["src","./assets/user.jpg",1,"rounded-full"]],template:function(i,r){i&1&&(b(0,"div",0),Re(1,g0,2,0,"p",1),b(2,"div",2),Re(3,y0,12,10,"ul",3),E(),b(4,"div",4)(5,"input",5),wr("ngModelChange",function(o){return br(r.text,o)||(r.text=o),o}),z("keydown.enter",function(){return r.sendMessage()}),E(),b(6,"div",6),lt(),b(7,"svg",7),z("click",function(){return r.sendMessage()}),b(8,"g",8),j(9,"path",9)(10,"path",10),E()()()()()),i&2&&(W(),K("ngIf",r.messages.length===0),W(2),K("ngForOf",r.messages),W(2),yr("ngModel",r.text))},dependencies:[Ye,Ar,Dr,Rr,mu,_s,Ue,vt,Ai]})}return t})();function b0(t,e){if(t&1){let n=_r();b(0,"ul",14)(1,"li",15),z("click",function(){ur(n);let r=Le();return dr(r.logout())}),b(2,"div",16),j(3,"img",17),E(),b(4,"p",9),F(5,"Logout"),E()()()}}function w0(t,e){if(t&1&&j(0,"app-chat",12),t&2){let n=Le();K("ngClass",n.opened?"basis-2/3":"basis-0")}}var zp=(()=>{class t{router;messagingService;authService;opened=!1;openedPanel=!1;constructor(n,i,r){this.router=n,this.messagingService=i,this.authService=r,this.getFullName()}currentUser;ngOnInit(){(localStorage.getItem("email")===null||localStorage.getItem("userToken")===null||localStorage.getItem("objectId")===null)&&this.router.navigate(["/login"]),this.messagingService.openChat.subscribe(n=>{this.opened=n})}getFullName(){this.authService.getFullName(localStorage.getItem("objectId"),n=>{this.currentUser=n})}openPanel(){this.openedPanel=!this.openedPanel}logout(){this.authService.logout(),localStorage.removeItem("email"),localStorage.removeItem("userToken"),localStorage.removeItem("objectId"),this.router.navigate(["/login"])}static \u0275fac=function(i){return new(i||t)(v(je),v(Vn),v(Be))};static \u0275cmp=ie({type:t,selectors:[["app-home"]],standalone:!0,features:[re],decls:16,vars:5,consts:[[1,"h-screen","w-full","flex","flex-col"],[1,"h-[10%]","flex","items-center","justify-between","px-7","bg-white"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","48px","width","48px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"w-44","flex","items-center","relative",3,"click"],[1,"h-9","w-9"],["src","./assets/user.jpg"],[1,"cursor-pointer"],[1,"h-[90%]","flex","flex-1","relative"],["class","w-44 flex flex-col bg-white absolute right-0 mx-7",4,"ngIf"],[3,"ngClass"],[3,"ngClass",4,"ngIf"],[1,"w-44","flex","flex-col","bg-white","absolute","right-0","mx-7"],[1,"flex","my-3","items-center",3,"click"],[1,"h-9","w-9","p-1","pl-2","content-center"],["src","./assets/logout.png"]],template:function(i,r){i&1&&(b(0,"div",0)(1,"header",1)(2,"div",2),lt(),b(3,"svg",3),j(4,"path",4),E(),nn(),b(5,"p",5),F(6,"Chat"),E()(),b(7,"div",6),z("click",function(){return r.openPanel()}),b(8,"div",7),j(9,"img",8),E(),b(10,"p",9),F(11),E()()(),b(12,"div",10),Re(13,b0,6,0,"ul",11),j(14,"app-users",12),Re(15,w0,1,1,"app-chat",13),E()()),i&2&&(W(11),sn(" ",r.currentUser==null?null:r.currentUser.firstName," ",r.currentUser==null?null:r.currentUser.lastName," "),W(2),K("ngIf",r.openedPanel),W(),K("ngClass",r.opened?"basis-1/3":"basis-full"),W(),K("ngIf",r.opened))},dependencies:[Ye,Ar,Rr,$p,Wp]})}return t})();var Gp=[{title:"Home",path:"home",component:zp},{title:"Login",path:"login",component:_h},{title:"Signup",path:"signup",component:vh},{path:"",redirectTo:"/home",pathMatch:"full"}];var C0="@",E0=(()=>{let e=class e{constructor(i,r,s,o,a){this.doc=i,this.delegate=r,this.zone=s,this.animationType=o,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=y(iu,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-N6MZCOJN.js").then(r=>r)).catch(r=>{throw new U(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(i,r){let s=this.delegate.createRenderer(i,r);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let o=new jc(s);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let c=a.createRenderer(i,r);o.use(c),this.scheduler?.notify(9)}).catch(a=>{o.use(s)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(r){vo()},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),jc=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,i,r){this.delegate.insertBefore(e,n,i,r)}removeChild(e,n,i){this.delegate.removeChild(e,n,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,r){this.delegate.setAttribute(e,n,i,r)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,r){this.delegate.setStyle(e,n,i,r)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){this.shouldReplay(n)&&this.replay.push(r=>r.setProperty(e,n,i)),this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.shouldReplay(n)&&this.replay.push(r=>r.listen(e,n,i)),this.delegate.listen(e,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(C0)}};function Hp(t="animations"){return yo("NgAsyncAnimations"),Dt([{provide:mr,useFactory:(e,n,i)=>new E0(e,n,i,t),deps:[X,Vr,fe]},{provide:_o,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var qp={providers:[uu({eventCoalescing:!0}),_d(Gp),{provide:Yn,useClass:Io},Du(),Hp("noop")]};var Kp=(()=>{class t{title="chat";static \u0275fac=function(i){return new(i||t)};static \u0275cmp=ie({type:t,selectors:[["app-root"]],standalone:!0,features:[re],decls:1,vars:0,template:function(i,r){i&1&&j(0,"router-outlet")},dependencies:[_a]})}return t})();var I0="firebase",S0="10.12.4";wt(I0,S0,"app");var T0={apiKey:"AIzaSyBaRYK1qyGrBi17GTypMzXGc5-vhC3HfBc",authDomain:"chat-e5d4f.firebaseapp.com",projectId:"chat-e5d4f",storageBucket:"chat-e5d4f.appspot.com",messagingSenderId:"841961552150",appId:"1:841961552150:web:d2639c5f872acf76e73837",databaseURL:"https://chat-e5d4f-default-rtdb.europe-west1.firebasedatabase.app"};ll(T0);Pu(Kp,qp).catch(t=>console.error(t));
