import{$ as K,$a as kr,A as Ot,Aa as y,Ab as Lo,B as iu,Ba as Mo,Bb as Br,C as To,Ca as mu,Cb as $r,D as ht,Da as Nr,Db as Wr,E as ru,Ea as pt,Eb as Gr,F as fn,Fa as No,Fb as _t,G as ft,Ga as ge,Gb as Du,H as Ao,Ha as gu,Hb as Fe,I as su,Ia as ci,Ib as xu,J as ou,Ja as Be,Jb as Ru,K as au,Ka as Or,Kb as zr,L as Ar,La as _u,Lb as Hr,M as xe,Ma as vu,N as Dr,Na as fe,O as oe,Oa as Vt,Ob as Ut,P as W,Pa as P,Pb as it,Q as kt,Qa as _n,R as S,Ra as g,Rb as ye,S as de,Sa as v,Sb as Vo,T as lu,Ta as R,Tb as Mu,U as V,Ua as ui,Ub as rt,V as Do,Va as U,W as E,Wa as ve,X as w,Xa as yu,Y as oi,Ya as Oo,Z as X,Za as ko,_ as he,_a as A,a as _,aa as Pt,ab as vn,b as $,ba as cu,bb as Pr,ca as pn,cb as Fr,d as Y,da as Pe,db as Lr,e as Xc,ea as Ze,eb as nt,f as Zc,fa as mn,fb as Z,g as ii,ga as gn,gb as bu,h as Co,ha as et,hb as wu,i as Eo,ia as Ft,ib as Cu,j as Te,ja as Lt,jb as Vr,k as Ae,ka as uu,kb as jr,l as ut,la as xr,lb as Po,m as ue,ma as xo,mb as Ur,n as I,na as du,nb as Fo,o as ri,oa as Ee,ob as Eu,p as eu,pa as Rr,pb as jt,q as tu,qa as ae,qb as Iu,r as k,ra as hu,rb as Su,s as si,sa as Mr,sb as mt,t as De,ta as fu,tb as di,u as Io,ua as tt,ub as gt,v as Tr,va as Ro,vb as yn,w as So,wa as ai,wb as Tu,x as nu,xa as pu,xb as Au,y as dt,ya as li,yb as ee,z as hn,za as F,zb as hi}from"./chunk-PX2KDEKL.js";var pi=class{},Kr=class{},re=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let i=n.indexOf(":");if(i>0){let r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,i)=>{this.setHeaderEntries(i,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,i])=>{this.setHeaderEntries(n,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,n);let r=(e.op==="a"?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let i=(Array.isArray(n)?n:[n]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var Uo=class{encodeKey(e){return Nu(e)}encodeValue(e){return Nu(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function mm(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,a]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=n.get(o)||[];c.push(a),n.set(o,c)}),n}var gm=/%(\d[a-f0-9])/gi,_m={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Nu(t){return encodeURIComponent(t).replace(gm,(e,n)=>_m[n]??e)}function qr(t){return`${t}`}var yt=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Uo,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=mm(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let i=e.fromObject[n],r=Array.isArray(i)?i.map(qr):[qr(i)];this.map.set(n,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(qr(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(qr(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Bo=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function vm(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Ou(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function ku(t){return typeof Blob<"u"&&t instanceof Blob}function Pu(t){return typeof FormData<"u"&&t instanceof FormData}function ym(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var fi=class t{constructor(e,n,i,r){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(vm(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new re,this.context??=new Bo,!this.params)this.params=new yt,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Ou(this.body)||ku(this.body)||Pu(this.body)||ym(this.body)?this.body:this.body instanceof yt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Pu(this.body)?null:ku(this.body)?this.body.type||null:Ou(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof yt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new t(n,i,o,{params:u,headers:l,context:d,reportProgress:c,responseType:r,withCredentials:a,transferCache:s})}},bt=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(bt||{}),mi=class{constructor(e,n=200,i="OK"){this.headers=e.headers||new re,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Yr=class t extends mi{constructor(e={}){super(e),this.type=bt.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},gi=class t extends mi{constructor(e={}){super(e),this.type=bt.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},vt=class extends mi{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},ju=200,bm=204;function jo(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var Go=(()=>{let e=class e{constructor(i){this.handler=i}request(i,r,s={}){let o;if(i instanceof fi)o=i;else{let l;s.headers instanceof re?l=s.headers:l=new re(s.headers);let u;s.params&&(s.params instanceof yt?u=s.params:u=new yt({fromObject:s.params})),o=new fi(i,r,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:u,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=I(o).pipe(Ot(l=>this.handler.handle(l)));if(i instanceof fi||s.observe==="events")return a;let c=a.pipe(dt(l=>l instanceof gi));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(k(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(k(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(k(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(k(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(i,r={}){return this.request("DELETE",i,r)}get(i,r={}){return this.request("GET",i,r)}head(i,r={}){return this.request("HEAD",i,r)}jsonp(i,r){return this.request("JSONP",i,{params:new yt().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,r={}){return this.request("OPTIONS",i,r)}patch(i,r,s={}){return this.request("PATCH",i,jo(s,r))}post(i,r,s={}){return this.request("POST",i,jo(s,r))}put(i,r,s={}){return this.request("PUT",i,jo(s,r))}};e.\u0275fac=function(r){return new(r||e)(E(pi))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),wm=/^\)\]\}',?\n/,Cm="X-Request-URL";function Fu(t){if(t.url)return t.url;let e=Cm.toLocaleLowerCase();return t.headers.get(e)}var Em=(()=>{let e=class e{constructor(){this.fetchImpl=w($o,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=w(ge)}handle(i){return new ii(r=>{let s=new AbortController;return this.doRequest(i,s.signal,r).then(Wo,o=>r.error(new vt({error:o}))),()=>s.abort()})}doRequest(i,r,s){return Y(this,null,function*(){let o=this.createRequestInit(i),a;try{let p=this.ngZone.runOutsideAngular(()=>this.fetchImpl(i.urlWithParams,_({signal:r},o)));Im(p),s.next({type:bt.Sent}),a=yield p}catch(p){s.error(new vt({error:p,status:p.status??0,statusText:p.statusText,url:i.urlWithParams,headers:p.headers}));return}let c=new re(a.headers),l=a.statusText,u=Fu(a)??i.urlWithParams,d=a.status,h=null;if(i.reportProgress&&s.next(new Yr({headers:c,status:d,statusText:l,url:u})),a.body){let p=a.headers.get("content-length"),C=[],b=a.body.getReader(),x=0,q,ie,J=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Y(this,null,function*(){for(;;){let{done:Nt,value:ni}=yield b.read();if(Nt)break;if(C.push(ni),x+=ni.length,i.reportProgress){ie=i.responseType==="text"?(ie??"")+(q??=new TextDecoder).decode(ni,{stream:!0}):void 0;let Jc=()=>s.next({type:bt.DownloadProgress,total:p?+p:void 0,loaded:x,partialText:ie});J?J.run(Jc):Jc()}}}));let ti=this.concatChunks(C,x);try{let Nt=a.headers.get("Content-Type")??"";h=this.parseBody(i,ti,Nt)}catch(Nt){s.error(new vt({error:Nt,headers:new re(a.headers),status:a.status,statusText:a.statusText,url:Fu(a)??i.urlWithParams}));return}}d===0&&(d=h?ju:0),d>=200&&d<300?(s.next(new gi({body:h,headers:c,status:d,statusText:l,url:u})),s.complete()):s.error(new vt({error:h,headers:c,status:d,statusText:l,url:u}))})}parseBody(i,r,s){switch(i.responseType){case"json":let o=new TextDecoder().decode(r).replace(wm,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:s});case"arraybuffer":return r.buffer}}createRequestInit(i){let r={},s=i.withCredentials?"include":void 0;if(i.headers.forEach((o,a)=>r[o]=a.join(",")),i.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!i.headers.has("Content-Type")){let o=i.detectContentTypeHeader();o!==null&&(r["Content-Type"]=o)}return{body:i.serializeBody(),method:i.method,headers:r,credentials:s}}concatChunks(i,r){let s=new Uint8Array(r),o=0;for(let a of i)s.set(a,o),o+=a.length;return s}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),$o=class{};function Wo(){}function Im(t){t.then(Wo,Wo)}function Sm(t,e){return e(t)}function Tm(t,e,n){return(i,r)=>Pe(n,()=>e(i,s=>t(s,r)))}var Uu=new V(""),Am=new V(""),Dm=new V("",{providedIn:"root",factory:()=>!0});var Lu=(()=>{let e=class e extends pi{constructor(i,r){super(),this.backend=i,this.injector=r,this.chain=null,this.pendingTasks=w(Rr),this.contributeToStability=w(Dm)}handle(i){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Uu),...this.injector.get(Am,[])]));this.chain=r.reduceRight((s,o)=>Tm(s,o,this.injector),Sm)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(i,s=>this.backend.handle(s)).pipe(fn(()=>this.pendingTasks.remove(r)))}else return this.chain(i,r=>this.backend.handle(r))}};e.\u0275fac=function(r){return new(r||e)(E(Kr),E(pn))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();var xm=/^\)\]\}',?\n/;function Rm(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var Vu=(()=>{let e=class e{constructor(i){this.xhrFactory=i}handle(i){if(i.method==="JSONP")throw new W(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?ue(r.\u0275loadImpl()):I(null)).pipe(xe(()=>new ii(o=>{let a=r.build();if(a.open(i.method,i.urlWithParams),i.withCredentials&&(a.withCredentials=!0),i.headers.forEach((b,x)=>a.setRequestHeader(b,x.join(","))),i.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){let b=i.detectContentTypeHeader();b!==null&&a.setRequestHeader("Content-Type",b)}if(i.responseType){let b=i.responseType.toLowerCase();a.responseType=b!=="json"?b:"text"}let c=i.serializeBody(),l=null,u=()=>{if(l!==null)return l;let b=a.statusText||"OK",x=new re(a.getAllResponseHeaders()),q=Rm(a)||i.url;return l=new Yr({headers:x,status:a.status,statusText:b,url:q}),l},d=()=>{let{headers:b,status:x,statusText:q,url:ie}=u(),J=null;x!==bm&&(J=typeof a.response>"u"?a.responseText:a.response),x===0&&(x=J?ju:0);let ti=x>=200&&x<300;if(i.responseType==="json"&&typeof J=="string"){let Nt=J;J=J.replace(xm,"");try{J=J!==""?JSON.parse(J):null}catch(ni){J=Nt,ti&&(ti=!1,J={error:ni,text:J})}}ti?(o.next(new gi({body:J,headers:b,status:x,statusText:q,url:ie||void 0})),o.complete()):o.error(new vt({error:J,headers:b,status:x,statusText:q,url:ie||void 0}))},h=b=>{let{url:x}=u(),q=new vt({error:b,status:a.status||0,statusText:a.statusText||"Unknown Error",url:x||void 0});o.error(q)},f=!1,p=b=>{f||(o.next(u()),f=!0);let x={type:bt.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(x.total=b.total),i.responseType==="text"&&a.responseText&&(x.partialText=a.responseText),o.next(x)},C=b=>{let x={type:bt.UploadProgress,loaded:b.loaded};b.lengthComputable&&(x.total=b.total),o.next(x)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),i.reportProgress&&(a.addEventListener("progress",p),c!==null&&a.upload&&a.upload.addEventListener("progress",C)),a.send(c),o.next({type:bt.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),i.reportProgress&&(a.removeEventListener("progress",p),c!==null&&a.upload&&a.upload.removeEventListener("progress",C)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(r){return new(r||e)(E(Hr))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Bu=new V(""),Mm="XSRF-TOKEN",Nm=new V("",{providedIn:"root",factory:()=>Mm}),Om="X-XSRF-TOKEN",km=new V("",{providedIn:"root",factory:()=>Om}),Qr=class{},Pm=(()=>{let e=class e{constructor(i,r,s){this.doc=i,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=$r(i,this.cookieName),this.lastCookieString=i),this.lastToken}};e.\u0275fac=function(r){return new(r||e)(E(ee),E(tt),E(Nm))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();function Fm(t,e){let n=t.url.toLowerCase();if(!w(Bu)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let i=w(Qr).getToken(),r=w(km);return i!=null&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,i)})),e(t)}function $u(...t){let e=[Go,Vu,Lu,{provide:pi,useExisting:Lu},{provide:Kr,useFactory:()=>w(Em,{optional:!0})??w(Vu)},{provide:Uu,useValue:Fm,multi:!0},{provide:Bu,useValue:!0},{provide:Qr,useClass:Pm}];for(let n of t)e.push(...n.\u0275providers);return Pt(e)}var qo=class extends Au{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ko=class t extends qo{static makeCurrent(){Tu(new t)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=Um();return n==null?null:Bm(n)}resetBaseElement(){_i=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $r(document.cookie,e)}},_i=null;function Um(){return _i=_i||document.querySelector("base"),_i?_i.getAttribute("href"):null}function Bm(t){return new URL(t,document.baseURI).pathname}var $m=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Jr=new V(""),zu=(()=>{let e=class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,s){return this._findPluginFor(r).addEventListener(i,r,s)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new W(5101,!1);return this._eventNameToPlugin.set(i,r),r}};e.\u0275fac=function(r){return new(r||e)(E(Jr),E(ge))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),vi=class{constructor(e){this._doc=e}},zo="ng-app-id",Hu=(()=>{let e=class e{constructor(i,r,s,o={}){this.doc=i,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=zr(o),this.resetHostNodes()}addStyles(i){for(let r of i)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(i){for(let r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){let r=this.styleRef;r.get(i)?.elements?.forEach(s=>s.remove()),r.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${zo}="${this.appId}"]`);if(i?.length){let r=new Map;return i.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(i,r){let s=this.styleRef;if(s.has(i)){let o=s.get(i);return o.usage+=r,o.usage}return s.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===i)return s.delete(r),o.removeAttribute(zo),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(zo,this.appId),i.appendChild(a),a}}addStyleToHost(i,r){let s=this.getStyleElement(i,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(E(ee),E(Mr),E(ai,8),E(tt))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Ho={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Jo=/%COMP%/g,qu="%COMP%",Wm=`_nghost-${qu}`,Gm=`_ngcontent-${qu}`,zm=!0,Hm=new V("",{providedIn:"root",factory:()=>zm});function qm(t){return Gm.replace(Jo,t)}function Km(t){return Wm.replace(Jo,t)}function Ku(t,e){return e.map(n=>n.replace(Jo,t))}var Xr=(()=>{let e=class e{constructor(i,r,s,o,a,c,l,u=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=zr(c),this.defaultRenderer=new yi(i,a,l,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===oi.ShadowDom&&(r=$(_({},r),{encapsulation:oi.Emulated}));let s=this.getOrCreateRenderer(i,r);return s instanceof Zr?s.applyToHost(i):s instanceof bi&&s.applyStyles(),s}getOrCreateRenderer(i,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case oi.Emulated:o=new Zr(l,u,r,this.appId,d,a,c,h);break;case oi.ShadowDom:return new Yo(l,u,i,r,a,c,this.nonce,h);default:o=new bi(l,u,r,d,a,c,h);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(E(zu),E(Hu),E(Mr),E(Hm),E(ee),E(tt),E(ge),E(ai))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),yi=class{constructor(e,n,i,r){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Ho[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(Wu(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(Wu(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new W(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;let s=Ho[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){let r=Ho[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(li.DashCase|li.Important)?e.style.setProperty(n,i,r&li.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&li.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e!=null&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if(typeof e=="string"&&(e=yn().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function Wu(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Yo=class extends yi{constructor(e,n,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=Ku(r.id,r.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},bi=class extends yi{constructor(e,n,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=c?Ku(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Zr=class extends bi{constructor(e,n,i,r,s,o,a,c){let l=r+"-"+i.id;super(e,n,i,s,o,a,c,l),this.contentAttr=qm(l),this.hostAttr=Km(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}},Ym=(()=>{let e=class e extends vi{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,s){return i.addEventListener(r,s,!1),()=>this.removeEventListener(i,r,s)}removeEventListener(i,r,s){return i.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(E(ee))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Qm=(()=>{let e=class e extends vi{constructor(i){super(i),this.delegate=w(Su,{optional:!0})}supports(i){return this.delegate?this.delegate.supports(i):!1}addEventListener(i,r,s){return this.delegate.addEventListener(i,r,s)}removeEventListener(i,r,s){return this.delegate.removeEventListener(i,r,s)}};e.\u0275fac=function(r){return new(r||e)(E(ee))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Gu=["alt","control","meta","shift"],Jm={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Xm={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Zm=(()=>{let e=class e extends vi{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yn().onAndCancel(i,o.domEventName,a))}static parseEventName(i){let r=i.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),Gu.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),a+=u+".")}),a+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(i,r){let s=Jm[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(s=i.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Gu.forEach(a=>{if(a!==s){let c=Xm[a];c(i)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(i,r,s){return o=>{e.matchEventFullKeyCode(o,i)&&s.runGuarded(()=>r(o))}}static _normalizeKey(i){return i==="esc"?"escape":i}};e.\u0275fac=function(r){return new(r||e)(E(ee))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})();function Yu(t,e){return Iu(_({rootComponent:t},eg(e)))}function eg(t){return{appProviders:[...sg,...t?.providers??[]],platformProviders:rg}}function tg(){Ko.makeCurrent()}function ng(){return new xo}function ig(){return hu(document),document}var rg=[{provide:tt,useValue:xu},{provide:fu,useValue:tg,multi:!0},{provide:ee,useFactory:ig,deps:[]}];var sg=[{provide:cu,useValue:"root"},{provide:xo,useFactory:ng,deps:[]},{provide:Jr,useClass:Ym,multi:!0,deps:[ee,ge,tt]},{provide:Jr,useClass:Zm,multi:!0,deps:[ee]},{provide:Jr,useClass:Qm,multi:!0},Xr,Hu,zu,{provide:Nr,useExisting:Xr},{provide:Hr,useClass:$m,deps:[]},[]];var Qu=(()=>{let e=class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}};e.\u0275fac=function(r){return new(r||e)(E(ee))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var D="primary",Fi=Symbol("RouteTitle"),na=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Tn(t){return new na(t)}function lg(t,e,n){let i=n.path.split("/");if(i.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||i.length<t.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],a=t[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function cg(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!$e(t[n],e[n]))return!1;return!0}function $e(t,e){let n=t?ia(t):void 0,i=e?ia(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!rd(t[r],e[r]))return!1;return!0}function ia(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function rd(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}else return t===e}function sd(t){return t.length>0?t[t.length-1]:null}function wt(t){return eu(t)?t:jr(t)?ue(Promise.resolve(t)):I(t)}var ug={exact:ad,subset:ld},od={exact:dg,subset:hg,ignored:()=>!0};function Ju(t,e,n){return ug[n.paths](t.root,e.root,n.matrixParams)&&od[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function dg(t,e){return $e(t,e)}function ad(t,e,n){if(!$t(t.segments,e.segments)||!ns(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!t.children[i]||!ad(t.children[i],e.children[i],n))return!1;return!0}function hg(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>rd(t[n],e[n]))}function ld(t,e,n){return cd(t,e,e.segments,n)}function cd(t,e,n,i){if(t.segments.length>n.length){let r=t.segments.slice(0,n.length);return!(!$t(r,n)||e.hasChildren()||!ns(r,n,i))}else if(t.segments.length===n.length){if(!$t(t.segments,n)||!ns(t.segments,n,i))return!1;for(let r in e.children)if(!t.children[r]||!ld(t.children[r],e.children[r],i))return!1;return!0}else{let r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!$t(t.segments,r)||!ns(t.segments,r,i)||!t.children[D]?!1:cd(t.children[D],e,s,i)}}function ns(t,e,n){return e.every((i,r)=>od[n](t[r].parameters,i.parameters))}var ot=class{constructor(e=new j([],{}),n={},i=null){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Tn(this.queryParams),this._queryParamMap}toString(){return mg.serialize(this)}},j=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return is(this)}},Bt=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Tn(this.parameters),this._parameterMap}toString(){return dd(this)}};function fg(t,e){return $t(t,e)&&t.every((n,i)=>$e(n.parameters,e[i].parameters))}function $t(t,e){return t.length!==e.length?!1:t.every((n,i)=>n.path===e[i].path)}function pg(t,e){let n=[];return Object.entries(t.children).forEach(([i,r])=>{i===D&&(n=n.concat(e(r,i)))}),Object.entries(t.children).forEach(([i,r])=>{i!==D&&(n=n.concat(e(r,i)))}),n}var xa=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>new Ai,providedIn:"root"});let t=e;return t})(),Ai=class{parse(e){let n=new sa(e);return new ot(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${wi(e.root,!0)}`,i=vg(e.queryParams),r=typeof e.fragment=="string"?`#${gg(e.fragment)}`:"";return`${n}${i}${r}`}},mg=new Ai;function is(t){return t.segments.map(e=>dd(e)).join("/")}function wi(t,e){if(!t.hasChildren())return is(t);if(e){let n=t.children[D]?wi(t.children[D],!1):"",i=[];return Object.entries(t.children).forEach(([r,s])=>{r!==D&&i.push(`${r}:${wi(s,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}else{let n=pg(t,(i,r)=>r===D?[wi(t.children[D],!1)]:[`${r}:${wi(i,!1)}`]);return Object.keys(t.children).length===1&&t.children[D]!=null?`${is(t)}/${n[0]}`:`${is(t)}/(${n.join("//")})`}}function ud(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function es(t){return ud(t).replace(/%3B/gi,";")}function gg(t){return encodeURI(t)}function ra(t){return ud(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function rs(t){return decodeURIComponent(t)}function Xu(t){return rs(t.replace(/\+/g,"%20"))}function dd(t){return`${ra(t.path)}${_g(t.parameters)}`}function _g(t){return Object.entries(t).map(([e,n])=>`;${ra(e)}=${ra(n)}`).join("")}function vg(t){let e=Object.entries(t).map(([n,i])=>Array.isArray(i)?i.map(r=>`${es(n)}=${es(r)}`).join("&"):`${es(n)}=${es(i)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var yg=/^[^\/()?;#]+/;function Xo(t){let e=t.match(yg);return e?e[0]:""}var bg=/^[^\/()?;=#]+/;function wg(t){let e=t.match(bg);return e?e[0]:""}var Cg=/^[^=?&#]+/;function Eg(t){let e=t.match(Cg);return e?e[0]:""}var Ig=/^[^&#]+/;function Sg(t){let e=t.match(Ig);return e?e[0]:""}var sa=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new j([],{}):new j([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[D]=new j(e,n)),i}parseSegment(){let e=Xo(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new W(4009,!1);return this.capture(e),new Bt(rs(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=wg(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let r=Xo(this.remaining);r&&(i=r,this.capture(i))}e[rs(n)]=rs(i)}parseQueryParam(e){let n=Eg(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let o=Sg(this.remaining);o&&(i=o,this.capture(i))}let r=Xu(n),s=Xu(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Xo(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new W(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=D);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[D]:new j([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new W(4011,!1)}};function hd(t){return t.segments.length>0?new j([],{[D]:t}):t}function fd(t){let e={};for(let[i,r]of Object.entries(t.children)){let s=fd(r);if(i===D&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let n=new j(t.segments,e);return Tg(n)}function Tg(t){if(t.numberOfChildren===1&&t.children[D]){let e=t.children[D];return new j(t.segments.concat(e.segments),e.children)}return t}function Wt(t){return t instanceof ot}function Ag(t,e,n=null,i=null){let r=pd(t);return md(r,e,n,i)}function pd(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new j(s.url,o);return s===t&&(e=a),a}let i=n(t.root),r=hd(i);return e??r}function md(t,e,n,i){let r=t;for(;r.parent;)r=r.parent;if(e.length===0)return Zo(r,r,r,n,i);let s=Dg(e);if(s.toRoot())return Zo(r,r,new j([],{}),n,i);let o=xg(s,r,t),a=o.processChildren?Ii(o.segmentGroup,o.index,s.commands):_d(o.segmentGroup,o.index,s.commands);return Zo(r,o.segmentGroup,a,n,i)}function ss(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Di(t){return typeof t=="object"&&t!=null&&t.outlets}function Zo(t,e,n,i,r){let s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;t===e?o=n:o=gd(t,e,n);let a=hd(fd(o));return new ot(a,s,r)}function gd(t,e,n){let i={};return Object.entries(t.children).forEach(([r,s])=>{s===e?i[r]=n:i[r]=gd(s,e,n)}),new j(t.segments,i)}var os=class{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&ss(i[0]))throw new W(4003,!1);let r=i.find(Di);if(r&&r!==sd(i))throw new W(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Dg(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new os(!0,0,t);let e=0,n=!1,i=t.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new os(n,e,i)}var En=class{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}};function xg(t,e,n){if(t.isAbsolute)return new En(e,!0,0);if(!n)return new En(e,!1,NaN);if(n.parent===null)return new En(n,!0,0);let i=ss(t.commands[0])?0:1,r=n.segments.length-1+i;return Rg(n,r,t.numberOfDoubleDots)}function Rg(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new W(4005,!1);r=i.segments.length}return new En(i,!1,r-s)}function Mg(t){return Di(t[0])?t[0].outlets:{[D]:t}}function _d(t,e,n){if(t??=new j([],{}),t.segments.length===0&&t.hasChildren())return Ii(t,e,n);let i=Ng(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){let s=new j(t.segments.slice(0,i.pathIndex),{});return s.children[D]=new j(t.segments.slice(i.pathIndex),t.children),Ii(s,0,r)}else return i.match&&r.length===0?new j(t.segments,{}):i.match&&!t.hasChildren()?oa(t,e,n):i.match?Ii(t,0,r):oa(t,e,n)}function Ii(t,e,n){if(n.length===0)return new j(t.segments,{});{let i=Mg(n),r={};if(Object.keys(i).some(s=>s!==D)&&t.children[D]&&t.numberOfChildren===1&&t.children[D].segments.length===0){let s=Ii(t.children[D],e,n);return new j(t.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=_d(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new j(t.segments,r)}}function Ng(t,e,n){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;let o=t.segments[r],a=n[i];if(Di(a))break;let c=`${a}`,l=i<n.length-1?n[i+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!ed(c,l,o))return s;i+=2}else{if(!ed(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function oa(t,e,n){let i=t.segments.slice(0,e),r=0;for(;r<n.length;){let s=n[r];if(Di(s)){let c=Og(s.outlets);return new j(i,c)}if(r===0&&ss(n[0])){let c=t.segments[e];i.push(new Bt(c.path,Zu(n[0]))),r++;continue}let o=Di(s)?s.outlets[D]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&ss(a)?(i.push(new Bt(o,Zu(a))),r+=2):(i.push(new Bt(o,{})),r++)}return new j(i,{})}function Og(t){let e={};return Object.entries(t).forEach(([n,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[n]=oa(new j([],{}),0,i))}),e}function Zu(t){let e={};return Object.entries(t).forEach(([n,i])=>e[n]=`${i}`),e}function ed(t,e,n){return t==n.path&&$e(e,n.parameters)}var Si="imperative",le=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(le||{}),Re=class{constructor(e,n){this.id=e,this.url=n}},xi=class extends Re{constructor(e,n,i="imperative",r=null){super(e,n),this.type=le.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},at=class extends Re{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i,this.type=le.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Se=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Se||{}),aa=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(aa||{}),st=class extends Re{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=le.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Gt=class extends Re{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=le.NavigationSkipped}},Ri=class extends Re{constructor(e,n,i,r){super(e,n),this.error=i,this.target=r,this.type=le.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},as=class extends Re{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=le.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},la=class extends Re{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=le.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ca=class extends Re{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=le.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ua=class extends Re{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=le.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},da=class extends Re{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=le.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ha=class{constructor(e){this.route=e,this.type=le.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},fa=class{constructor(e){this.route=e,this.type=le.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},pa=class{constructor(e){this.snapshot=e,this.type=le.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ma=class{constructor(e){this.snapshot=e,this.type=le.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ga=class{constructor(e){this.snapshot=e,this.type=le.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_a=class{constructor(e){this.snapshot=e,this.type=le.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Mi=class{},An=class{constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function kg(t,e){return t.providers&&!t._injector&&(t._injector=vu(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Le(t){return t.outlet||D}function Pg(t,e){let n=t.filter(i=>Le(i)===e);return n.push(...t.filter(i=>Le(i)!==e)),n}function Li(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var va=class{get injector(){return Li(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ps(this.rootInjector),this.attachRef=null}},ps=(()=>{let e=class e{constructor(i){this.rootInjector=i,this.contexts=new Map}onChildOutletCreated(i,r){let s=this.getOrCreateContext(i);s.outlet=r,this.contexts.set(i,s)}onChildOutletDestroyed(i){let r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new va(this.rootInjector),this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}};e.\u0275fac=function(r){return new(r||e)(E(pn))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ls=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=ya(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){let n=ya(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=ba(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ba(e,this._root).map(n=>n.value)}};function ya(t,e){if(t===e.value)return e;for(let n of e.children){let i=ya(t,n);if(i)return i}return null}function ba(t,e){if(t===e.value)return[e];for(let n of e.children){let i=ba(t,n);if(i.length)return i.unshift(e),i}return[]}var Ie=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Cn(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var cs=class extends ls{constructor(e,n){super(e),this.snapshot=n,Ra(this,e)}toString(){return this.snapshot.toString()}};function vd(t){let e=Fg(t),n=new Ae([new Bt("",{})]),i=new Ae({}),r=new Ae({}),s=new Ae({}),o=new Ae(""),a=new zt(n,i,s,o,r,D,t,e.root);return a.snapshot=e.root,new cs(new Ie(a,[]),e)}function Fg(t){let e={},n={},i={},r="",s=new In([],e,i,r,n,D,t,null,{});return new ds("",new Ie(s,[]))}var zt=class{constructor(e,n,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(k(l=>l[Fi]))??I(void 0),this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(k(e=>Tn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(k(e=>Tn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function us(t,e,n="emptyOnly"){let i,{routeConfig:r}=t;return e!==null&&(n==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:_(_({},e.params),t.params),data:_(_({},e.data),t.data),resolve:_(_(_(_({},t.data),e.data),r?.data),t._resolvedData)}:i={params:_({},t.params),data:_({},t.data),resolve:_(_({},t.data),t._resolvedData??{})},r&&bd(r)&&(i.resolve[Fi]=r.title),i}var In=class{get title(){return this.data?.[Fi]}constructor(e,n,i,r,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Tn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Tn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},ds=class extends ls{constructor(e,n){super(n),this.url=e,Ra(this,n)}toString(){return yd(this._root)}};function Ra(t,e){e.value._routerState=t,e.children.forEach(n=>Ra(t,n))}function yd(t){let e=t.children.length>0?` { ${t.children.map(yd).join(", ")} } `:"";return`${t.value}${e}`}function ea(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,$e(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),$e(e.params,n.params)||t.paramsSubject.next(n.params),cg(e.url,n.url)||t.urlSubject.next(n.url),$e(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function wa(t,e){let n=$e(t.params,e.params)&&fg(t.url,e.url),i=!t.parent!=!e.parent;return n&&!i&&(!t.parent||wa(t.parent,e.parent))}function bd(t){return typeof t.title=="string"||t.title===null}var Ma=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=D,this.activateEvents=new ae,this.deactivateEvents=new ae,this.attachEvents=new ae,this.detachEvents=new ae,this.parentContexts=w(ps),this.location=w(gu),this.changeDetector=w(jt),this.inputBinder=w(Na,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:r,previousValue:s}=i.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new W(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new W(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new W(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new W(4013,!1);this._activatedRoute=i;let s=this.location,a=i.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Ca(i,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=K({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ze]});let t=e;return t})(),Ca=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===zt?this.route:e===ps?this.childContexts:this.parent.get(e,n)}},Na=new V("");function Lg(t,e,n){let i=Ni(t,e._root,n?n._root:void 0);return new cs(i,e)}function Ni(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let i=n.value;i._futureSnapshot=e.value;let r=Vg(t,e,n);return new Ie(i,r)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Ni(t,a)),o}}let i=jg(e.value),r=e.children.map(s=>Ni(t,s));return new Ie(i,r)}}function Vg(t,e,n){return e.children.map(i=>{for(let r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return Ni(t,i,r);return Ni(t,i)})}function jg(t){return new zt(new Ae(t.url),new Ae(t.params),new Ae(t.queryParams),new Ae(t.fragment),new Ae(t.data),t.outlet,t.component,t)}var Oi=class{constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},wd="ngNavigationCancelingError";function hs(t,e){let{redirectTo:n,navigationBehaviorOptions:i}=Wt(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=Cd(!1,Se.Redirect);return r.url=n,r.navigationBehaviorOptions=i,r}function Cd(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[wd]=!0,n.cancellationCode=e,n}function Ug(t){return Ed(t)&&Wt(t.url)}function Ed(t){return!!t&&t[wd]}var Bg=(t,e,n,i)=>k(r=>(new Ea(e,r.targetRouterState,r.currentRouterState,n,i).activate(t),r)),Ea=class{constructor(e,n,i,r,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),ea(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){let r=Cn(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=Cn(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=Cn(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,n,i){let r=Cn(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new _a(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ma(e.value.snapshot))}activateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(ea(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),ea(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}},fs=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Sn=class{constructor(e,n){this.component=e,this.route=n}};function $g(t,e,n){let i=t._root,r=e?e._root:null;return Ci(i,r,n,[i.value])}function Wg(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Rn(t,e){let n=Symbol(),i=e.get(t,n);return i===n?typeof t=="function"&&!lu(t)?t:e.get(t):i}function Ci(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Cn(e);return t.children.forEach(o=>{Gg(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ti(a,n.getContext(o),r)),r}function Gg(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=zg(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new fs(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ci(t,e,a?a.children:null,i,r):Ci(t,e,n,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Sn(a.outlet.component,o))}else o&&Ti(e,a,r),r.canActivateChecks.push(new fs(i)),s.component?Ci(t,null,a?a.children:null,i,r):Ci(t,null,n,i,r);return r}function zg(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!$t(t.url,e.url);case"pathParamsOrQueryParamsChange":return!$t(t.url,e.url)||!$e(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wa(t,e)||!$e(t.queryParams,e.queryParams);case"paramsChange":default:return!wa(t,e)}}function Ti(t,e,n){let i=Cn(t),r=t.value;Object.entries(i).forEach(([s,o])=>{r.component?e?Ti(o,e.children.getContext(s),n):Ti(o,null,n):Ti(o,e,n)}),r.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Sn(e.outlet.component,r)):n.canDeactivateChecks.push(new Sn(null,r)):n.canDeactivateChecks.push(new Sn(null,r))}function Vi(t){return typeof t=="function"}function Hg(t){return typeof t=="boolean"}function qg(t){return t&&Vi(t.canLoad)}function Kg(t){return t&&Vi(t.canActivate)}function Yg(t){return t&&Vi(t.canActivateChild)}function Qg(t){return t&&Vi(t.canDeactivate)}function Jg(t){return t&&Vi(t.canMatch)}function Id(t){return t instanceof tu||t?.name==="EmptyError"}var ts=Symbol("INITIAL_VALUE");function Dn(){return xe(t=>si(t.map(e=>e.pipe(ht(1),Ar(ts)))).pipe(k(e=>{for(let n of e)if(n!==!0){if(n===ts)return ts;if(n===!1||Xg(n))return n}return!0}),dt(e=>e!==ts),ht(1)))}function Xg(t){return Wt(t)||t instanceof Oi}function Zg(t,e){return De(n=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?I($(_({},n),{guardsResult:!0})):e_(o,i,r,t).pipe(De(a=>a&&Hg(a)?t_(i,s,t,e):I(a)),k(a=>$(_({},n),{guardsResult:a})))})}function e_(t,e,n,i){return ue(t).pipe(De(r=>o_(r.component,r.route,n,e,i)),ft(r=>r!==!0,!0))}function t_(t,e,n,i){return ue(e).pipe(Ot(r=>Tr(i_(r.route.parent,i),n_(r.route,i),s_(t,r.path,n),r_(t,r.route,n))),ft(r=>r!==!0,!0))}function n_(t,e){return t!==null&&e&&e(new ga(t)),I(!0)}function i_(t,e){return t!==null&&e&&e(new pa(t)),I(!0)}function r_(t,e,n){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return I(!0);let r=i.map(s=>So(()=>{let o=Li(e)??n,a=Rn(s,o),c=Kg(a)?a.canActivate(e,t):Pe(o,()=>a(e,t));return wt(c).pipe(ft())}));return I(r).pipe(Dn())}function s_(t,e,n){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Wg(o)).filter(o=>o!==null).map(o=>So(()=>{let a=o.guards.map(c=>{let l=Li(o.node)??n,u=Rn(c,l),d=Yg(u)?u.canActivateChild(i,t):Pe(l,()=>u(i,t));return wt(d).pipe(ft())});return I(a).pipe(Dn())}));return I(s).pipe(Dn())}function o_(t,e,n,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return I(!0);let o=s.map(a=>{let c=Li(e)??r,l=Rn(a,c),u=Qg(l)?l.canDeactivate(t,e,n,i):Pe(c,()=>l(t,e,n,i));return wt(u).pipe(ft())});return I(o).pipe(Dn())}function a_(t,e,n,i){let r=e.canLoad;if(r===void 0||r.length===0)return I(!0);let s=r.map(o=>{let a=Rn(o,t),c=qg(a)?a.canLoad(e,n):Pe(t,()=>a(e,n));return wt(c)});return I(s).pipe(Dn(),Sd(i))}function Sd(t){return Zc(oe(e=>{if(typeof e!="boolean")throw hs(t,e)}),k(e=>e===!0))}function l_(t,e,n,i){let r=e.canMatch;if(!r||r.length===0)return I(!0);let s=r.map(o=>{let a=Rn(o,t),c=Jg(a)?a.canMatch(e,n):Pe(t,()=>a(e,n));return wt(c)});return I(s).pipe(Dn(),Sd(i))}var ki=class{constructor(e){this.segmentGroup=e||null}},Pi=class extends Error{constructor(e){super(),this.urlTree=e}};function wn(t){return ri(new ki(t))}function c_(t){return ri(new W(4e3,!1))}function u_(t){return ri(Cd(!1,Se.GuardRejected))}var Ia=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return I(i);if(r.numberOfChildren>1||!r.children[D])return c_(`${e.redirectTo}`);r=r.children[D]}}applyRedirectCommands(e,n,i,r,s){if(typeof n!="string"){let a=n,{queryParams:c,fragment:l,routeConfig:u,url:d,outlet:h,params:f,data:p,title:C}=r,b=Pe(s,()=>a({params:f,data:p,queryParams:c,fragment:l,routeConfig:u,url:d,outlet:h,title:C}));if(b instanceof ot)throw new Pi(b);n=b}let o=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,i);if(n[0]==="/")throw new Pi(o);return o}applyRedirectCreateUrlTree(e,n,i,r){let s=this.createSegmentGroup(e,n.root,i,r);return new ot(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);i[r]=n[a]}else i[r]=s}),i}createSegmentGroup(e,n,i,r){let s=this.createSegments(e,n.segments,i,r),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new j(s,o)}createSegments(e,n,i,r){return n.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){let r=i[n.path.substring(1)];if(!r)throw new W(4001,!1);return r}findOrReturn(e,n){let i=0;for(let r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}},Sa={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function d_(t,e,n,i,r){let s=Oa(t,e,n);return s.matched?(i=kg(e,i),l_(i,e,n,r).pipe(k(o=>o===!0?s:_({},Sa)))):I(s)}function Oa(t,e,n){if(e.path==="**")return h_(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?_({},Sa):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let r=(e.matcher||lg)(n,t,e);if(!r)return _({},Sa);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?_(_({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function h_(t){return{matched:!0,parameters:t.length>0?sd(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function td(t,e,n,i){return n.length>0&&m_(t,n,i)?{segmentGroup:new j(e,p_(i,new j(n,t.children))),slicedSegments:[]}:n.length===0&&g_(t,n,i)?{segmentGroup:new j(t.segments,f_(t,n,i,t.children)),slicedSegments:n}:{segmentGroup:new j(t.segments,t.children),slicedSegments:n}}function f_(t,e,n,i){let r={};for(let s of n)if(ms(t,e,s)&&!i[Le(s)]){let o=new j([],{});r[Le(s)]=o}return _(_({},i),r)}function p_(t,e){let n={};n[D]=e;for(let i of t)if(i.path===""&&Le(i)!==D){let r=new j([],{});n[Le(i)]=r}return n}function m_(t,e,n){return n.some(i=>ms(t,e,i)&&Le(i)!==D)}function g_(t,e,n){return n.some(i=>ms(t,e,i))}function ms(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function __(t,e,n,i){return Le(t)!==i&&(i===D||!ms(e,n,t))?!1:Oa(e,t,n).matched}function v_(t,e,n){return e.length===0&&!t.children[n]}var Ta=class{};function y_(t,e,n,i,r,s,o="emptyOnly"){return new Aa(t,e,n,i,r,o,s).recognize()}var b_=31,Aa=class{constructor(e,n,i,r,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Ia(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new W(4002,`'${e.segmentGroup}'`)}recognize(){let e=td(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(k(({children:n,rootSnapshot:i})=>{let r=new Ie(i,n),s=new ds("",r),o=Ag(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let n=new In([],Object.freeze({}),Object.freeze(_({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),D,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,D,n).pipe(k(i=>({children:i,rootSnapshot:n})),hn(i=>{if(i instanceof Pi)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof ki?this.noMatchError(i):i}))}processSegmentGroup(e,n,i,r,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,n,i,s):this.processSegment(e,n,i,i.segments,r,!0,s).pipe(k(o=>o instanceof Ie?[o]:[]))}processChildren(e,n,i,r){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return ue(s).pipe(Ot(o=>{let a=i.children[o],c=Pg(n,o);return this.processSegmentGroup(e,c,a,o,r)}),ou((o,a)=>(o.push(...a),o)),To(null),su(),De(o=>{if(o===null)return wn(i);let a=Td(o);return w_(a),I(a)}))}processSegment(e,n,i,r,s,o,a){return ue(n).pipe(Ot(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,i,r,s,o,a).pipe(hn(l=>{if(l instanceof ki)return I(null);throw l}))),ft(c=>!!c),hn(c=>{if(Id(c))return v_(i,r,s)?I(new Ta):wn(i);throw c}))}processSegmentAgainstRoute(e,n,i,r,s,o,a,c){return __(i,r,s,o)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,o,c):wn(r):wn(r)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=Oa(n,r,s);if(!c)return wn(n);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>b_&&(this.allowRedirects=!1));let f=new In(s,l,Object.freeze(_({},this.urlTree.queryParams)),this.urlTree.fragment,nd(r),Le(r),r.component??r._loadedComponent??null,r,id(r)),p=us(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let C=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,f,e);return this.applyRedirects.lineralizeSegments(r,C).pipe(De(b=>this.processSegment(e,i,n,b.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,n,i,r,s,o){let a=d_(n,i,r,e,this.urlSerializer);return i.path==="**"&&(n.children={}),a.pipe(xe(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(xe(({routes:l})=>{let u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=c,p=new In(h,d,Object.freeze(_({},this.urlTree.queryParams)),this.urlTree.fragment,nd(i),Le(i),i.component??i._loadedComponent??null,i,id(i)),C=us(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(C.params),p.data=Object.freeze(C.data);let{segmentGroup:b,slicedSegments:x}=td(n,h,f,l);if(x.length===0&&b.hasChildren())return this.processChildren(u,l,b,p).pipe(k(ie=>new Ie(p,ie)));if(l.length===0&&x.length===0)return I(new Ie(p,[]));let q=Le(i)===s;return this.processSegment(u,l,b,x,q?D:s,!0,p).pipe(k(ie=>new Ie(p,ie instanceof Ie?[ie]:[])))}))):wn(n)))}getChildConfig(e,n,i){return n.children?I({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?I({routes:n._loadedRoutes,injector:n._loadedInjector}):a_(e,n,i,this.urlSerializer).pipe(De(r=>r?this.configLoader.loadChildren(e,n).pipe(oe(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):u_(n))):I({routes:[],injector:e})}};function w_(t){t.sort((e,n)=>e.value.outlet===D?-1:n.value.outlet===D?1:e.value.outlet.localeCompare(n.value.outlet))}function C_(t){let e=t.value.routeConfig;return e&&e.path===""}function Td(t){let e=[],n=new Set;for(let i of t){if(!C_(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),n.add(r)):e.push(i)}for(let i of n){let r=Td(i.children);e.push(new Ie(i.value,r))}return e.filter(i=>!n.has(i))}function nd(t){return t.data||{}}function id(t){return t.resolve||{}}function E_(t,e,n,i,r,s){return De(o=>y_(t,e,n,i,o.extractedUrl,r,s).pipe(k(({state:a,tree:c})=>$(_({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function I_(t,e){return De(n=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return I(n);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of Ad(c))o.add(l);let a=0;return ue(o).pipe(Ot(c=>s.has(c)?S_(c,i,t,e):(c.data=us(c,c.parent,t).resolve,I(void 0))),oe(()=>a++),Ao(1),De(c=>a===o.size?I(n):ut))})}function Ad(t){let e=t.children.map(n=>Ad(n)).flat();return[t,...e]}function S_(t,e,n,i){let r=t.routeConfig,s=t._resolve;return r?.title!==void 0&&!bd(r)&&(s[Fi]=r.title),T_(s,t,e,i).pipe(k(o=>(t._resolvedData=o,t.data=us(t,t.parent,n).resolve,null)))}function T_(t,e,n,i){let r=ia(t);if(r.length===0)return I({});let s={};return ue(r).pipe(De(o=>A_(t[o],e,n,i).pipe(ft(),oe(a=>{if(a instanceof Oi)throw hs(new Ai,a);s[o]=a}))),Ao(1),ru(s),hn(o=>Id(o)?ut:ri(o)))}function A_(t,e,n,i){let r=Li(e)??i,s=Rn(t,r),o=s.resolve?s.resolve(e,n):Pe(r,()=>s(e,n));return wt(o)}function ta(t){return xe(e=>{let n=t(e);return n?ue(n).pipe(k(()=>e)):I(e)})}var Dd=(()=>{let e=class e{buildTitle(i){let r,s=i.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===D);return r}getResolvedTitleForRoute(i){return i.data[Fi]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>w(D_),providedIn:"root"});let t=e;return t})(),D_=(()=>{let e=class e extends Dd{constructor(i){super(),this.title=i}updateTitle(i){let r=this.buildTitle(i);r!==void 0&&this.title.setTitle(r)}};e.\u0275fac=function(r){return new(r||e)(E(Qu))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ka=new V("",{providedIn:"root",factory:()=>({})}),x_=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=X({type:e,selectors:[["ng-component"]],standalone:!0,features:[Z],decls:1,vars:0,template:function(r,s){r&1&&R(0,"router-outlet")},dependencies:[Ma],encapsulation:2});let t=e;return t})();function Pa(t){let e=t.children&&t.children.map(Pa),n=e?$(_({},t),{children:e}):_({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==D&&(n.component=x_),n}var Fa=new V(""),R_=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=w(Fo)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return I(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=wt(i.loadComponent()).pipe(k(xd),oe(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),fn(()=>{this.componentLoaders.delete(i)})),s=new Eo(r,()=>new Te).pipe(Co());return this.componentLoaders.set(i,s),s}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return I({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=M_(r,this.compiler,i,this.onLoadEndListener).pipe(fn(()=>{this.childrenLoaders.delete(r)})),a=new Eo(o,()=>new Te).pipe(Co());return this.childrenLoaders.set(r,a),a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function M_(t,e,n,i){return wt(t.loadChildren()).pipe(k(xd),De(r=>r instanceof _u||Array.isArray(r)?I(r):ue(e.compileModuleAsync(r))),k(r=>{i&&i(t);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(n).injector,o=s.get(Fa,[],{optional:!0,self:!0}).flat()),{routes:o.map(Pa),injector:s}}))}function N_(t){return t&&typeof t=="object"&&"default"in t}function xd(t){return N_(t)?t.default:t}var La=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>w(O_),providedIn:"root"});let t=e;return t})(),O_=(()=>{let e=class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),k_=new V("");var P_=new V(""),F_=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Te,this.transitionAbortSubject=new Te,this.configLoader=w(R_),this.environmentInjector=w(pn),this.urlSerializer=w(xa),this.rootContexts=w(ps),this.location=w(Br),this.inputBindingEnabled=w(Na,{optional:!0})!==null,this.titleStrategy=w(Dd),this.options=w(ka,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=w(La),this.createViewTransition=w(k_,{optional:!0}),this.navigationErrorHandler=w(P_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>I(void 0),this.rootComponentType=null;let i=s=>this.events.next(new ha(s)),r=s=>this.events.next(new fa(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let r=++this.navigationId;this.transitions?.next($(_(_({},this.transitions.value),i),{id:r}))}setupNavigations(i,r,s){return this.transitions=new Ae({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Si,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(dt(o=>o.id!==0),k(o=>$(_({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),xe(o=>{let a=!1,c=!1;return I(o).pipe(xe(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Se.SupersededByNewNavigation),ut;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?$(_({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Gt(l.id,this.urlSerializer.serialize(l.rawUrl),h,aa.IgnoredSameUrlNavigation)),l.resolve(!1),ut}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return I(l).pipe(xe(h=>{let f=this.transitions?.getValue();return this.events.next(new xi(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?ut:Promise.resolve(h)}),E_(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),oe(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=$(_({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new as(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:C,extras:b}=l,x=new xi(h,this.urlSerializer.serialize(f),p,C);this.events.next(x);let q=vd(this.rootComponentType).snapshot;return this.currentTransition=o=$(_({},l),{targetSnapshot:q,urlAfterRedirects:f,extras:$(_({},b),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,I(o)}else{let h="";return this.events.next(new Gt(l.id,this.urlSerializer.serialize(l.extractedUrl),h,aa.IgnoredByUrlHandlingStrategy)),l.resolve(!1),ut}}),oe(l=>{let u=new la(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),k(l=>(this.currentTransition=o=$(_({},l),{guards:$g(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Zg(this.environmentInjector,l=>this.events.next(l)),oe(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw hs(this.urlSerializer,l.guardsResult);let u=new ca(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),dt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Se.GuardRejected),!1)),ta(l=>{if(l.guards.canActivateChecks.length)return I(l).pipe(oe(u=>{let d=new ua(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),xe(u=>{let d=!1;return I(u).pipe(I_(this.paramsInheritanceStrategy,this.environmentInjector),oe({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",Se.NoDataFromResolver)}}))}),oe(u=>{let d=new da(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),ta(l=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(oe(f=>{d.component=f}),k(()=>{})));for(let f of d.children)h.push(...u(f));return h};return si(u(l.targetSnapshot.root)).pipe(To(null),ht(1))}),ta(()=>this.afterPreactivation()),xe(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return d?ue(d).pipe(k(()=>o)):I(o)}),k(l=>{let u=Lg(i.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=$(_({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),oe(()=>{this.events.next(new Mi)}),Bg(this.rootContexts,i.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ht(1),oe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new at(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Dr(this.transitionAbortSubject.pipe(oe(l=>{throw l}))),fn(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Se.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),hn(l=>{if(c=!0,Ed(l))this.events.next(new st(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),Ug(l)?this.events.next(new An(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let u=new Ri(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let d=Pe(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(d instanceof Oi){let{message:h,cancellationCode:f}=hs(this.urlSerializer,d);this.events.next(new st(o.id,this.urlSerializer.serialize(o.extractedUrl),h,f)),this.events.next(new An(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(u);let h=i.errorHandler(l);o.resolve(!!h)}}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return ut}))}))}cancelNavigationTransition(i,r,s){let o=new st(i.id,this.urlSerializer.serialize(i.extractedUrl),r,s);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let i=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return i.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function L_(t){return t!==Si}var V_=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>w(j_),providedIn:"root"});let t=e;return t})(),Da=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},j_=(()=>{let e=class e extends Da{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Lt(e)))(s||e)}})(),e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Rd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:()=>w(U_),providedIn:"root"});let t=e;return t})(),U_=(()=>{let e=class e extends Rd{constructor(){super(...arguments),this.location=w(Br),this.urlSerializer=w(xa),this.options=w(ka,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=w(La),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ot,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=vd(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{r.type==="popstate"&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof xi)this.stateMemento=this.createStateMemento();else if(i instanceof Gt)this.rawUrlTree=r.initialUrl;else if(i instanceof as){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??s,r)}}else i instanceof Mi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):i instanceof st&&(i.code===Se.GuardRejected||i.code===Se.NoDataFromResolver)?this.restoreHistory(r):i instanceof Ri?this.restoreHistory(r,!0):i instanceof at&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){let s=i instanceof ot?this.urlSerializer.serialize(i):i;if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let o=this.browserPageId,a=_(_({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(s,"",a)}else{let o=_(_({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(i,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&o===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Lt(e)))(s||e)}})(),e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ei=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Ei||{});function B_(t,e){t.events.pipe(dt(n=>n instanceof at||n instanceof st||n instanceof Ri||n instanceof Gt),k(n=>n instanceof at||n instanceof Gt?Ei.COMPLETE:(n instanceof st?n.code===Se.Redirect||n.code===Se.SupersededByNewNavigation:!1)?Ei.REDIRECTING:Ei.FAILED),dt(n=>n!==Ei.REDIRECTING),ht(1)).subscribe(()=>{e()})}function $_(t){throw t}var W_={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},G_={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},We=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=w(Vr),this.stateManager=w(Rd),this.options=w(ka,{optional:!0})||{},this.pendingTasks=w(Rr),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=w(F_),this.urlSerializer=w(xa),this.location=w(Br),this.urlHandlingStrategy=w(La),this._events=new Te,this.errorHandler=this.options.errorHandler||$_,this.navigated=!1,this.routeReuseStrategy=w(V_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=w(Fa,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!w(Na,{optional:!0}),this.eventsSubscription=new Xc,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof st&&r.code!==Se.Redirect&&r.code!==Se.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof at)this.navigated=!0;else if(r instanceof An){let a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),l=_({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||L_(s.source)},a);this.scheduleNavigation(c,Si,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}H_(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Si,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)})}navigateToSyncWithBrowser(i,r,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=_({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(i);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(Pa),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=_(_({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=pd(f)}catch{(typeof i[0]!="string"||i[0][0]!=="/")&&(i=[]),h=this.currentUrlTree.root}return md(h,i,d,u??null)}navigateByUrl(i,r={skipLocationChange:!1}){let s=Wt(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Si,null,r)}navigate(i,r={skipLocationChange:!1}){return z_(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let s;if(r===!0?s=_({},W_):r===!1?s=_({},G_):s=r,Wt(i))return Ju(this.currentUrlTree,i,s);let o=this.parseUrl(i);return Ju(this.currentUrlTree,o,s)}removeEmptyProps(i){return Object.entries(i).reduce((r,[s,o])=>(o!=null&&(r[s]=o),r),{})}scheduleNavigation(i,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((h,f)=>{c=h,l=f});let d=this.pendingTasks.add();return B_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function z_(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new W(4008,!1)}function H_(t){return!(t instanceof Mi)&&!(t instanceof An)}var xn=(()=>{let e=class e{constructor(i,r,s,o,a,c){this.router=i,this.route=r,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.onChanges=new Te,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=i.events.subscribe(u=>{u instanceof at&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",i)}ngOnChanges(i){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(i){i==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Wt(i)?this.routerLinkInput=i:this.routerLinkInput=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0"))}onClick(i,r,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(i!==0||r||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let i=this.urlTree;this.href=i!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(i)):null;let r=this.href===null?null:pu(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(i,r){let s=this.renderer,o=this.el.nativeElement;r!==null?s.setAttribute(o,i,r):s.removeAttribute(o,i)}get urlTree(){return this.routerLinkInput===null?null:Wt(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(r){return new(r||e)(y(We),y(zt),uu("tabindex"),y(pt),y(Ee),y(hi))},e.\u0275dir=K({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,s){r&1&&U("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&Vt("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",mt],skipLocationChange:[2,"skipLocationChange","skipLocationChange",mt],replaceUrl:[2,"replaceUrl","replaceUrl",mt],routerLink:"routerLink"},standalone:!0,features:[Or,Ze]});let t=e;return t})(),gs=(()=>{let e=class e{get isActive(){return this._isActive}constructor(i,r,s,o,a){this.router=i,this.element=r,this.renderer=s,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new ae,this.routerEventsSubscription=i.events.subscribe(c=>{c instanceof at&&this.update()})}ngAfterContentInit(){I(this.links.changes,I(null)).pipe(Io()).subscribe(i=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let i=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=ue(i).pipe(Io()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(i){let r=Array.isArray(i)?i:i.split(" ");this.classes=r.filter(s=>!!s)}ngOnChanges(i){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let i=this.hasActiveLinks();this.classes.forEach(r=>{i?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),i&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==i&&(this._isActive=i,this.cdr.markForCheck(),this.isActiveChange.emit(i))})}isLinkActive(i){let r=q_(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return s=>{let o=s.urlTree;return o?i.isActive(o,r):!1}}hasActiveLinks(){let i=this.isLinkActive(this.router);return this.link&&i(this.link)||this.links.some(i)}};e.\u0275fac=function(r){return new(r||e)(y(We),y(Ee),y(pt),y(jt),y(xn,8))},e.\u0275dir=K({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(r,s,o){if(r&1&&yu(o,xn,5),r&2){let a;Oo(a=ko())&&(s.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ze]});let t=e;return t})();function q_(t){return!!t.paths}var K_=new V("");function Md(t,...e){return Pt([{provide:Fa,multi:!0,useValue:t},[],{provide:zt,useFactory:Y_,deps:[We]},{provide:Po,multi:!0,useFactory:Q_},e.map(n=>n.\u0275providers)])}function Y_(t){return t.routerState.root}function Q_(){let t=w(xr);return e=>{let n=t.get(Ur);if(e!==n.components[0])return;let i=t.get(We),r=t.get(J_);t.get(X_)===1&&i.initialNavigation(),t.get(Z_,null,Do.Optional)?.setUpPreloading(),t.get(K_,null,Do.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var J_=new V("",{factory:()=>new Te}),X_=new V("",{providedIn:"root",factory:()=>1});var Z_=new V("");var Ud=(()=>{let e=class e{constructor(i,r){this._renderer=i,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(i,r){this._renderer.setProperty(this._elementRef.nativeElement,i,r)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}};e.\u0275fac=function(r){return new(r||e)(y(pt),y(Ee))},e.\u0275dir=K({type:e});let t=e;return t})(),Wa=(()=>{let e=class e extends Ud{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Lt(e)))(s||e)}})(),e.\u0275dir=K({type:e,features:[Be]});let t=e;return t})(),Wi=new V("");var ev={provide:Wi,useExisting:kt(()=>Me),multi:!0};function tv(){let t=yn()?yn().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var nv=new V(""),Me=(()=>{let e=class e extends Ud{constructor(i,r,s){super(i,r),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!tv())}writeValue(i){let r=i??"";this.setProperty("value",r)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}};e.\u0275fac=function(r){return new(r||e)(y(pt),y(Ee),y(nv,8))},e.\u0275dir=K({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&U("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[nt([ev]),Be]});let t=e;return t})();function Ct(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Bd(t){return t!=null&&typeof t.length=="number"}var Ga=new V(""),za=new V(""),iv=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ce=class{static min(e){return rv(e)}static max(e){return sv(e)}static required(e){return ov(e)}static requiredTrue(e){return av(e)}static email(e){return lv(e)}static minLength(e){return cv(e)}static maxLength(e){return uv(e)}static pattern(e){return dv(e)}static nullValidator(e){return $d(e)}static compose(e){return Kd(e)}static composeAsync(e){return Qd(e)}};function rv(t){return e=>{if(Ct(e.value)||Ct(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function sv(t){return e=>{if(Ct(e.value)||Ct(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function ov(t){return Ct(t.value)?{required:!0}:null}function av(t){return t.value===!0?null:{required:!0}}function lv(t){return Ct(t.value)||iv.test(t.value)?null:{email:!0}}function cv(t){return e=>Ct(e.value)||!Bd(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function uv(t){return e=>Bd(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function dv(t){if(!t)return $d;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),i=>{if(Ct(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}function $d(t){return null}function Wd(t){return t!=null}function Gd(t){return jr(t)?ue(t):t}function zd(t){let e={};return t.forEach(n=>{e=n!=null?_(_({},e),n):e}),Object.keys(e).length===0?null:e}function Hd(t,e){return e.map(n=>n(t))}function hv(t){return!t.validate}function qd(t){return t.map(e=>hv(e)?e:n=>e.validate(n))}function Kd(t){if(!t)return null;let e=t.filter(Wd);return e.length==0?null:function(n){return zd(Hd(n,e))}}function Yd(t){return t!=null?Kd(qd(t)):null}function Qd(t){if(!t)return null;let e=t.filter(Wd);return e.length==0?null:function(n){let i=Hd(n,e).map(Gd);return nu(i).pipe(k(zd))}}function Jd(t){return t!=null?Qd(qd(t)):null}function Nd(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Xd(t){return t._rawValidators}function Zd(t){return t._rawAsyncValidators}function ja(t){return t?Array.isArray(t)?t:[t]:[]}function vs(t,e){return Array.isArray(t)?t.includes(e):t===e}function Od(t,e){let n=ja(e);return ja(t).forEach(r=>{vs(n,r)||n.push(r)}),n}function kd(t,e){return ja(e).filter(n=>!vs(t,n))}var ys=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Yd(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Jd(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Ht=class extends ys{get formDirective(){return null}get path(){return null}},qt=class extends ys{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},bs=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},fv={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},FE=$(_({},fv),{"[class.ng-submitted]":"isSubmitted"}),Ge=(()=>{let e=class e extends bs{constructor(i){super(i)}};e.\u0275fac=function(r){return new(r||e)(y(qt,2))},e.\u0275dir=K({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&_n("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Be]});let t=e;return t})(),On=(()=>{let e=class e extends bs{constructor(i){super(i)}};e.\u0275fac=function(r){return new(r||e)(y(Ht,10))},e.\u0275dir=K({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,s){r&2&&_n("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Be]});let t=e;return t})();var ji="VALID",_s="INVALID",Mn="PENDING",Ui="DISABLED",Et=class{},ws=class extends Et{constructor(e,n){super(),this.value=e,this.source=n}},Bi=class extends Et{constructor(e,n){super(),this.pristine=e,this.source=n}},$i=class extends Et{constructor(e,n){super(),this.touched=e,this.source=n}},Nn=class extends Et{constructor(e,n){super(),this.status=e,this.source=n}},Ua=class extends Et{constructor(e){super(),this.source=e}},Ba=class extends Et{constructor(e){super(),this.source=e}};function eh(t){return(Ss(t)?t.validators:t)||null}function pv(t){return Array.isArray(t)?Yd(t):t||null}function th(t,e){return(Ss(e)?e.asyncValidators:t)||null}function mv(t){return Array.isArray(t)?Jd(t):t||null}function Ss(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function gv(t,e,n){let i=t.controls;if(!(e?Object.keys(i):i).length)throw new W(1e3,"");if(!i[n])throw new W(1001,"")}function _v(t,e,n){t._forEachChild((i,r)=>{if(n[r]===void 0)throw new W(1002,"")})}var Cs=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=di(()=>this.statusReactive()),this.statusReactive=ci(void 0),this._pristine=di(()=>this.pristineReactive()),this.pristineReactive=ci(!0),this._touched=di(()=>this.touchedReactive()),this.touchedReactive=ci(!1),this._events=new Te,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return gt(this.statusReactive)}set status(e){gt(()=>this.statusReactive.set(e))}get valid(){return this.status===ji}get invalid(){return this.status===_s}get pending(){return this.status==Mn}get disabled(){return this.status===Ui}get enabled(){return this.status!==Ui}get pristine(){return gt(this.pristineReactive)}set pristine(e){gt(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return gt(this.touchedReactive)}set touched(e){gt(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Od(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Od(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(kd(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(kd(e,this._rawAsyncValidators))}hasValidator(e){return vs(this._rawValidators,e)}hasAsyncValidator(e){return vs(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let n=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched($(_({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new $i(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),n&&e.emitEvent!==!1&&this._events.next(new $i(!1,i))}markAsDirty(e={}){let n=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty($(_({},e),{sourceControl:i})),n&&e.emitEvent!==!1&&this._events.next(new Bi(!1,i))}markAsPristine(e={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),n&&e.emitEvent!==!1&&this._events.next(new Bi(!0,i))}markAsPending(e={}){this.status=Mn;let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Nn(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending($(_({},e),{sourceControl:n}))}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ui,this.errors=null,this._forEachChild(r=>{r.disable($(_({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ws(this.value,i)),this._events.next(new Nn(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors($(_({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=ji,this._forEachChild(i=>{i.enable($(_({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors($(_({},e),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ji||this.status===Mn)&&this._runAsyncValidator(i,e.emitEvent)}let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ws(this.value,n)),this._events.next(new Nn(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity($(_({},e),{sourceControl:n}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ui:ji}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=Mn,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let i=Gd(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((i,r)=>i&&i._find(r),this)}getError(e,n){let i=n?this.get(n):this;return i&&i.errors?i.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Nn(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,i)}_initObservables(){this.valueChanges=new ae,this.statusChanges=new ae}_calculateStatus(){return this._allControlsDisabled()?Ui:this.errors?_s:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Mn)?Mn:this._anyControlsHaveStatus(_s)?_s:ji}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),r&&this._events.next(new Bi(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new $i(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ss(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=pv(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=mv(this._rawAsyncValidators)}},It=class extends Cs{constructor(e,n,i){super(eh(n),th(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,i={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){_v(this,!0,e),Object.keys(e).forEach(i=>{gv(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,i)=>(e[i]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,i)=>i._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let i=this.controls[n];i&&e(i,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,i]of Object.entries(this.controls))if(this.contains(n)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,i,r)=>((i.enabled||this.disabled)&&(n[r]=i.value),n))}_reduceChildren(e,n){let i=e;return this._forEachChild((r,s)=>{i=n(i,r,s)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Ts=new V("CallSetDisabledState",{providedIn:"root",factory:()=>As}),As="always";function nh(t,e){return[...e.path,t]}function $a(t,e,n=As){Ha(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),yv(t,e),wv(t,e),bv(t,e),vv(t,e)}function Pd(t,e,n=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),Is(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Es(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function vv(t,e){if(e.valueAccessor.setDisabledState){let n=i=>{e.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Ha(t,e){let n=Xd(t);e.validator!==null?t.setValidators(Nd(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let i=Zd(t);e.asyncValidator!==null?t.setAsyncValidators(Nd(i,e.asyncValidator)):typeof i=="function"&&t.setAsyncValidators([i]);let r=()=>t.updateValueAndValidity();Es(e._rawValidators,r),Es(e._rawAsyncValidators,r)}function Is(t,e){let n=!1;if(t!==null){if(e.validator!==null){let r=Xd(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.validator);s.length!==r.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let r=Zd(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(n=!0,t.setAsyncValidators(s))}}}let i=()=>{};return Es(e._rawValidators,i),Es(e._rawAsyncValidators,i),n}function yv(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&ih(t,e)})}function bv(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&ih(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function ih(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function wv(t,e){let n=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function Cv(t,e){t==null,Ha(t,e)}function Ev(t,e){return Is(t,e)}function rh(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function Iv(t){return Object.getPrototypeOf(t.constructor)===Wa}function Sv(t,e){t._syncPendingControls(),e.forEach(n=>{let i=n.control;i.updateOn==="submit"&&i._pendingChange&&(n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function sh(t,e){if(!e)return null;Array.isArray(e);let n,i,r;return e.forEach(s=>{s.constructor===Me?n=s:Iv(s)?i=s:r=s}),r||i||n||null}function Tv(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Fd(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Ld(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var pe=class extends Cs{constructor(e=null,n,i){super(eh(n),th(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ss(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Ld(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Fd(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Fd(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Ld(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Av=t=>t instanceof pe;var Dv={provide:qt,useExisting:kt(()=>Gi)},Vd=Promise.resolve(),Gi=(()=>{let e=class e extends qt{constructor(i,r,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new pe,this._registered=!1,this.name="",this.update=new ae,this._parent=i,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=sh(this,o)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let r=i.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),rh(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){$a(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){Vd.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let r=i.isDisabled.currentValue,s=r!==0&&mt(r);Vd.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?nh(i,this._parent):[i]}};e.\u0275fac=function(r){return new(r||e)(y(Ht,9),y(Ga,10),y(za,10),y(Wi,10),y(jt,8),y(Ts,8))},e.\u0275dir=K({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[nt([Dv]),Be,Ze]});let t=e;return t})(),kn=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=K({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var oh=new V("");var xv={provide:Ht,useExisting:kt(()=>Kt)},Kt=(()=>{let e=class e extends Ht{get submitted(){return gt(this._submittedReactive)}set submitted(i){this._submittedReactive.set(i)}constructor(i,r,s){super(),this.callSetDisabledState=s,this._submitted=di(()=>this._submittedReactive()),this._submittedReactive=ci(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ae,this._setValidators(i),this._setAsyncValidators(r)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Is(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let r=this.form.get(i.path);return $a(r,i,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),r}getControl(i){return this.form.get(i.path)}removeControl(i){Pd(i.control||null,i,!1),Tv(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,r){this.form.get(i.path).setValue(r)}onSubmit(i){return this._submittedReactive.set(!0),Sv(this.form,this.directives),this.ngSubmit.emit(i),this.form._events.next(new Ua(this.control)),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this._submittedReactive.set(!1),this.form._events.next(new Ba(this.form))}_updateDomValue(){this.directives.forEach(i=>{let r=i.control,s=this.form.get(i.path);r!==s&&(Pd(r||null,i),Av(s)&&($a(s,i,this.callSetDisabledState),i.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let r=this.form.get(i.path);Cv(r,i),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let r=this.form.get(i.path);r&&Ev(r,i)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ha(this.form,this),this._oldForm&&Is(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(r){return new(r||e)(y(Ga,10),y(za,10),y(Ts,8))},e.\u0275dir=K({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&U("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nt([xv]),Be,Ze]});let t=e;return t})();var Rv={provide:qt,useExisting:kt(()=>Yt)},Yt=(()=>{let e=class e extends qt{set isDisabled(i){}constructor(i,r,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new ae,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=sh(this,o)}ngOnChanges(i){this._added||this._setUpControl(),rh(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return nh(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(r){return new(r||e)(y(Ht,13),y(Ga,10),y(za,10),y(Wi,10),y(oh,8))},e.\u0275dir=K({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[nt([Rv]),Be,Ze]});let t=e;return t})(),Mv={provide:Wi,useExisting:kt(()=>Ds),multi:!0};function ah(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function Nv(t){return t.split(":")[0]}var Ds=(()=>{let e=class e extends Wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){this.value=i;let r=this._getOptionId(i),s=ah(r,i);this.setProperty("value",s)}registerOnChange(i){this.onChange=r=>{this.value=this._getOptionValue(r),i(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(i){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),i))return r;return null}_getOptionValue(i){let r=Nv(i);return this._optionMap.has(r)?this._optionMap.get(r):i}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Lt(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,s){r&1&&U("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[nt([Mv]),Be]});let t=e;return t})(),lh=(()=>{let e=class e{constructor(i,r,s){this._element=i,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(i){this._select!=null&&(this._select._optionMap.set(this.id,i),this._setElementValue(ah(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._setElementValue(i),this._select&&this._select.writeValue(this._select.value)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(y(Ee),y(pt),y(Ds,9))},e.\u0275dir=K({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),Ov={provide:Wi,useExisting:kt(()=>ch),multi:!0};function jd(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function kv(t){return t.split(":")[0]}var ch=(()=>{let e=class e extends Wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){this.value=i;let r;if(Array.isArray(i)){let s=i.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else r=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(i){this.onChange=r=>{let s=[],o=r.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],u=this._getOptionValue(l.value);s.push(u)}}else{let a=r.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let u=this._getOptionValue(l.value);s.push(u)}}}this.value=s,i(s)}}_registerOption(i){let r=(this._idCounter++).toString();return this._optionMap.set(r,i),r}_getOptionId(i){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,i))return r;return null}_getOptionValue(i){let r=kv(i);return this._optionMap.has(r)?this._optionMap.get(r)._value:i}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Lt(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,s){r&1&&U("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[nt([Ov]),Be]});let t=e;return t})(),uh=(()=>{let e=class e{constructor(i,r,s){this._element=i,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(i){this._select!=null&&(this._value=i,this._setElementValue(jd(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._select?(this._value=i,this._setElementValue(jd(this.id,i)),this._select.writeValue(this._select.value)):this._setElementValue(i)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}_setSelected(i){this._renderer.setProperty(this._element.nativeElement,"selected",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(y(Ee),y(pt),y(ch,9))},e.\u0275dir=K({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var dh=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=he({type:e}),e.\u0275inj=de({});let t=e;return t})();var xs=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:Ts,useValue:i.callSetDisabledState??As}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=he({type:e}),e.\u0275inj=de({imports:[dh]});let t=e;return t})(),Pn=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:oh,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:Ts,useValue:i.callSetDisabledState??As}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=he({type:e}),e.\u0275inj=de({imports:[dh]});let t=e;return t})();function Rs(t){return t!=null&&`${t}`!="false"}function qa(t){return Array.isArray(t)?t:[t]}function Ka(t){return t instanceof Ee?t.nativeElement:t}var Ya;try{Ya=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Ya=!1}var qi=(()=>{let e=class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?Ru(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Ya)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(E(tt))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Hi;function Pv(){if(Hi==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Hi=!0}))}finally{Hi=Hi||!1}return Hi}function Qa(t){return Pv()?t:!!t.capture}function hh(t){return t.composedPath?t.composedPath()[0]:t.target}function fh(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var mh=new Set,Qt,Fv=(()=>{let e=class e{constructor(i,r){this._platform=i,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Vv}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&Lv(i,this._nonce),this._matchMedia(i)}};e.\u0275fac=function(r){return new(r||e)(E(qi),E(ai,8))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Lv(t,e){if(!mh.has(t))try{Qt||(Qt=document.createElement("style"),e&&Qt.setAttribute("nonce",e),Qt.setAttribute("type","text/css"),document.head.appendChild(Qt)),Qt.sheet&&(Qt.sheet.insertRule(`@media ${t} {body{ }}`,0),mh.add(t))}catch(n){console.error(n)}}function Vv(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var _h=(()=>{let e=class e{constructor(i,r){this._mediaMatcher=i,this._zone=r,this._queries=new Map,this._destroySubject=new Te}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return gh(qa(i)).some(s=>this._registerQuery(s).mql.matches)}observe(i){let s=gh(qa(i)).map(a=>this._registerQuery(a).observable),o=si(s);return o=Tr(o.pipe(ht(1)),o.pipe(au(1),iu(0))),o.pipe(k(a=>{let c={matches:!1,breakpoints:{}};return a.forEach(({matches:l,query:u})=>{c.matches=c.matches||l,c.breakpoints[u]=l}),c}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let r=this._mediaMatcher.matchMedia(i),o={observable:new ii(a=>{let c=l=>this._zone.run(()=>a.next(l));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(Ar(r),k(({matches:a})=>({query:i,matches:a})),Dr(this._destroySubject)),mql:r};return this._queries.set(i,o),o}};e.\u0275fac=function(r){return new(r||e)(E(Fv),E(ge))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function gh(t){return t.map(e=>e.split(",")).reduce((e,n)=>e.concat(n)).map(e=>e.trim())}function bh(t){return t.buttons===0||t.detail===0}function wh(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Jt=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(Jt||{}),vh="cdk-high-contrast-black-on-white",yh="cdk-high-contrast-white-on-black",Ja="cdk-high-contrast-active",Ch=(()=>{let e=class e{constructor(i,r){this._platform=i,this._document=r,this._breakpointSubscription=w(_h).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Jt.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let r=this._document.defaultView||window,s=r&&r.getComputedStyle?r.getComputedStyle(i):null,o=(s&&s.backgroundColor||"").replace(/ /g,"");switch(i.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Jt.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Jt.BLACK_ON_WHITE}return Jt.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(Ja,vh,yh),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===Jt.BLACK_ON_WHITE?i.add(Ja,vh):r===Jt.WHITE_ON_BLACK&&i.add(Ja,yh)}}};e.\u0275fac=function(r){return new(r||e)(E(qi),E(ee))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Xa=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=he({type:e}),e.\u0275inj=de({});let t=e;return t})();function Uv(){return!0}var Bv=new V("mat-sanity-checks",{providedIn:"root",factory:Uv}),tl=(()=>{let e=class e{constructor(i,r,s){this._sanityChecks=r,this._document=s,this._hasDoneGlobalChecks=!1,i._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(i){return fh()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[i]}};e.\u0275fac=function(r){return new(r||e)(E(Ch),E(Bv,8),E(ee))},e.\u0275mod=he({type:e}),e.\u0275inj=de({imports:[Xa,Xa]});let t=e;return t})();var Ne=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Ne||{}),Za=class{constructor(e,n,i,r=!1){this._renderer=e,this.element=n,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=Ne.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},Eh=Qa({passive:!0,capture:!0}),el=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let n=hh(e);n&&this._events.get(e.type)?.forEach((i,r)=>{(r===n||r.contains(n))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,n,i,r){let s=this._events.get(n);if(s){let o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(n,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,Eh)})}removeHandler(e,n,i){let r=this._events.get(e);if(!r)return;let s=r.get(n);s&&(s.delete(i),s.size===0&&r.delete(n),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,Eh)))}},Ih={enterDuration:225,exitDuration:150},$v=800,Sh=Qa({passive:!0,capture:!0}),Th=["mousedown","touchstart"],Ah=["mouseup","mouseleave","touchend","touchcancel"],Ki=class Ki{constructor(e,n,i,r){this._target=e,this._ngZone=n,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Ka(i))}fadeInRipple(e,n,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=_(_({},Ih),i.animation);i.centered&&(e=r.left+r.width/2,n=r.top+r.height/2);let o=i.radius||Wv(e,n,r),a=e-r.left,c=n-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-o}px`,u.style.top=`${c-o}px`,u.style.height=`${o*2}px`,u.style.width=`${o*2}px`,i.color!=null&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);let d=window.getComputedStyle(u),h=d.transitionProperty,f=d.transitionDuration,p=h==="none"||f==="0s"||f==="0s, 0s"||r.width===0&&r.height===0,C=new Za(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",C.state=Ne.FADING_IN,i.persistent||(this._mostRecentTransientRipple=C);let b=null;return!p&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let x=()=>{b&&(b.fallbackTimer=null),clearTimeout(ie),this._finishRippleTransition(C)},q=()=>this._destroyRipple(C),ie=setTimeout(q,l+100);u.addEventListener("transitionend",x),u.addEventListener("transitioncancel",q),b={onTransitionEnd:x,onTransitionCancel:q,fallbackTimer:ie}}),this._activeRipples.set(C,b),(p||!l)&&this._finishRippleTransition(C),C}fadeOutRipple(e){if(e.state===Ne.FADING_OUT||e.state===Ne.HIDDEN)return;let n=e.element,i=_(_({},Ih),e.config.animation);n.style.transitionDuration=`${i.exitDuration}ms`,n.style.opacity="0",e.state=Ne.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let n=Ka(e);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,Th.forEach(i=>{Ki._eventManager.addHandler(this._ngZone,i,n,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Ah.forEach(n=>{this._triggerElement.addEventListener(n,this,Sh)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Ne.FADING_IN?this._startFadeOutTransition(e):e.state===Ne.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let n=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=Ne.VISIBLE,!i&&(!n||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let n=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Ne.HIDDEN,n!==null&&(e.element.removeEventListener("transitionend",n.onTransitionEnd),e.element.removeEventListener("transitioncancel",n.onTransitionCancel),n.fallbackTimer!==null&&clearTimeout(n.fallbackTimer)),e.element.remove()}_onMousedown(e){let n=bh(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+$v;!this._target.rippleDisabled&&!n&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!wh(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let n=e.changedTouches;if(n)for(let i=0;i<n.length;i++)this.fadeInRipple(n[i].clientX,n[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let n=e.state===Ne.VISIBLE||e.config.terminateOnPointerUp&&e.state===Ne.FADING_IN;!e.config.persistent&&n&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(Th.forEach(n=>Ki._eventManager.removeHandler(n,e,this)),this._pointerUpEventsRegistered&&(Ah.forEach(n=>e.removeEventListener(n,this,Sh)),this._pointerUpEventsRegistered=!1))}};Ki._eventManager=new el;var Dh=Ki;function Wv(t,e,n){let i=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),r=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(i*i+r*r)}var xh=(()=>{let e=class e{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(i){this._vertical=Rs(i)}get inset(){return this._inset}set inset(i){this._inset=Rs(i)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=X({type:e,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(r,s){r&2&&(Vt("aria-orientation",s.vertical?"vertical":"horizontal"),_n("mat-divider-vertical",s.vertical)("mat-divider-horizontal",!s.vertical)("mat-divider-inset",s.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[Z],decls:0,vars:0,template:function(r,s){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0});let t=e;return t})(),Rh=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=he({type:e}),e.\u0275inj=de({imports:[tl,tl]});let t=e;return t})();var zv=new TextEncoder,Ms=new TextDecoder,GI=2**32;var Hv=t=>{let e=atob(t),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n},Mh=t=>{let e=t;e instanceof Uint8Array&&(e=Ms.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Hv(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};var nl=class extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}};var ze=class extends nl{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}};function Yv(t){return typeof t=="object"&&t!==null}function il(t){if(!Yv(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}var Nh=Mh;function rl(t){if(typeof t!="string")throw new ze("JWTs must use Compact JWS serialization, JWT must be a string");let{1:e,length:n}=t.split(".");if(n===5)throw new ze("Only JWTs using Compact JWS serialization can be decoded");if(n!==3)throw new ze("Invalid JWT");if(!e)throw new ze("JWTs must contain a payload");let i;try{i=Nh(e)}catch{throw new ze("Failed to base64url decode the payload")}let r;try{r=JSON.parse(Ms.decode(i))}catch{throw new ze("Failed to parse the decoded payload as JSON")}if(!il(r))throw new ze("Invalid JWT Claims Set");return r}var Fn=class{firstName;lastName;email;sex;objectId;provider;constructor(e,n,i,r,s,o){this.firstName=e,this.lastName=n,this.email=i,this.sex=r,this.objectId=s,this.provider=o}getFirstName(){return this.firstName}getLastName(){return this.lastName}getEmail(){return this.email}getSex(){return this.sex}};var Oe=(()=>{class t{http;constructor(n){this.http=n}signUp(n,i,r,s){this.http.post("https://brainyclub-eu.backendless.app/api/users/register",{email:n.getEmail(),password:i,firstName:n.getFirstName(),lastName:n.getLastName(),sex:n.getSex(),provider:r},{headers:new re({"Content-Type":"application/json"})}).subscribe(o=>{console.log(o),o!==null&&s()})}login(n,i,r){this.http.post("https://brainyclub-eu.backendless.app/api/users/login",{login:n,password:i},{headers:new re({"Content-Type":"application/json"})}).subscribe(s=>{s["user-token"]!==null&&r(s.email,s["user-token"],s.objectId)})}verifyIfTokenValid(n,i){this.http.get(`https://brainyclub-eu.backendless.app/api/users/isvalidusertoken/${n}`).subscribe(r=>{i(r)})}logout(){this.http.get("https://brainyclub-eu.backendless.app/api/users/logout",{headers:new re({"user-token":localStorage.getItem("userToken")})})}findUsersByName(n,i,r){this.http.get(`https://brainyclub-eu.backendless.app/api/data/Users?where=firstName%20%3D%20'${n}'`,{headers:new re({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(s=>{r(s)})}findUsersByObjectId(n,i){this.http.get(`https://brainyclub-eu.backendless.app/api/data/Users/${n}`,{headers:new re({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(r=>{i(r)})}findUserByEmail(n,i){this.http.get(`https://eu-api.backendless.com/EC90E79D-4443-4858-8D5E-02E90D0C63B1/58C3266A-8C33-4D5C-854B-66704F41CFB6/data/Users?where=email%3D'${n}'&property=%60provider%60&property=%60email%60&property=%60firstName%60&property=%60lastName%60`,{headers:new re({"Content-Type":"application/json"})}).subscribe(r=>{i(r[0])})}getFullName(n,i){this.http.get(`https://brainyclub-eu.backendless.app/api/data/Users/${n}?property=%60firstName%60&property=%60lastName%60`,{headers:new re({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(r=>{i(r)})}updateInfos(n,i,r,s,o,a){this.http.put(`https://brainyclub-eu.backendless.app/api/data/users/${n}`,{firstName:i,lastName:r,email:s,password:o},{headers:new re({"Content-Type":"application/json","user-token":localStorage.getItem("userToken")})}).subscribe(c=>{a(c)})}static \u0275fac=function(i){return new(i||t)(E(Go))};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Xv(t,e){t&1&&(g(0,"p",29),A(1,"Enter a valid email !"),v())}function Zv(t,e){t&1&&(g(0,"p",29),A(1," Password must be at least 8 characters ! "),v())}var Oh=(()=>{class t{authService;router;constructor(n,i){this.authService=n,this.router=i}changed=0;ngOnInit(){google.accounts.id.initialize({client_id:"205706621989-pken44sei0ti29vd95ukk3o2ja4e4gh1.apps.googleusercontent.com",callback:this.handleCredential.bind(this)})}isPasswordVisible=!1;isEmailValid=!0;isPasswordValid=!0;loginGroup=new It({email:new pe("",[ce.required,ce.email]),password:new pe("",[ce.required,ce.minLength(8)])});onSubmitLogin(){this.loginGroup.valid?(this.isEmailValid=this.loginGroup.valid,this.isPasswordValid=this.loginGroup.valid,this.authService.login(this.loginGroup.value.email,this.loginGroup.value.password,(n,i,r)=>this.saveDataLocally(n,i,r))):(this.isEmailValid=this.loginGroup.controls.email.valid,this.isPasswordValid=this.loginGroup.controls.password.valid)}login(){google.accounts.id.prompt()}handleCredential(n){let i=rl(n.credential);this.authService.findUserByEmail(i.email,r=>{typeof r<"u"?r.provider==="backendless"?alert("Try to login using email !"):r.provider==="google"&&this.authService.login(i.email,i.sub,(s,o,a)=>this.saveDataLocally(s,o,a)):this.authService.signUp(new Fn(i.given_name,i.family_name,i.email,"","","google"),i.sub,"google",()=>{this.authService.login(i.email,i.sub,(s,o,a)=>this.saveDataLocally(s,o,a))})})}makePasswordVisible(){this.isPasswordVisible=!this.isPasswordVisible}saveDataLocally(n,i,r){localStorage.setItem("email",n),localStorage.setItem("userToken",i),localStorage.setItem("objectId",r),localStorage.getItem("email")!==null&&localStorage.getItem("userToken")!==null&&localStorage.getItem("objectId")!==null&&this.router.navigate(["/home"])}change(){this.changed<2?this.changed+=1:this.changed=0}static \u0275fac=function(i){return new(i||t)(y(Oe),y(We))};static \u0275cmp=X({type:t,selectors:[["app-login"]],standalone:!0,features:[Z],decls:44,vars:5,consts:[[1,"h-full","w-full","select-none","bg-white"],[1,"header","flex","justify-between","items-center","p-6"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","72px","width","72px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"create-account","flex","items-center"],[1,"create-account-text","mr-2"],["routerLink","/signup","routerLinkActive","active",1,"border","border-gray-300","rounded-md","px-2","py-1"],[1,"login-div","w-96","h-1/2","flex","flex-col","justify-evenly","ml-auto","mr-auto","absolute","left-1/2","top-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"h-9","border","rounded-md","flex","items-center","justify-center","py-2",3,"click"],["src","./assets/google-icon.png",1,"w-7","h-7"],[1,"flex","justify-between","items-center"],[1,"w-[45%]"],[1,"select-none"],[1,"h-3/6","flex","flex-col","justify-between",3,"formGroup"],[1,"flex","flex-col"],[1,"text-xl","font-bold"],["placeholder","Email","formControlName","email",1,"text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["class","text-red-600",4,"ngIf"],["for","dd",1,"text-xl","font-bold"],[1,"relative"],["placeholder","Password","formControlName","password","id","dd",1,"w-full","text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600",3,"type"],[1,"absolute","h-full","-right-0","-top-0","mr-2",3,"click"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#000000","version","1.1","id","Capa_1","width","25px","height","25px","viewBox","0 0 442.04 442.04",0,"xml","space","preserve"],["d","M221.02,341.304c-49.708,0-103.206-19.44-154.71-56.22C27.808,257.59,4.044,230.351,3.051,229.203    c-4.068-4.697-4.068-11.669,0-16.367c0.993-1.146,24.756-28.387,63.259-55.881c51.505-36.777,105.003-56.219,154.71-56.219    c49.708,0,103.207,19.441,154.71,56.219c38.502,27.494,62.266,54.734,63.259,55.881c4.068,4.697,4.068,11.669,0,16.367    c-0.993,1.146-24.756,28.387-63.259,55.881C324.227,321.863,270.729,341.304,221.02,341.304z M29.638,221.021    c9.61,9.799,27.747,27.03,51.694,44.071c32.83,23.361,83.714,51.212,139.688,51.212s106.859-27.851,139.688-51.212    c23.944-17.038,42.082-34.271,51.694-44.071c-9.609-9.799-27.747-27.03-51.694-44.071    c-32.829-23.362-83.714-51.212-139.688-51.212s-106.858,27.85-139.688,51.212C57.388,193.988,39.25,211.219,29.638,221.021z"],["d","M221.02,298.521c-42.734,0-77.5-34.767-77.5-77.5c0-42.733,34.766-77.5,77.5-77.5c18.794,0,36.924,6.814,51.048,19.188    c5.193,4.549,5.715,12.446,1.166,17.639c-4.549,5.193-12.447,5.714-17.639,1.166c-9.564-8.379-21.844-12.993-34.576-12.993    c-28.949,0-52.5,23.552-52.5,52.5s23.551,52.5,52.5,52.5c28.95,0,52.5-23.552,52.5-52.5c0-6.903,5.597-12.5,12.5-12.5    s12.5,5.597,12.5,12.5C298.521,263.754,263.754,298.521,221.02,298.521z"],["d","M221.02,246.021c-13.785,0-25-11.215-25-25s11.215-25,25-25c13.786,0,25,11.215,25,25S234.806,246.021,221.02,246.021z"],[1,"bg-green-600","text-white","h-9","text-xl","font-light","rounded-md",3,"click"],[1,"text-red-600"]],template:function(i,r){i&1&&(g(0,"div",0)(1,"div",1)(2,"div",2),et(),g(3,"svg",3),R(4,"path",4),v(),Ft(),g(5,"p",5),A(6,"Chat"),v()(),g(7,"div",6)(8,"p",7),A(9,"New to Chat?"),v(),g(10,"button",8),A(11," Create an account "),v()()(),g(12,"div",9)(13,"button",10),U("click",function(){return r.login()}),R(14,"img",11),A(15,"\xA0Sign in using Google "),v(),g(16,"div",12),R(17,"mat-divider",13),g(18,"p",14),A(19,"Or"),v(),R(20,"mat-divider",13),v(),g(21,"form",15)(22,"div",16)(23,"label",17),A(24,"Email"),v(),R(25,"input",18),fe(26,Xv,2,0,"p",19),v(),g(27,"div",16)(28,"label",20),A(29,"Password"),v(),g(30,"div",21),R(31,"input",22),g(32,"button",23),U("click",function(){return r.makePasswordVisible()}),et(),g(33,"svg",24)(34,"g")(35,"g"),R(36,"path",25),v(),g(37,"g"),R(38,"path",26),v(),g(39,"g"),R(40,"path",27),v()()()()(),fe(41,Zv,2,0,"p",19),v(),Ft(),g(42,"button",28),U("click",function(){return r.onSubmitLogin()}),A(43," Login "),v()()()()),i&2&&(P("@appear",void 0),F(21),P("formGroup",r.loginGroup),F(5),P("ngIf",!r.isEmailValid),F(5),P("type",r.isPasswordVisible?"text":"password"),F(10),P("ngIf",!r.isPasswordValid))},dependencies:[xn,gs,Pn,kn,Me,Ge,On,Kt,Yt,Fe,_t,Rh,xh],styles:["@media only screen and (max-width: 500px){.header[_ngcontent-%COMP%]{flex-direction:column}.login-div[_ngcontent-%COMP%]{width:90%}.create-account[_ngcontent-%COMP%]{margin-top:2em}.create-account[_ngcontent-%COMP%]   .create-account-text[_ngcontent-%COMP%]{display:none}}"],data:{animation:[Ut("appear",[rt(":enter",[ye({opacity:0}),it("500ms")])])]}})}return t})();function ey(t,e){t&1&&(g(0,"p",18),A(1,"Enter a valid email !"),v())}function ty(t,e){t&1&&(g(0,"p",18),A(1,"Password must be at least 8 characters !"),v())}var kh=(()=>{class t{authService;router;constructor(n,i){this.authService=n,this.router=i}show=!0;isEmailValid=!0;isPasswordValid=!0;signUpForm=new It({firstName:new pe(""),lastName:new pe(""),sex:new pe("Sex"),email:new pe("",[ce.required,ce.email]),password:new pe("",[ce.required,ce.minLength(8)])});onSubmit(){this.signUpForm.valid?this.authService.signUp(new Fn(this.signUpForm.value.firstName,this.signUpForm.value.lastName,this.signUpForm.value.email,this.signUpForm.value.sex,"",""),this.signUpForm.value.password,"backendless",()=>{this.router.navigate(["/login"])}):(this.isEmailValid=this.signUpForm.controls.email.valid,this.isPasswordValid=this.signUpForm.controls.password.valid)}static \u0275fac=function(i){return new(i||t)(y(Oe),y(We))};static \u0275cmp=X({type:t,selectors:[["app-signup"]],standalone:!0,features:[Z],decls:29,vars:4,consts:[[1,"h-full","w-full","select-none","bg-white"],[1,"signup-div","h-1/2","flex","flex-col","justify-evenly","items-center","absolute","left-1/2","top-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"flex","justify-center","items-center","w-full"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","72px","width","72px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"text-3xl"],[1,"flex","flex-col",3,"ngSubmit","formGroup"],[1,"flex","justify-between"],["placeholder","First Name","formControlName","firstName",1,"text-xl","font-light","w-full","h-9","px-2","mr-1","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["placeholder","Last Name","formControlName","lastName",1,"text-xl","font-light","w-full","h-9","px-2","ml-1","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["formControlName","sex",1,"text-xl","font-light","mt-4","px-2","outline-none","focus:border-blue-600","border-gray-300","border","rounded-md","h-9"],["placeholder","Email","type","email","formControlName","email",1,"text-xl","font-light","h-9","mt-4","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["class","text-red-600",4,"ngIf"],["placeholder","Password","type","password","formControlName","password",1,"text-xl","font-light","h-9","mt-4","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],[1,"bg-green-600","mt-8","text-white","h-9","text-xl","font-light","rounded-md"],[1,"flex","mt-1"],["routerLink","/login","routerLinkActive","active",1,"ml-1","text-blue-600","underline"],[1,"text-red-600"]],template:function(i,r){i&1&&(g(0,"div",0)(1,"div",1)(2,"div",2),et(),g(3,"svg",3),R(4,"path",4),v(),Ft(),g(5,"p",5),A(6,"Chat"),v()(),g(7,"p",6),A(8,"Create an account"),v(),g(9,"form",7),U("ngSubmit",function(){return r.onSubmit()}),g(10,"div",8),R(11,"input",9)(12,"input",10),v(),g(13,"select",11)(14,"option"),A(15,"Male"),v(),g(16,"option"),A(17,"Female"),v()(),R(18,"input",12),fe(19,ey,2,0,"p",13),R(20,"input",14),fe(21,ty,2,0,"p",13),g(22,"button",15),A(23," Signup "),v(),g(24,"div",16)(25,"p"),A(26,"Alreay have an account?"),v(),g(27,"a",17),A(28,"Login"),v()()()()()),i&2&&(P("@ani",void 0),F(9),P("formGroup",r.signUpForm),F(10),P("ngIf",!r.isEmailValid),F(2),P("ngIf",!r.isPasswordValid))},dependencies:[xn,gs,Pn,kn,lh,uh,Me,Ds,Ge,On,Kt,Yt,Fe,_t],styles:["@media only screen and (max-width: 600px){.signup-div[_ngcontent-%COMP%]{width:90%;background-color:red}}"],data:{animation:[Ut("ani",[rt(":enter",[ye({opacity:0}),it("500ms")]),rt(":leave",[ye({opacity:1}),it("5000ms")])])]}})}return t})();var sl={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var m=function(t,e){if(!t)throw Zt(e)},Zt=function(t){return new Error("Firebase Database ("+sl.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var Fh=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},ny=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Os={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(h=64)),i.push(n[u],n[d],n[h],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Fh(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ny(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let l=r<t.length?n[t.charAt(r)]:64;++r;let d=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||l==null||d==null)throw new ol;let h=s<<2|a>>4;if(i.push(h),l!==64){let f=a<<4&240|l>>2;if(i.push(f),d!==64){let p=l<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},ol=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ll=function(t){let e=Fh(t);return Os.encodeByteArray(e,!0)},Yi=function(t){return ll(t).replace(/\./g,"")},al=function(t){try{return Os.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Lh(t){return Vh(void 0,t)}function Vh(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!iy(n)||(t[n]=Vh(t[n],e[n]));return t}function iy(t){return t!=="__proto__"}function ry(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var sy=()=>ry().__FIREBASE_DEFAULTS__,oy=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ay=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&al(t[1]);return e&&JSON.parse(e)},jh=()=>{try{return sy()||oy()||ay()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ly=t=>{var e,n;return(n=(e=jh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Uh=t=>{let e=ly(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},cl=()=>{var t;return(t=jh())===null||t===void 0?void 0:t.config};var St=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function Bh(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Yi(JSON.stringify(n)),Yi(JSON.stringify(o)),""].join(".")}function cy(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ul(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cy())}function $h(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function He(){return sl.NODE_CLIENT===!0||sl.NODE_ADMIN===!0}function Wh(){try{return typeof indexedDB=="object"}catch{return!1}}function Gh(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var uy="FirebaseError",Xt=class t extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=uy,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qi.prototype.create)}},Qi=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?dy(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Xt(r,a,i)}};function dy(t,e){return t.replace(hy,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var hy=/\{\$([^}]+)}/g;function Vn(t){return JSON.parse(t)}function Q(t){return JSON.stringify(t)}var zh=function(t){let e={},n={},i={},r="";try{let s=t.split(".");e=Vn(al(s[0])||""),n=Vn(al(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}};var Hh=function(t){let e=zh(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},qh=function(t){let e=zh(t).claims;return typeof e=="object"&&e.admin===!0};function qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function en(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function dl(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ji(t,e,n){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function ks(t,e){if(t===e)return!0;let n=Object.keys(t),i=Object.keys(e);for(let r of n){if(!i.includes(r))return!1;let s=t[r],o=e[r];if(Ph(s)&&Ph(o)){if(!ks(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!n.includes(r))return!1;return!0}function Ph(t){return t!==null&&typeof t=="object"}function Kh(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Ns=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){let h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(h<<1|h>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let d=0;d<80;d++){d<40?d<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):d<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let h=(r<<5|r>>>27)+l+c+u+i[d]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let i=n-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function Ps(t,e){return`${t} failed: ${e} argument `}var Yh=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,m(i<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Xi=function(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};var vS=4*60*60*1e3;function tn(t){return t&&t._delegate?t._delegate:t}var lt=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var nn="[DEFAULT]";var Fs=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let i=new St;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(py(e))try{this.getOrInitializeService({instanceIdentifier:nn})}catch{}for(let[n,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=nn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return Y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=nn){return this.instances.has(e)}getOptions(e=nn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;let r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let i=this.onInitCallbacks.get(n);if(i)for(let r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:fy(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=nn){return this.component?this.component.multipleInstances?e:nn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function fy(t){return t===nn?void 0:t}function py(t){return t.instantiationMode==="EAGER"}var Zi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new Fs(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var my=[],G=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(G||{}),gy={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},_y=G.INFO,vy={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},yy=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=vy[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},jn=class{constructor(e){this.name=e,this._logLevel=_y,this._logHandler=yy,this._userLogHandler=null,my.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gy[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var by=(t,e)=>e.some(n=>t instanceof n),Qh,Jh;function wy(){return Qh||(Qh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cy(){return Jh||(Jh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Xh=new WeakMap,fl=new WeakMap,Zh=new WeakMap,hl=new WeakMap,ml=new WeakMap;function Ey(t){let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ke(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Xh.set(n,t)}).catch(()=>{}),ml.set(e,t),e}function Iy(t){if(fl.has(t))return;let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});fl.set(t,e)}var pl={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return fl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zh.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ke(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ef(t){pl=t(pl)}function Sy(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let i=t.call(Ls(this),e,...n);return Zh.set(i,e.sort?e.sort():[e]),Ke(i)}:Cy().includes(t)?function(...e){return t.apply(Ls(this),e),Ke(Xh.get(this))}:function(...e){return Ke(t.apply(Ls(this),e))}}function Ty(t){return typeof t=="function"?Sy(t):(t instanceof IDBTransaction&&Iy(t),by(t,wy())?new Proxy(t,pl):t)}function Ke(t){if(t instanceof IDBRequest)return Ey(t);if(hl.has(t))return hl.get(t);let e=Ty(t);return e!==t&&(hl.set(t,e),ml.set(e,t)),e}var Ls=t=>ml.get(t);function nf(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(t,e),a=Ke(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Ke(o.result),c.oldVersion,c.newVersion,Ke(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var Ay=["get","getKey","getAll","getAllKeys","count"],Dy=["put","add","delete","clear"],gl=new Map;function tf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gl.get(e))return gl.get(e);let n=e.replace(/FromIndex$/,""),i=e!==n,r=Dy.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Ay.includes(n)))return;let s=function(o,...a){return Y(this,null,function*(){let c=this.transaction(o,r?"readwrite":"readonly"),l=c.store;return i&&(l=l.index(a.shift())),(yield Promise.all([l[n](...a),r&&c.done]))[0]})};return gl.set(e,s),s}ef(t=>$(_({},t),{get:(e,n,i)=>tf(e,n)||t.get(e,n,i),has:(e,n)=>!!tf(e,n)||t.has(e,n)}));var vl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xy(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function xy(t){let e=t.getComponent();return e?.type==="VERSION"}var yl="@firebase/app",rf="0.10.7";var rn=new jn("@firebase/app"),Ry="@firebase/app-compat",My="@firebase/analytics-compat",Ny="@firebase/analytics",Oy="@firebase/app-check-compat",ky="@firebase/app-check",Py="@firebase/auth",Fy="@firebase/auth-compat",Ly="@firebase/database",Vy="@firebase/database-compat",jy="@firebase/functions",Uy="@firebase/functions-compat",By="@firebase/installations",$y="@firebase/installations-compat",Wy="@firebase/messaging",Gy="@firebase/messaging-compat",zy="@firebase/performance",Hy="@firebase/performance-compat",qy="@firebase/remote-config",Ky="@firebase/remote-config-compat",Yy="@firebase/storage",Qy="@firebase/storage-compat",Jy="@firebase/firestore",Xy="@firebase/vertexai-preview",Zy="@firebase/firestore-compat",eb="firebase",tb="10.12.4";var bl="[DEFAULT]",nb={[yl]:"fire-core",[Ry]:"fire-core-compat",[Ny]:"fire-analytics",[My]:"fire-analytics-compat",[ky]:"fire-app-check",[Oy]:"fire-app-check-compat",[Py]:"fire-auth",[Fy]:"fire-auth-compat",[Ly]:"fire-rtdb",[Vy]:"fire-rtdb-compat",[jy]:"fire-fn",[Uy]:"fire-fn-compat",[By]:"fire-iid",[$y]:"fire-iid-compat",[Wy]:"fire-fcm",[Gy]:"fire-fcm-compat",[zy]:"fire-perf",[Hy]:"fire-perf-compat",[qy]:"fire-rc",[Ky]:"fire-rc-compat",[Yy]:"fire-gcs",[Qy]:"fire-gcs-compat",[Jy]:"fire-fst",[Zy]:"fire-fst-compat",[Xy]:"fire-vertex","fire-js":"fire-js",[eb]:"fire-js-all"};var Vs=new Map,ib=new Map,wl=new Map;function sf(t,e){try{t.container.addComponent(e)}catch(n){rn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function er(t){let e=t.name;if(wl.has(e))return rn.debug(`There were multiple attempts to register component ${e}.`),!1;wl.set(e,t);for(let n of Vs.values())sf(n,t);for(let n of ib.values())sf(n,t);return!0}function cf(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var rb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tt=new Qi("app","Firebase",rb);var Cl=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new lt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tt.create("app-deleted",{appName:this._name})}};var uf=tb;function Sl(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let i=Object.assign({name:bl,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Tt.create("bad-app-name",{appName:String(r)});if(n||(n=cl()),!n)throw Tt.create("no-options");let s=Vs.get(r);if(s){if(ks(n,s.options)&&ks(i,s.config))return s;throw Tt.create("duplicate-app",{appName:r})}let o=new Zi(r);for(let c of wl.values())o.addComponent(c);let a=new Cl(n,i,o);return Vs.set(r,a),a}function df(t=bl){let e=Vs.get(t);if(!e&&t===bl&&cl())return Sl();if(!e)throw Tt.create("no-app",{appName:t});return e}function At(t,e,n){var i;let r=(i=nb[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rn.warn(a.join(" "));return}er(new lt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var sb="firebase-heartbeat-database",ob=1,tr="firebase-heartbeat-store",_l=null;function hf(){return _l||(_l=nf(sb,ob,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(tr)}catch(n){console.warn(n)}}}}).catch(t=>{throw Tt.create("idb-open",{originalErrorMessage:t.message})})),_l}function ab(t){return Y(this,null,function*(){try{let n=(yield hf()).transaction(tr),i=yield n.objectStore(tr).get(ff(t));return yield n.done,i}catch(e){if(e instanceof Xt)rn.warn(e.message);else{let n=Tt.create("idb-get",{originalErrorMessage:e?.message});rn.warn(n.message)}}})}function of(t,e){return Y(this,null,function*(){try{let i=(yield hf()).transaction(tr,"readwrite");yield i.objectStore(tr).put(e,ff(t)),yield i.done}catch(n){if(n instanceof Xt)rn.warn(n.message);else{let i=Tt.create("idb-set",{originalErrorMessage:n?.message});rn.warn(i.message)}}})}function ff(t){return`${t.name}!${t.options.appId}`}var lb=1024,cb=30*24*60*60*1e3,El=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Il(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return Y(this,null,function*(){var e,n;let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=af();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=cb}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return Y(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=af(),{heartbeatsToSend:i,unsentEntries:r}=ub(this._heartbeatsCache.heartbeats),s=Yi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function af(){return new Date().toISOString().substring(0,10)}function ub(t,e=lb){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),lf(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),lf(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var Il=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Y(this,null,function*(){return Wh()?Gh().then(()=>!0).catch(()=>!1):!1})}read(){return Y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield ab(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return Y(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return of(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return Y(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return of(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function lf(t){return Yi(JSON.stringify({version:2,heartbeats:t})).length}function db(t){er(new lt("platform-logger",e=>new vl(e),"PRIVATE")),er(new lt("heartbeat",e=>new El(e),"PRIVATE")),At(yl,rf,t),At(yl,rf,"esm2017"),At("fire-js","")}db("");var pf="@firebase/database",mf="1.0.6";var Tc="";function hb(t){Tc=t}var Ol=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Q(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Vn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var kl=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return qe(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var qf=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Ol(e)}}catch{}return new kl},on=qf("localStorage"),Pl=qf("sessionStorage");var $n=new jn("@firebase/database"),fb=function(){let t=1;return function(){return t++}}(),Kf=function(t){let e=Yh(t),n=new Ns;n.update(e);let i=n.digest();return Os.encodeByteArray(i)},yr=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=yr.apply(null,i):typeof i=="object"?e+=Q(i):e+=i,e+=" "}return e},ln=null,gf=!0,pb=function(t,e){m(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?($n.logLevel=G.VERBOSE,ln=$n.log.bind($n),e&&Pl.set("logging_enabled",!0)):typeof t=="function"?ln=t:(ln=null,Pl.remove("logging_enabled"))},me=function(...t){if(gf===!0&&(gf=!1,ln===null&&Pl.get("logging_enabled")===!0&&pb(!0)),ln){let e=yr.apply(null,t);ln(e)}},br=function(t){return function(...e){me(t,...e)}},Fl=function(...t){let e="FIREBASE INTERNAL ERROR: "+yr(...t);$n.error(e)},ct=function(...t){let e=`FIREBASE FATAL ERROR: ${yr(...t)}`;throw $n.error(e),new Error(e)},be=function(...t){let e="FIREBASE WARNING: "+yr(...t);$n.warn(e)},mb=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&be("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Yf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},gb=function(t){if(He()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Gn="[MIN_NAME]",cn="[MAX_NAME]",Jn=function(t,e){if(t===e)return 0;if(t===Gn||e===cn)return-1;if(e===Gn||t===cn)return 1;{let n=_f(t),i=_f(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},_b=function(t,e){return t===e?0:t<e?-1:1},nr=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Q(e))},Ac=function(t){if(typeof t!="object"||t===null)return Q(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Q(e[i]),n+=":",n+=Ac(t[e[i]]);return n+="}",n},Qf=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function we(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var Jf=function(t){m(!Yf(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,c;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(r?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(u.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},vb=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},yb=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function bb(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var wb=new RegExp("^-?(0*)\\d{1,10}$"),Cb=-2147483648,Eb=2147483647,_f=function(t){if(wb.test(t)){let e=Number(t);if(e>=Cb&&e<=Eb)return e}return null},Xn=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw be("Exception was thrown by user callback.",n),e},Math.floor(0))}},Ib=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ar=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var Ll=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){be(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Vl=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(me("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',be(e)}},lr=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Us="5",Xf="v",Zf="s",ep="r",tp="f",np=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ip="ls",rp="p",jl="ac",sp="websocket",op="long_polling";var Bs=class{constructor(e,n,i,r,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=on.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&on.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Sb(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function ap(t,e,n){m(typeof e=="string","typeof type must == string"),m(typeof n=="object","typeof params must == object");let i;if(e===sp)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===op)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Sb(t)&&(n.ns=t.namespace);let r=[];return we(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var Ul=class{constructor(){this.counters_={}}incrementCounter(e,n=1){qe(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Lh(this.counters_)}};var Tl={},Al={};function Dc(t){let e=t.toString();return Tl[e]||(Tl[e]=new Ul),Tl[e]}function Tb(t,e){let n=t.toString();return Al[n]||(Al[n]=e()),Al[n]}var Bl=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Xn(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var vf="start",Ab="close",Db="pLPCommand",xb="pRTLPCB",lp="id",cp="pw",up="ser",Rb="cb",Mb="seg",Nb="ts",Ob="d",kb="dframe",dp=1870,hp=30,Pb=dp-hp,Fb=25e3,Lb=3e4,$l=class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=br(e),this.stats_=Dc(n),this.urlFn=c=>(this.appCheckToken&&(c[jl]=this.appCheckToken),ap(n,op,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Bl(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Lb)),gb(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Wl((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===vf)this.id=a,this.password=c;else if(o===Ab)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[vf]="t",i[up]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Rb]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Xf]=Us,this.transportSessionId&&(i[Zf]=this.transportSessionId),this.lastSessionId&&(i[ip]=this.lastSessionId),this.applicationId&&(i[rp]=this.applicationId),this.appCheckToken&&(i[jl]=this.appCheckToken),typeof location<"u"&&location.hostname&&np.test(location.hostname)&&(i[ep]=tp);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return He()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vb()&&!yb()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Q(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=ll(n),r=Qf(i,Pb);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(He())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[kb]="t",i[lp]=e,i[cp]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Q(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Wl=class t{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,He())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=fb(),window[Db+this.uniqueCallbackIdentifier]=e,window[xb+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){me("frame writing exception"),a.stack&&me(a.stack),me(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||me("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[lp]=this.myID,e[cp]=this.myPW,e[up]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hp+i.length<=dp;){let o=this.pendingSegs.shift();i=i+"&"+Mb+r+"="+o.seg+"&"+Nb+r+"="+o.ts+"&"+Ob+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(Fb)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){He()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{me("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var Vb=16384,jb=45e3,$s=null;typeof MozWebSocket<"u"?$s=MozWebSocket:typeof WebSocket<"u"&&($s=WebSocket);var ir=(()=>{class t{constructor(n,i,r,s,o,a,c){this.connId=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=br(this.connId),this.stats_=Dc(i),this.connURL=t.connectionURL_(i,a,c,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,r,s,o){let a={};return a[Xf]=Us,!He()&&typeof location<"u"&&location.hostname&&np.test(location.hostname)&&(a[ep]=tp),i&&(a[Zf]=i),r&&(a[ip]=r),s&&(a[jl]=s),o&&(a[rp]=o),ap(n,sp,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,on.set("previous_websocket_failure",!0);try{let r;if(He()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${Us}/${Tc}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new $s(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(n=!0)}return!n&&$s!==null&&!t.forceDisallow_}static previouslyFailed(){return on.isInMemoryStorage||on.get("previous_websocket_failure")===!0}markConnectionHealthy(){on.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=Vn(i);this.onMessage(r)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(m(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(n){this.resetKeepAlive();let i=Q(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=Qf(i,Vb);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(jb))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),Ub=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[$l,ir]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=ir&&ir.isAvailable(),r=i&&!ir.previouslyFailed();if(n.webSocketOnly&&(i||be("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ir];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),Bb=6e4,$b=5e3,Wb=10*1024,Gb=100*1024,Dl="t",yf="d",zb="s",bf="r",Hb="e",wf="o",Cf="a",Ef="n",If="p",qb="h",Gl=class{constructor(e,n,i,r,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=br("c:"+this.id+":"),this.transportManager_=new Ub(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=ar(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Gb?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Wb?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Dl in e){let n=e[Dl];n===Cf?this.upgradeIfSecondaryHealthy_():n===bf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===wf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=nr("t",e),i=nr("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:If,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Cf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Ef,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=nr("t",e),i=nr("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=nr(Dl,e);if(yf in e){let i=e[yf];if(n===qb){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===Ef){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===zb?this.onConnectionShutdown_(i):n===bf?this.onReset_(i):n===Hb?Fl("Server Error: "+i):n===wf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fl("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Us!==i&&be("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),ar(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Bb))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ar(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($b))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:If,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(on.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Ws=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var Gs=class{constructor(e){this.allowedEvents_=e,this.listeners_={},m(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){m(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var zs=class t extends Gs{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ul()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return m(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Sf=32,Tf=768,B=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function L(){return new B("")}function M(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Rt(t){return t.pieces_.length-t.pieceNum_}function z(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new B(t.pieces_,e)}function fp(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Kb(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function pp(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function mp(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new B(e,0)}function ne(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof B)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new B(n,0)}function O(t){return t.pieceNum_>=t.pieces_.length}function _e(t,e){let n=M(t),i=M(e);if(n===null)return e;if(n===i)return _e(z(t),z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function xc(t,e){if(Rt(t)!==Rt(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function je(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Rt(t)>Rt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var zl=class{constructor(e,n){this.errorPrefix_=n,this.parts_=pp(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Xi(this.parts_[i]);gp(this)}};function Yb(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Xi(e),gp(t)}function Qb(t){let e=t.parts_.pop();t.byteLength_-=Xi(e),t.parts_.length>0&&(t.byteLength_-=1)}function gp(t){if(t.byteLength_>Tf)throw new Error(t.errorPrefix_+"has a key path longer than "+Tf+" bytes ("+t.byteLength_+").");if(t.parts_.length>Sf)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Sf+") or object contains a cycle "+sn(t))}function sn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Hl=class t extends Gs{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return m(e==="visible","Unknown event type: "+e),[this.visible_]}};var rr=1e3,Jb=60*5*1e3,Af=30*1e3,Xb=1.3,Zb=3e4,e0="server_kill",Df=3,Rc=(()=>{class t extends Ws{constructor(n,i,r,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=br("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=rr,this.maxReconnectDelay_=Jb,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!He())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Hl.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&zs.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,r){let s=++this.requestNumber_,o={r:s,a:n,b:i};this.log_(Q(o)),m(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(n){this.initConnection_();let i=new St,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?i.resolve(c):i.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,r,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),m(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:i,query:n,tag:r};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(n){let i=n.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,i),(this.listens.get(r)&&this.listens.get(r).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(r,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&qe(n,"w")){let r=en(n,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();be(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||qh(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Af)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=Hh(n)?"auth":"gauth",r={cred:n};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,r=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(n,i){let r=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,n._queryObject,i)}sendUnlisten_(n,i,r,s){this.log_("Unlisten on "+n+" for "+i);let o={p:n},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:r})}onDisconnectMerge(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:r})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,i,r,s){this.putInternal("p",n,i,r,s)}merge(n,i,r,s){this.putInternal("m",n,i,r,s)}putInternal(n,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,r=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Q(n));let i=n.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):Fl("Unrecognized action received from server: "+Q(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){m(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Zb&&(this.reconnectDelay_=rr),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Xb)}this.onConnectStatus_(!1)}establishConnection_(){return Y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,r())},u=function(h){m(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?me("getToken() completed but was canceled"):(me("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new Gl(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,r,p=>{be(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(e0)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&be(h),l())}}})}interrupt(n){me("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){me("Resuming connection for reason: "+n),delete this.interruptReasons_[n],dl(this.interruptReasons_)&&(this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let r;i?r=i.map(o=>Ac(o)).join("$"):r="default";let s=this.removeListen_(n,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,i){let r=new B(n).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(n,i){me("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Df&&(this.reconnectDelay_=Af,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){me("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Df&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";He()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+Tc.replace(/\./g,"-")]=1,ul()?n["framework.cordova"]=1:$h()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=zs.getInstance().currentlyOnline();return dl(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),N=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var zn=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new N(Gn,e),r=new N(Gn,n);return this.compare(i,r)!==0}minPost(){return N.MIN}};var js,Hs=class extends zn{static get __EMPTY_NODE(){return js}static set __EMPTY_NODE(e){js=e}compare(e,n){return Jn(e.name,n.name)}isDefinedOn(e){throw Zt("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return N.MIN}maxPost(){return new N(cn,js)}makePost(e,n){return m(typeof e=="string","KeyIndex indexValue must always be a string."),new N(e,js)}toString(){return".key"}},Wn=new Hs;var Bn=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ve=(()=>{class t{constructor(n,i,r,s,o){this.key=n,this.value=i,this.color=r??t.RED,this.left=s??ke.EMPTY_NODE,this.right=o??ke.EMPTY_NODE}copy(n,i,r,s,o){return new t(n??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,r){let s=this,o=r(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ke.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let r,s;if(r=this,i(n,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(n,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(n,r.key)===0){if(r.right.isEmpty())return ke.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(n,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),ql=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new Ve(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ke=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ve.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ve.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Bn(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Bn(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Bn(this.root_,null,this.comparator_,!0,e)}};ke.EMPTY_NODE=new ql;function t0(t,e){return Jn(t.name,e.name)}function Mc(t,e){return Jn(t,e)}var Kl;function n0(t){Kl=t}var _p=function(t){return typeof t=="number"?"number:"+Jf(t):"string:"+t},vp=function(t){if(t.isLeafNode()){let e=t.val();m(typeof e=="string"||typeof e=="number"||typeof e=="object"&&qe(e,".sv"),"Priority must be a string or number.")}else m(t===Kl||t.isEmpty(),"priority of unexpected type.");m(t===Kl||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var xf,Hn=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,m(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),vp(this.priorityNode_)}static set __childrenNodeConstructor(n){xf=n}static get __childrenNodeConstructor(){return xf}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return O(n)?this:M(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let r=M(n);return r===null?i:i.isEmpty()&&r!==".priority"?this:(m(r!==".priority"||Rt(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(z(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+_p(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=Jf(this.value_):n+=this.value_,this.lazyHash_=Kf(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(m(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(r);return m(s>=0,"Unknown leaf type: "+i),m(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),yp,bp;function i0(t){yp=t}function r0(t){bp=t}var Yl=class extends zn{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Jn(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return N.MIN}maxPost(){return new N(cn,new Hn("[PRIORITY-POST]",bp))}makePost(e,n){let i=yp(e);return new N(n,new Hn("[PRIORITY-POST]",i))}toString(){return".priority"}},H=new Yl;var s0=Math.log(2),Ql=class{constructor(e){let n=s=>parseInt(Math.log(s)/s0,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},qs=function(t,e,n,i){t.sort(e);let r=function(c,l){let u=l-c,d,h;if(u===0)return null;if(u===1)return d=t[c],h=n?n(d):d,new Ve(h,d.node,Ve.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=r(c,f),C=r(f+1,l);return d=t[f],h=n?n(d):d,new Ve(h,d.node,Ve.BLACK,p,C)}},s=function(c){let l=null,u=null,d=t.length,h=function(p,C){let b=d-p,x=d;d-=p;let q=r(b+1,x),ie=t[b],J=n?n(ie):ie;f(new Ve(J,ie.node,C,null,q))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let C=c.nextBitIsOne(),b=Math.pow(2,c.count-(p+1));C?h(b,Ve.BLACK):(h(b,Ve.BLACK),h(b,Ve.RED))}return u},o=new Ql(t.length),a=s(o);return new ke(i||e,a)};var xl,Un={},qn=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return m(Un&&H,"ChildrenNode.ts has not been loaded"),xl=xl||new t({".priority":Un},{".priority":H}),xl}get(e){let n=en(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ke?n:null}hasIndex(e){return qe(this.indexSet_,e.toString())}addIndex(e,n){m(e!==Wn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(N.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=qs(i,e.getCompare()):a=Un;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let i=Ji(this.indexes_,(r,s)=>{let o=en(this.indexSet_,s);if(m(o,"Missing index implementation for "+s),r===Un)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(N.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),qs(a,o.getCompare())}else return Un;else{let a=n.get(e.name),c=r;return a&&(c=c.remove(new N(e.name,a))),c.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=Ji(this.indexes_,r=>{if(r===Un)return r;{let s=n.get(e.name);return s?r.remove(new N(e.name,s)):r}});return new t(i,this.indexSet_)}};var sr,T=(()=>{class t{constructor(n,i,r){this.children_=n,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&vp(this.priorityNode_),this.children_.isEmpty()&&m(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return sr||(sr=new t(new ke(Mc),null,qn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||sr}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?sr:i}}getChild(n){let i=M(n);return i===null?this:this.getImmediateChild(i).getChild(z(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(m(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let r=new N(n,i),s,o;i.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?sr:this.priorityNode_;return new t(s,a,o)}}updateChild(n,i){let r=M(n);if(r===null)return i;{m(M(n)!==".priority"||Rt(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(z(n),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(H,(a,c)=>{i[a]=c.val(n),r++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*r){let a=[];for(let c in i)a[c]=i[c];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+_p(this.getPriority().val())+":"),this.forEachChild(H,(i,r)=>{let s=r.hash();s!==""&&(n+=":"+i+":"+s)}),this.lazyHash_=n===""?"":Kf(n)}return this.lazyHash_}getPredecessorChildName(n,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new N(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new N(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new N(i,this.children_.get(i)):null}forEachChild(n,i){let r=this.resolveIndex_(n);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,N.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,N.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===wr?-1:0}withIndex(n){if(n===Wn||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===Wn||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(H),s=i.getIterator(H),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Wn?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),Jl=class extends T{constructor(){super(new ke(Mc),T.EMPTY_NODE,qn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return T.EMPTY_NODE}isEmpty(){return!1}},wr=new Jl;Object.defineProperties(N,{MIN:{value:new N(Gn,T.EMPTY_NODE)},MAX:{value:new N(cn,wr)}});Hs.__EMPTY_NODE=T.EMPTY_NODE;Hn.__childrenNodeConstructor=T;n0(wr);r0(wr);var o0=!0;function se(t,e=null){if(t===null)return T.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),m(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Hn(n,se(e))}if(!(t instanceof Array)&&o0){let n=[],i=!1;if(we(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=se(a);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new N(o,c)))}}),n.length===0)return T.EMPTY_NODE;let s=qs(n,t0,o=>o.name,Mc);if(i){let o=qs(n,H.getCompare());return new T(s,se(e),new qn({".priority":o},{".priority":H}))}else return new T(s,se(e),qn.Default)}else{let n=T.EMPTY_NODE;return we(t,(i,r)=>{if(qe(t,i)&&i.substring(0,1)!=="."){let s=se(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(se(e))}}i0(se);var Xl=class extends zn{constructor(e){super(),this.indexPath_=e,m(!O(e)&&M(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Jn(e.name,n.name):s}makePost(e,n){let i=se(e),r=T.EMPTY_NODE.updateChild(this.indexPath_,i);return new N(n,r)}maxPost(){let e=T.EMPTY_NODE.updateChild(this.indexPath_,wr);return new N(cn,e)}toString(){return pp(this.indexPath_,0).join("/")}};var Zl=class extends zn{compare(e,n){let i=e.node.compareTo(n.node);return i===0?Jn(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return N.MIN}maxPost(){return N.MAX}makePost(e,n){let i=se(e);return new N(n,i)}toString(){return".value"}},a0=new Zl;function wp(t){return{type:"value",snapshotNode:t}}function Kn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function hr(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function fr(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function l0(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var pr=class{constructor(e){this.index_=e}updateChild(e,n,i,r,s,o){m(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(hr(n,a)):m(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Kn(n,i)):o.trackChildChange(fr(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(H,(r,s)=>{n.hasChild(r)||i.trackChildChange(hr(r,s))}),n.isLeafNode()||n.forEachChild(H,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(fr(r,s,o))}else i.trackChildChange(Kn(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?T.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Ks=class t{constructor(e){this.indexedFilter_=new pr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,r,s,o){return this.matches(new N(n,i))||(i=T.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=T.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(T.EMPTY_NODE);let s=this;return n.forEachChild(H,(o,a)=>{s.matches(new N(o,a))||(r=r.updateImmediateChild(o,T.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var ec=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Ks(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,r,s,o){return this.rangedFilter_.matches(new N(n,i))||(i=T.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,o):this.fullLimitUpdateChild_(e,n,i,s,o)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=T.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=T.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(T.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,T.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;m(a.numChildren()===this.limit_,"");let c=new N(n,i),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=r.getChildAfterChild(this.index_,l,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(u&&!i.isEmpty()&&f>=0)return s?.trackChildChange(fr(n,i,d)),a.updateImmediateChild(n,i);{s?.trackChildChange(hr(n,d));let C=a.updateImmediateChild(n,T.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Kn(h.name,h.node)),C.updateImmediateChild(h.name,h.node)):C}}else return i.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(hr(l.name,l.node)),s.trackChildChange(Kn(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(l.name,T.EMPTY_NODE)):e}};var tc=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=H}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return m(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return m(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gn}hasEnd(){return this.endSet_}getIndexEndValue(){return m(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return m(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:cn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return m(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===H}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function c0(t){return t.loadsAllData()?new pr(t.getIndex()):t.hasLimit()?new ec(t):new Ks(t)}function Rf(t){let e={};if(t.isDefault())return e;let n;if(t.index_===H?n="$priority":t.index_===a0?n="$value":t.index_===Wn?n="$key":(m(t.index_ instanceof Xl,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Q(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=Q(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Q(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Q(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Q(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Mf(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==H&&(e.i=t.index_.toString()),e}var nc=class t extends Ws{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=br("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(m(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,i),a={};this.listens_[o]=a;let c=Rf(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,i),en(this.listens_,o)===a){let h;l?l===401?h="permission_denied":h="rest_error:"+l:h="ok",r(h,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=Rf(e._queryParams),i=e._path.toString(),r=new St;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Kh(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Vn(a.responseText)}catch{be("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,c)}else a.status!==401&&a.status!==404&&be("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var ic=class{constructor(){this.rootNode_=T.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Ys(){return{value:null,children:new Map}}function Cp(t,e,n){if(O(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=M(e);t.children.has(i)||t.children.set(i,Ys());let r=t.children.get(i);e=z(e),Cp(r,e,n)}}function rc(t,e,n){t.value!==null?n(e,t.value):u0(t,(i,r)=>{let s=new B(e.toString()+"/"+i);rc(r,s,n)})}function u0(t,e){t.children.forEach((n,i)=>{e(i,n)})}var sc=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&we(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var Nf=10*1e3,d0=30*1e3,h0=5*60*1e3,oc=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new sc(e);let i=Nf+(d0-Nf)*Math.random();ar(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;we(e,(r,s)=>{s>0&&qe(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),ar(this.reportStats_.bind(this),Math.floor(Math.random()*2*h0))}};var Ye=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Ye||{});function Ep(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Nc(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Oc(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var ac=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Ye.ACK_USER_WRITE,this.source=Ep()}operationForChild(e){if(O(this.path)){if(this.affectedTree.value!=null)return m(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new B(e));return new t(L(),n,this.revert)}}else return m(M(this.path)===e,"operationForChild called for unrelated child."),new t(z(this.path),this.affectedTree,this.revert)}};var Qs=class t{constructor(e,n){this.source=e,this.path=n,this.type=Ye.LISTEN_COMPLETE}operationForChild(e){return O(this.path)?new t(this.source,L()):new t(this.source,z(this.path))}};var Yn=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Ye.OVERWRITE}operationForChild(e){return O(this.path)?new t(this.source,L(),this.snap.getImmediateChild(e)):new t(this.source,z(this.path),this.snap)}};var Js=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Ye.MERGE}operationForChild(e){if(O(this.path)){let n=this.children.subtree(new B(e));return n.isEmpty()?null:n.value?new Yn(this.source,L(),n.value):new t(this.source,L(),n)}else return m(M(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Qe=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(O(e))return this.isFullyInitialized()&&!this.filtered_;let n=M(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var lc=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function f0(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(l0(o.childName,o.snapshotNode))}),or(t,r,"child_removed",e,i,n),or(t,r,"child_added",e,i,n),or(t,r,"child_moved",s,i,n),or(t,r,"child_changed",e,i,n),or(t,r,"value",e,i,n),r}function or(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,c)=>m0(t,a,c)),o.forEach(a=>{let c=p0(t,a,s);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function p0(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function m0(t,e,n){if(e.childName==null||n.childName==null)throw Zt("Should only compare child_ events.");let i=new N(e.childName,e.snapshotNode),r=new N(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function fo(t,e){return{eventCache:t,serverCache:e}}function cr(t,e,n,i){return fo(new Qe(e,n,i),t.serverCache)}function Ip(t,e,n,i){return fo(t.eventCache,new Qe(e,n,i))}function Xs(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function un(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Rl,g0=()=>(Rl||(Rl=new ke(_b)),Rl),Ce=class t{constructor(e,n=g0()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return we(e,(i,r)=>{n=n.set(new B(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:L(),value:this.value};if(O(e))return null;{let i=M(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(z(e),n);return s!=null?{path:ne(new B(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(O(e))return this;{let n=M(e),i=this.children.get(n);return i!==null?i.subtree(z(e)):new t(null)}}set(e,n){if(O(e))return new t(n,this.children);{let i=M(e),s=(this.children.get(i)||new t(null)).set(z(e),n),o=this.children.insert(i,s);return new t(this.value,o)}}remove(e){if(O(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=M(e),i=this.children.get(n);if(i){let r=i.remove(z(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(O(e))return this.value;{let n=M(e),i=this.children.get(n);return i?i.get(z(e)):null}}setTree(e,n){if(O(e))return n;{let i=M(e),s=(this.children.get(i)||new t(null)).setTree(z(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new t(this.value,o)}}fold(e){return this.fold_(L(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(ne(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,L(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(O(e))return null;{let s=M(e),o=this.children.get(s);return o?o.findOnPath_(z(e),ne(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,L(),n)}foreachOnPath_(e,n,i){if(O(e))return this;{this.value&&i(n,this.value);let r=M(e),s=this.children.get(r);return s?s.foreachOnPath_(z(e),ne(n,r),i):new t(null)}}foreach(e){this.foreach_(L(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(ne(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var Ue=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Ce(null))}};function ur(t,e,n){if(O(e))return new Ue(new Ce(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=_e(r,e);return s=s.updateChild(o,n),new Ue(t.writeTree_.set(r,s))}else{let r=new Ce(n),s=t.writeTree_.setTree(e,r);return new Ue(s)}}}function Of(t,e,n){let i=t;return we(n,(r,s)=>{i=ur(i,ne(e,r),s)}),i}function kf(t,e){if(O(e))return Ue.empty();{let n=t.writeTree_.setTree(e,new Ce(null));return new Ue(n)}}function cc(t,e){return dn(t,e)!=null}function dn(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(_e(n.path,e)):null}function Pf(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(H,(i,r)=>{e.push(new N(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new N(i,r.value))}),e}function Dt(t,e){if(O(e))return t;{let n=dn(t,e);return n!=null?new Ue(new Ce(n)):new Ue(t.writeTree_.subtree(e))}}function uc(t){return t.writeTree_.isEmpty()}function Qn(t,e){return Sp(L(),t.writeTree_,e)}function Sp(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(m(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=Sp(ne(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(ne(t,".priority"),i)),n}}function po(t,e){return xp(e,t)}function _0(t,e,n,i,r){m(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=ur(t.visibleWrites,e,n)),t.lastWriteId=i}function v0(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function y0(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);m(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&b0(a,i.path)?r=!1:je(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return w0(t),!0;if(i.snap)t.visibleWrites=kf(t.visibleWrites,i.path);else{let a=i.children;we(a,c=>{t.visibleWrites=kf(t.visibleWrites,ne(i.path,c))})}return!0}else return!1}function b0(t,e){if(t.snap)return je(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&je(ne(t.path,n),e))return!0;return!1}function w0(t){t.visibleWrites=Tp(t.allWrites,C0,L()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function C0(t){return t.visible}function Tp(t,e,n){let i=Ue.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)je(n,o)?(a=_e(n,o),i=ur(i,a,s.snap)):je(o,n)&&(a=_e(o,n),i=ur(i,L(),s.snap.getChild(a)));else if(s.children){if(je(n,o))a=_e(n,o),i=Of(i,a,s.children);else if(je(o,n))if(a=_e(o,n),O(a))i=Of(i,L(),s.children);else{let c=en(s.children,M(a));if(c){let l=c.getChild(z(a));i=ur(i,L(),l)}}}else throw Zt("WriteRecord should have .snap or .children")}}return i}function Ap(t,e,n,i,r){if(!i&&!r){let s=dn(t.visibleWrites,e);if(s!=null)return s;{let o=Dt(t.visibleWrites,e);if(uc(o))return n;if(n==null&&!cc(o,L()))return null;{let a=n||T.EMPTY_NODE;return Qn(o,a)}}}else{let s=Dt(t.visibleWrites,e);if(!r&&uc(s))return n;if(!r&&n==null&&!cc(s,L()))return null;{let o=function(l){return(l.visible||r)&&(!i||!~i.indexOf(l.writeId))&&(je(l.path,e)||je(e,l.path))},a=Tp(t.allWrites,o,e),c=n||T.EMPTY_NODE;return Qn(a,c)}}}function E0(t,e,n){let i=T.EMPTY_NODE,r=dn(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(H,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=Dt(t.visibleWrites,e);return n.forEachChild(H,(o,a)=>{let c=Qn(Dt(s,new B(o)),a);i=i.updateImmediateChild(o,c)}),Pf(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Dt(t.visibleWrites,e);return Pf(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function I0(t,e,n,i,r){m(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=ne(e,n);if(cc(t.visibleWrites,s))return null;{let o=Dt(t.visibleWrites,s);return uc(o)?r.getChild(n):Qn(o,r.getChild(n))}}function S0(t,e,n,i){let r=ne(e,n),s=dn(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=Dt(t.visibleWrites,r);return Qn(o,i.getNode().getImmediateChild(n))}else return null}function T0(t,e){return dn(t.visibleWrites,e)}function A0(t,e,n,i,r,s,o){let a,c=Dt(t.visibleWrites,e),l=dn(c,L());if(l!=null)a=l;else if(n!=null)a=Qn(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),f=h.getNext();for(;f&&u.length<r;)d(f,i)!==0&&u.push(f),f=h.getNext();return u}else return[]}function D0(){return{visibleWrites:Ue.empty(),allWrites:[],lastWriteId:-1}}function Zs(t,e,n,i){return Ap(t.writeTree,t.treePath,e,n,i)}function kc(t,e){return E0(t.writeTree,t.treePath,e)}function Ff(t,e,n,i){return I0(t.writeTree,t.treePath,e,n,i)}function eo(t,e){return T0(t.writeTree,ne(t.treePath,e))}function x0(t,e,n,i,r,s){return A0(t.writeTree,t.treePath,e,n,i,r,s)}function Pc(t,e,n){return S0(t.writeTree,t.treePath,e,n)}function Dp(t,e){return xp(ne(t.treePath,e),t.writeTree)}function xp(t,e){return{treePath:t,writeTree:e}}var dc=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;m(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),m(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,fr(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,hr(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Kn(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,fr(i,e.snapshotNode,r.oldSnap));else throw Zt("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var hc=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},Rp=new hc,mr=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new Qe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Pc(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:un(this.viewCache_),s=x0(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function R0(t){return{filter:t}}function M0(t,e){m(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),m(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function N0(t,e,n,i,r){let s=new dc,o,a;if(n.type===Ye.OVERWRITE){let l=n;l.source.fromUser?o=fc(t,e,l.path,l.snap,i,r,s):(m(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!O(l.path),o=to(t,e,l.path,l.snap,i,r,a,s))}else if(n.type===Ye.MERGE){let l=n;l.source.fromUser?o=k0(t,e,l.path,l.children,i,r,s):(m(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=pc(t,e,l.path,l.children,i,r,a,s))}else if(n.type===Ye.ACK_USER_WRITE){let l=n;l.revert?o=L0(t,e,l.path,i,r,s):o=P0(t,e,l.path,l.affectedTree,i,r,s)}else if(n.type===Ye.LISTEN_COMPLETE)o=F0(t,e,n.path,i,s);else throw Zt("Unknown operation type: "+n.type);let c=s.getChanges();return O0(e,o,c),{viewCache:o,changes:c}}function O0(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Xs(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(wp(Xs(e)))}}function Mp(t,e,n,i,r,s){let o=e.eventCache;if(eo(i,n)!=null)return e;{let a,c;if(O(n))if(m(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=un(e),u=l instanceof T?l:T.EMPTY_NODE,d=kc(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=Zs(i,un(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=M(n);if(l===".priority"){m(Rt(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=Ff(i,n,u,c);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=z(n),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let h=Ff(i,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(l).updateChild(u,h):d=o.getNode().getImmediateChild(l)}else d=Pc(i,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,u,r,s):a=o.getNode()}}return cr(e,a,o.isFullyInitialized()||O(n),t.filter.filtersNodes())}}function to(t,e,n,i,r,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(O(n))l=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,i);l=u.updateFullNode(c.getNode(),f,null)}else{let f=M(n);if(!c.isCompleteForPath(n)&&Rt(n)>1)return e;let p=z(n),b=c.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?l=u.updatePriority(c.getNode(),b):l=u.updateChild(c.getNode(),f,b,p,Rp,null)}let d=Ip(e,l,c.isFullyInitialized()||O(n),u.filtersNodes()),h=new mr(r,d,s);return Mp(t,d,n,r,h,a)}function fc(t,e,n,i,r,s,o){let a=e.eventCache,c,l,u=new mr(r,e,s);if(O(n))l=t.filter.updateFullNode(e.eventCache.getNode(),i,o),c=cr(e,l,!0,t.filter.filtersNodes());else{let d=M(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),i),c=cr(e,l,a.isFullyInitialized(),a.isFiltered());else{let h=z(n),f=a.getNode().getImmediateChild(d),p;if(O(h))p=i;else{let C=u.getCompleteChild(d);C!=null?fp(h)===".priority"&&C.getChild(mp(h)).isEmpty()?p=C:p=C.updateChild(h,i):p=T.EMPTY_NODE}if(f.equals(p))c=e;else{let C=t.filter.updateChild(a.getNode(),d,p,h,u,o);c=cr(e,C,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Lf(t,e){return t.eventCache.isCompleteForChild(e)}function k0(t,e,n,i,r,s,o){let a=e;return i.foreach((c,l)=>{let u=ne(n,c);Lf(e,M(u))&&(a=fc(t,a,u,l,r,s,o))}),i.foreach((c,l)=>{let u=ne(n,c);Lf(e,M(u))||(a=fc(t,a,u,l,r,s,o))}),a}function Vf(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function pc(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;O(n)?l=i:l=new Ce(null).setTree(n,i);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=Vf(t,f,h);c=to(t,c,new B(d),p,r,s,o,a)}}),l.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),C=Vf(t,p,h);c=to(t,c,new B(d),C,r,s,o,a)}}),c}function P0(t,e,n,i,r,s,o){if(eo(r,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(i.value!=null){if(O(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return to(t,e,n,c.getNode().getChild(n),r,s,a,o);if(O(n)){let l=new Ce(null);return c.getNode().forEachChild(Wn,(u,d)=>{l=l.set(new B(u),d)}),pc(t,e,n,l,r,s,a,o)}else return e}else{let l=new Ce(null);return i.foreach((u,d)=>{let h=ne(n,u);c.isCompleteForPath(h)&&(l=l.set(u,c.getNode().getChild(h)))}),pc(t,e,n,l,r,s,a,o)}}function F0(t,e,n,i,r){let s=e.serverCache,o=Ip(e,s.getNode(),s.isFullyInitialized()||O(n),s.isFiltered());return Mp(t,o,n,i,Rp,r)}function L0(t,e,n,i,r,s){let o;if(eo(i,n)!=null)return e;{let a=new mr(i,e,r),c=e.eventCache.getNode(),l;if(O(n)||M(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Zs(i,un(e));else{let d=e.serverCache.getNode();m(d instanceof T,"serverChildren would be complete if leaf node"),u=kc(i,d)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=M(n),d=Pc(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=t.filter.updateChild(c,u,d,z(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,T.EMPTY_NODE,z(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Zs(i,un(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||eo(i,L())!=null,cr(e,l,o,t.filter.filtersNodes())}}var mc=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new pr(i.getIndex()),s=c0(i);this.processor_=R0(s);let o=n.serverCache,a=n.eventCache,c=r.updateFullNode(T.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(T.EMPTY_NODE,a.getNode(),null),u=new Qe(c,o.isFullyInitialized(),r.filtersNodes()),d=new Qe(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=fo(d,u),this.eventGenerator_=new lc(this.query_)}get query(){return this.query_}};function V0(t){return t.viewCache_.serverCache.getNode()}function j0(t){return Xs(t.viewCache_)}function U0(t,e){let n=un(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!O(e)&&!n.getImmediateChild(M(e)).isEmpty())?n.getChild(e):null}function jf(t){return t.eventRegistrations_.length===0}function B0(t,e){t.eventRegistrations_.push(e)}function Uf(t,e,n){let i=[];if(n){m(e==null,"A cancel should cancel all event registrations.");let r=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return i}function Bf(t,e,n,i){e.type===Ye.MERGE&&e.source.queryId!==null&&(m(un(t.viewCache_),"We should always have a full cache before handling merges"),m(Xs(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=N0(t.processor_,r,e,n,i);return M0(t.processor_,s.viewCache),m(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Np(t,s.changes,s.viewCache.eventCache.getNode(),null)}function $0(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(H,(s,o)=>{i.push(Kn(s,o))}),n.isFullyInitialized()&&i.push(wp(n.getNode())),Np(t,i,n.getNode(),e)}function Np(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return f0(t.eventGenerator_,e,n,r)}var no,io=class{constructor(){this.views=new Map}};function W0(t){m(!no,"__referenceConstructor has already been defined"),no=t}function G0(){return m(no,"Reference.ts has not been loaded"),no}function z0(t){return t.views.size===0}function Fc(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return m(s!=null,"SyncTree gave us an op for an invalid query."),Bf(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(Bf(o,e,n,i));return s}}function Op(t,e,n,i,r){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Zs(n,r?i:null),c=!1;a?c=!0:i instanceof T?(a=kc(n,i),c=!1):(a=T.EMPTY_NODE,c=!1);let l=fo(new Qe(a,c,!1),new Qe(i,r,!1));return new mc(e,l)}return o}function H0(t,e,n,i,r,s){let o=Op(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),B0(o,n),$0(o,n)}function q0(t,e,n,i){let r=e._queryIdentifier,s=[],o=[],a=Mt(t);if(r==="default")for(let[c,l]of t.views.entries())o=o.concat(Uf(l,n,i)),jf(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(r);c&&(o=o.concat(Uf(c,n,i)),jf(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Mt(t)&&s.push(new(G0())(e._repo,e._path)),{removed:s,events:o}}function kp(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function xt(t,e){let n=null;for(let i of t.views.values())n=n||U0(i,e);return n}function Pp(t,e){if(e._queryParams.loadsAllData())return mo(t);{let i=e._queryIdentifier;return t.views.get(i)}}function Fp(t,e){return Pp(t,e)!=null}function Mt(t){return mo(t)!=null}function mo(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var ro;function K0(t){m(!ro,"__referenceConstructor has already been defined"),ro=t}function Y0(){return m(ro,"Reference.ts has not been loaded"),ro}var Q0=1,so=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ce(null),this.pendingWriteTree_=D0(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Lp(t,e,n,i,r){return _0(t.pendingWriteTree_,e,n,i,r),r?Er(t,new Yn(Ep(),e,n)):[]}function an(t,e,n=!1){let i=v0(t.pendingWriteTree_,e);if(y0(t.pendingWriteTree_,e)){let s=new Ce(null);return i.snap!=null?s=s.set(L(),!0):we(i.children,o=>{s=s.set(new B(o),!0)}),Er(t,new ac(i.path,s,n))}else return[]}function Cr(t,e,n){return Er(t,new Yn(Nc(),e,n))}function J0(t,e,n){let i=Ce.fromObject(n);return Er(t,new Js(Nc(),e,i))}function X0(t,e){return Er(t,new Qs(Nc(),e))}function Z0(t,e,n){let i=Vc(t,n);if(i){let r=jc(i),s=r.path,o=r.queryId,a=_e(s,e),c=new Qs(Oc(o),a);return Uc(t,s,c)}else return[]}function oo(t,e,n,i,r=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Fp(o,e))){let c=q0(o,e,n,i);z0(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!r){let u=l.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Mt(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=nw(h);for(let p=0;p<f.length;++p){let C=f[p],b=C.query,x=Bp(t,C);t.listenProvider_.startListening(dr(b),gr(t,b),x.hashFn,x.onComplete)}}}!d&&l.length>0&&!i&&(u?t.listenProvider_.stopListening(dr(e),null):l.forEach(h=>{let f=t.queryToTagMap.get(go(h));t.listenProvider_.stopListening(dr(h),f)}))}iw(t,l)}return a}function Vp(t,e,n,i){let r=Vc(t,i);if(r!=null){let s=jc(r),o=s.path,a=s.queryId,c=_e(o,e),l=new Yn(Oc(a),c,n);return Uc(t,o,l)}else return[]}function ew(t,e,n,i){let r=Vc(t,i);if(r){let s=jc(r),o=s.path,a=s.queryId,c=_e(o,e),l=Ce.fromObject(n),u=new Js(Oc(a),c,l);return Uc(t,o,u)}else return[]}function gc(t,e,n,i=!1){let r=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(r,(h,f)=>{let p=_e(h,r);s=s||xt(f,p),o=o||Mt(f)});let a=t.syncPointTree_.get(r);a?(o=o||Mt(a),s=s||xt(a,L())):(a=new io,t.syncPointTree_=t.syncPointTree_.set(r,a));let c;s!=null?c=!0:(c=!1,s=T.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,p)=>{let C=xt(p,L());C&&(s=s.updateImmediateChild(f,C))}));let l=Fp(a,e);if(!l&&!e._queryParams.loadsAllData()){let h=go(e);m(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=rw();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=po(t.pendingWriteTree_,r),d=H0(a,e,n,u,s,c);if(!l&&!o&&!i){let h=Pp(a,e);d=d.concat(sw(t,e,h))}return d}function Lc(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=_e(o,e),l=xt(a,c);if(l)return l});return Ap(r,e,s,n,!0)}function tw(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{let d=_e(l,n);i=i||xt(u,d)});let r=t.syncPointTree_.get(n);r?i=i||xt(r,L()):(r=new io,t.syncPointTree_=t.syncPointTree_.set(n,r));let s=i!=null,o=s?new Qe(i,!0,!1):null,a=po(t.pendingWriteTree_,e._path),c=Op(r,e,a,s?o.getNode():T.EMPTY_NODE,s);return j0(c)}function Er(t,e){return jp(e,t.syncPointTree_,null,po(t.pendingWriteTree_,L()))}function jp(t,e,n,i){if(O(t.path))return Up(t,e,n,i);{let r=e.get(L());n==null&&r!=null&&(n=xt(r,L()));let s=[],o=M(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=Dp(i,o);s=s.concat(jp(a,c,l,u))}return r&&(s=s.concat(Fc(r,t,i,n))),s}}function Up(t,e,n,i){let r=e.get(L());n==null&&r!=null&&(n=xt(r,L()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=Dp(i,o),u=t.operationForChild(o);u&&(s=s.concat(Up(u,a,c,l)))}),r&&(s=s.concat(Fc(r,t,i,n))),s}function Bp(t,e){let n=e.query,i=gr(t,n);return{hashFn:()=>(V0(e)||T.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?Z0(t,n._path,i):X0(t,n._path);{let s=bb(r,n);return oo(t,n,null,s)}}}}function gr(t,e){let n=go(e);return t.queryToTagMap.get(n)}function go(t){return t._path.toString()+"$"+t._queryIdentifier}function Vc(t,e){return t.tagToQueryMap.get(e)}function jc(t){let e=t.indexOf("$");return m(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new B(t.substr(0,e))}}function Uc(t,e,n){let i=t.syncPointTree_.get(e);m(i,"Missing sync point for query tag that we're tracking");let r=po(t.pendingWriteTree_,e);return Fc(i,n,r,null)}function nw(t){return t.fold((e,n,i)=>{if(n&&Mt(n))return[mo(n)];{let r=[];return n&&(r=kp(n)),we(i,(s,o)=>{r=r.concat(o)}),r}})}function dr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Y0())(t._repo,t._path):t}function iw(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let r=go(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function rw(){return Q0++}function sw(t,e,n){let i=e._path,r=gr(t,e),s=Bp(t,n),o=t.listenProvider_.startListening(dr(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)m(!Mt(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!O(l)&&u&&Mt(u))return[mo(u).query];{let h=[];return u&&(h=h.concat(kp(u).map(f=>f.query))),we(d,(f,p)=>{h=h.concat(p)}),h}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(dr(u),gr(t,u))}}return o}var _c=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},vc=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=ne(this.path_,e);return new t(this.syncTree_,n)}node(){return Lc(this.syncTree_,this.path_)}},ow=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},$f=function(t,e,n){if(!t||typeof t!="object")return t;if(m(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return aw(t[".sv"],e,n);if(typeof t[".sv"]=="object")return lw(t[".sv"],e);m(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},aw=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:m(!1,"Unexpected server value: "+t)}},lw=function(t,e,n){t.hasOwnProperty("increment")||m(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&m(!1,"Unexpected increment value: "+i);let r=e.node();if(m(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},cw=function(t,e,n,i){return Bc(e,new vc(n,t),i)},$p=function(t,e,n){return Bc(t,new _c(e),n)};function Bc(t,e,n){let i=t.getPriority().val(),r=$f(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=$f(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new Hn(a,se(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new Hn(r))),o.forEachChild(H,(a,c)=>{let l=Bc(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var _r=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function $c(t,e){let n=e instanceof B?e:new B(e),i=t,r=M(n);for(;r!==null;){let s=en(i.node.children,r)||{children:{},childCount:0};i=new _r(r,i,s),n=z(n),r=M(n)}return i}function Zn(t){return t.node.value}function Wp(t,e){t.node.value=e,yc(t)}function Gp(t){return t.node.childCount>0}function uw(t){return Zn(t)===void 0&&!Gp(t)}function _o(t,e){we(t.node.children,(n,i)=>{e(new _r(n,t,i))})}function zp(t,e,n,i){n&&!i&&e(t),_o(t,r=>{zp(r,e,!0,i)}),n&&i&&e(t)}function dw(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Ir(t){return new B(t.parent===null?t.name:Ir(t.parent)+"/"+t.name)}function yc(t){t.parent!==null&&hw(t.parent,t.name,t)}function hw(t,e,n){let i=uw(n),r=qe(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,yc(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,yc(t))}var fw=/[\[\].#$\/\u0000-\u001F\u007F]/,pw=/[\[\].#$\u0000-\u001F\u007F]/,Ml=10*1024*1024,Hp=function(t){return typeof t=="string"&&t.length!==0&&!fw.test(t)},qp=function(t){return typeof t=="string"&&t.length!==0&&!pw.test(t)},mw=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),qp(t)};var gw=function(t,e,n,i){i&&e===void 0||Wc(Ps(t,"value"),e,n)},Wc=function(t,e,n){let i=n instanceof B?new zl(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+sn(i));if(typeof e=="function")throw new Error(t+"contains a function "+sn(i)+" with contents = "+e.toString());if(Yf(e))throw new Error(t+"contains "+e.toString()+" "+sn(i));if(typeof e=="string"&&e.length>Ml/3&&Xi(e)>Ml)throw new Error(t+"contains a string greater than "+Ml+" utf8 bytes "+sn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(we(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Hp(o)))throw new Error(t+" contains an invalid key ("+o+") "+sn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Yb(i,o),Wc(t,a,i),Qb(i)}),r&&s)throw new Error(t+' contains ".value" child '+sn(i)+" in addition to actual children.")}};var Kp=function(t,e,n,i){if(!(i&&n===void 0)&&!qp(n))throw new Error(Ps(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},_w=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Kp(t,e,n,i)},vw=function(t,e){if(M(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},yw=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Hp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!mw(n))throw new Error(Ps(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var bc=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Gc(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!xc(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Yp(t,e,n){Gc(t,n),Qp(t,i=>xc(i,e))}function Je(t,e,n){Gc(t,n),Qp(t,i=>je(i,e)||je(e,i))}function Qp(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(bw(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function bw(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();ln&&me("event: "+n.toString()),Xn(i)}}}var ww="repo_interrupt",Cw=25,wc=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new bc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ys(),this.transactionQueueTree_=new _r,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Ew(t,e,n){if(t.stats_=Dc(t.repoInfo_),t.forceRestClient_||Ib())t.server_=new nc(t.repoInfo_,(i,r,s,o)=>{Wf(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Gf(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Q(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Rc(t.repoInfo_,e,(i,r,s,o)=>{Wf(t,i,r,s,o)},i=>{Gf(t,i)},i=>{Sw(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=Tb(t.repoInfo_,()=>new oc(t.stats_,t.server_)),t.infoData_=new ic,t.infoSyncTree_=new so({startListening:(i,r,s,o)=>{let a=[],c=t.infoData_.getNode(i._path);return c.isEmpty()||(a=Cr(t.infoSyncTree_,i._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Hc(t,"connected",!1),t.serverSyncTree_=new so({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,c)=>{let l=o(a,c);Je(t.eventQueue_,i._path,l)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function Iw(t){let n=t.infoData_.getNode(new B(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function zc(t){return ow({timestamp:Iw(t)})}function Wf(t,e,n,i,r){t.dataUpdateCount++;let s=new B(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let c=Ji(n,l=>se(l));o=ew(t.serverSyncTree_,s,c,r)}else{let c=se(n);o=Vp(t.serverSyncTree_,s,c,r)}else if(i){let c=Ji(n,l=>se(l));o=J0(t.serverSyncTree_,s,c)}else{let c=se(n);o=Cr(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=yo(t,s)),Je(t.eventQueue_,a,o)}function Gf(t,e){Hc(t,"connected",e),e===!1&&Dw(t)}function Sw(t,e){we(e,(n,i)=>{Hc(t,n,i)})}function Hc(t,e,n){let i=new B("/.info/"+e),r=se(n);t.infoData_.updateSnapshot(i,r);let s=Cr(t.infoSyncTree_,i,r);Je(t.eventQueue_,i,s)}function Jp(t){return t.nextWriteId_++}function Tw(t,e,n){let i=tw(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(r=>{let s=se(r).withIndex(e._queryParams.getIndex());gc(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Cr(t.serverSyncTree_,e._path,s);else{let a=gr(t.serverSyncTree_,e);o=Vp(t.serverSyncTree_,e._path,s,a)}return Je(t.eventQueue_,e._path,o),oo(t.serverSyncTree_,e,n,null,!0),s},r=>(vo(t,"get for query "+Q(e)+" failed: "+r),Promise.reject(new Error(r))))}function Aw(t,e,n,i,r){vo(t,"set",{path:e.toString(),value:n,priority:i});let s=zc(t),o=se(n,i),a=Lc(t.serverSyncTree_,e),c=$p(o,a,s),l=Jp(t),u=Lp(t.serverSyncTree_,e,c,l,!0);Gc(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||be("set at "+e+" failed: "+h);let C=an(t.serverSyncTree_,l,!p);Je(t.eventQueue_,e,C),Mw(t,r,h,f)});let d=nm(t,e);yo(t,d),Je(t.eventQueue_,d,[])}function Dw(t){vo(t,"onDisconnectEvents");let e=zc(t),n=Ys();rc(t.onDisconnect_,L(),(r,s)=>{let o=cw(r,s,t.serverSyncTree_,e);Cp(n,r,o)});let i=[];rc(n,L(),(r,s)=>{i=i.concat(Cr(t.serverSyncTree_,r,s));let o=nm(t,r);yo(t,o)}),t.onDisconnect_=Ys(),Je(t.eventQueue_,L(),i)}function xw(t,e,n){let i;M(e._path)===".info"?i=gc(t.infoSyncTree_,e,n):i=gc(t.serverSyncTree_,e,n),Yp(t.eventQueue_,e._path,i)}function zf(t,e,n){let i;M(e._path)===".info"?i=oo(t.infoSyncTree_,e,n):i=oo(t.serverSyncTree_,e,n),Yp(t.eventQueue_,e._path,i)}function Rw(t){t.persistentConnection_&&t.persistentConnection_.interrupt(ww)}function vo(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),me(n,...e)}function Mw(t,e,n,i){e&&Xn(()=>{if(n==="ok")e(null);else{let r=(n||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function Xp(t,e,n){return Lc(t.serverSyncTree_,e,n)||T.EMPTY_NODE}function qc(t,e=t.transactionQueueTree_){if(e||bo(t,e),Zn(e)){let n=em(t,e);m(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&Nw(t,Ir(e),n)}else Gp(e)&&_o(e,n=>{qc(t,n)})}function Nw(t,e,n){let i=n.map(l=>l.currentWriteId),r=Xp(t,e,i),s=r,o=r.hash();for(let l=0;l<n.length;l++){let u=n[l];m(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=_e(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{vo(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(an(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();bo(t,$c(t.transactionQueueTree_,e)),qc(t,t.transactionQueueTree_),Je(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Xn(d[h])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{be("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}yo(t,e)}},o)}function yo(t,e){let n=Zp(t,e),i=Ir(n),r=em(t,n);return Ow(t,r,i),i}function Ow(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=_e(n,c.path),u=!1,d;if(m(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,r=r.concat(an(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Cw)u=!0,d="maxretry",r=r.concat(an(t.serverSyncTree_,c.currentWriteId,!0));else{let h=Xp(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Wc("transaction failed: Data returned ",f,c.path);let p=se(f);typeof f=="object"&&f!=null&&qe(f,".priority")||(p=p.updatePriority(h.getPriority()));let b=c.currentWriteId,x=zc(t),q=$p(p,h,x);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=q,c.currentWriteId=Jp(t),o.splice(o.indexOf(b),1),r=r.concat(Lp(t.serverSyncTree_,c.path,q,c.currentWriteId,c.applyLocally)),r=r.concat(an(t.serverSyncTree_,b,!0))}else u=!0,d="nodata",r=r.concat(an(t.serverSyncTree_,c.currentWriteId,!0))}Je(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}bo(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)Xn(i[a]);qc(t,t.transactionQueueTree_)}function Zp(t,e){let n,i=t.transactionQueueTree_;for(n=M(e);n!==null&&Zn(i)===void 0;)i=$c(i,n),e=z(e),n=M(e);return i}function em(t,e){let n=[];return tm(t,e,n),n.sort((i,r)=>i.order-r.order),n}function tm(t,e,n){let i=Zn(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);_o(e,r=>{tm(t,r,n)})}function bo(t,e){let n=Zn(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,Wp(e,n.length>0?n:void 0)}_o(e,i=>{bo(t,i)})}function nm(t,e){let n=Ir(Zp(t,e)),i=$c(t.transactionQueueTree_,e);return dw(i,r=>{Nl(t,r)}),Nl(t,i),zp(i,r=>{Nl(t,r)}),n}function Nl(t,e){let n=Zn(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(m(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(m(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(an(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Wp(e,void 0):n.length=s+1,Je(t.eventQueue_,Ir(e),r);for(let o=0;o<i.length;o++)Xn(i[o])}}function kw(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function Pw(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):be(`Invalid query segment '${n}' in query '${t}'`)}return e}var Hf=function(t,e){let n=Fw(t),i=n.namespace;n.domain==="firebase.com"&&ct(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&ct("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||mb();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Bs(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new B(n.pathString)}},Fw=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(r=kw(t.substring(u,d)));let h=Pw(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var ao=class{constructor(e,n,i,r){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Q(this.snapshot.exportVal())}},lo=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var co=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return m(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Cc=class t{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return O(this._path)?null:fp(this._path)}get ref(){return new Xe(this._repo,this._path)}get _queryIdentifier(){let e=Mf(this._queryParams),n=Ac(e);return n==="{}"?"default":n}get _queryObject(){return Mf(this._queryParams)}isEqual(e){if(e=tn(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=xc(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+Kb(this._path)}};var Xe=class t extends Cc{constructor(e,n){super(e,n,new tc,!1)}get parent(){let e=mp(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},vr=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new B(e),i=uo(this.ref,e);return new t(this._node.getChild(n),i,H)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new t(r,uo(this.ref,i),H)))}hasChild(e){let n=new B(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Sr(t,e){return t=tn(t),t._checkNotDeleted("ref"),e!==void 0?uo(t._root,e):t._root}function uo(t,e){return t=tn(t),M(t._path)===null?_w("child","path",e,!1):Kp("child","path",e,!1),new Xe(t._repo,ne(t._path,e))}function Kc(t,e){t=tn(t),vw("set",t._path),gw("set",e,t._path,!1);let n=new St;return Aw(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function im(t){t=tn(t);let e=new co(()=>{}),n=new ho(e);return Tw(t._repo,t,n).then(i=>new vr(i,new Xe(t._repo,t._path),t._queryParams.getIndex()))}var ho=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new ao("value",this,new vr(e.snapshotNode,new Xe(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new lo(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Ec=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new lo(this,e,n):null}createEvent(e,n){m(e.childName!=null,"Child events should have a childName.");let i=uo(new Xe(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new ao(e.type,this,new vr(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Lw(t,e,n,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){let c=n,l=(u,d)=>{zf(t._repo,t,a),c(u,d)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new co(n,s||void 0),a=e==="value"?new ho(o):new Ec(e,o);return xw(t._repo,t,a),()=>zf(t._repo,t,a)}function rm(t,e,n,i){return Lw(t,"value",e,n,i)}W0(Xe);K0(Xe);var Vw="FIREBASE_DATABASE_EMULATOR_HOST",Ic={},jw=!1;function Uw(t,e,n,i){t.repoInfo_=new Bs(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function Bw(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||ct("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),me("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Hf(s,r),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[Vw]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=Hf(s,r),a=o.repoInfo):c=!o.repoInfo.secure;let u=r&&c?new lr(lr.OWNER):new Vl(t.name,t.options,e);yw("Invalid Firebase Database URL",o),O(o.path)||ct("Database URL must point to the root of a Firebase Database (not including a child path).");let d=Ww(a,t,u,new Ll(t.name,n));return new Sc(d,t)}function $w(t,e){let n=Ic[e];(!n||n[t.key]!==t)&&ct(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Rw(t),delete n[t.key]}function Ww(t,e,n,i){let r=Ic[e.name];r||(r={},Ic[e.name]=r);let s=r[t.toURLString()];return s&&ct("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new wc(t,jw,n,i),r[t.toURLString()]=s,s}var Sc=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ew(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Xe(this._repo,L())),this._rootInternal}_delete(){return this._rootInternal!==null&&($w(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ct("Cannot call "+e+" on a deleted database.")}};function sm(t=df(),e){let n=cf(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let i=Uh("database");i&&Gw(n,...i)}return n}function Gw(t,e,n,i={}){t=tn(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&ct("Cannot call useEmulator() after instance has already been initialized.");let r=t._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&ct('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new lr(lr.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:Bh(i.mockUserToken,t.app.options.projectId);s=new lr(o)}Uw(r,e,n,s)}function zw(t){hb(uf),er(new lt("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Bw(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),At(pf,mf,t),At(pf,mf,"esm2017")}Rc.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Rc.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};zw();var ei=(()=>{class t{openChat=new ae;usersYouTalkedWith=new ae;receiverObjectId="";db=sm();openChatWindow(n){this.receiverObjectId=n,this.openChat.emit(!0)}closeChatWindow(){this.openChat.emit(!1)}sendMessage(n){let i=Sr(this.db,"chats/"+n.senderId+"/"+n.receiverId+"/"+n.timestamp),r=Sr(this.db,"chats/"+n.receiverId+"/"+n.senderId+"/"+n.timestamp);Kc(i,{messageText:n.messageText,senderId:n.senderId,receiverId:n.receiverId,timestamp:n.timestamp}),Kc(r,{messageText:n.messageText,senderId:n.senderId,receiverId:n.receiverId,timestamp:n.timestamp})}listenForMessages(n){let i=Sr(this.db,"chats/"+localStorage.getItem("objectId")+"/"+this.receiverObjectId),r=[];rm(i,s=>{r=[],s.forEach(o=>{r.push(o.val())}),n(r)})}getUsers(){let n=Sr(this.db,"chats/"+localStorage.getItem("objectId"));im(n).then(i=>{let r=[];i.forEach(s=>{r.push(s.key)}),this.usersYouTalkedWith.emit(r)})}static \u0275fac=function(i){return new(i||t)};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Hw(t,e){if(t&1){let n=ui();g(0,"div",4),U("click",function(){let r=mn(n),s=r.$implicit,o=r.index,a=ve();return gn(a.openChatWindow(s.objectId,o))}),g(1,"div",5)(2,"div",6),R(3,"img",7),v(),g(4,"div",8)(5,"div",9)(6,"p"),A(7),v()()()()()}if(t&2){let n=e.$implicit;F(7),vn("",n.firstName," ",n.lastName,"")}}var om=(()=>{class t{authService;messagingService;constructor(n,i){this.authService=n,this.messagingService=i}searchInput="";users=[];ngOnInit(){this.messagingService.getUsers(),this.messagingService.usersYouTalkedWith.subscribe(n=>{n.forEach(i=>{this.authService.findUsersByObjectId(i,r=>{this.users.push(r),this.openChatWindow(this.users[0].objectId,0)})})})}findUsers(){if(this.searchInput.length!==0){let n=localStorage.getItem("userToken");this.authService.findUsersByName(this.searchInput,n,i=>{this.users=i})}else this.messagingService.getUsers()}openChatWindow(n,i){this.messagingService.closeChatWindow(),this.messagingService.openChatWindow(n),document.querySelectorAll(".users-list").forEach((s,o)=>{let a=s.querySelector(".name-class");o!==i?(s.classList.remove("bg-green-600"),a?.classList.remove("text-white"),a?.classList.add("text-gray-700")):(s.classList.add("bg-green-600"),s.classList.add("text-gray-600"),a?.classList.add("text-white"),a?.classList.remove("text-gray-700"))})}static \u0275fac=function(i){return new(i||t)(y(Oe),y(ei))};static \u0275cmp=X({type:t,selectors:[["app-users"]],standalone:!0,features:[Z],decls:4,vars:2,consts:[[1,"h-full","px-5","pt-3","bg-[#EEF2F1]"],[1,"w-full"],["placeholder","Search for a user",1,"basis-[95%]","w-full","px-2","text-xl","font-light","border","outline-none","rounded-md","border-gray-300","focus:border-blue-600",3,"ngModelChange","ngModel"],["class","users-list basis-[94%] flex flex-col-reverse p-5 mt-5 rounded-md  cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"users-list","basis-[94%]","flex","flex-col-reverse","p-5","mt-5","rounded-md","cursor-pointer",3,"click"],[1,"flex"],[1,"h-11","w-11","rounded-full"],["src","./assets/user.jpg",1,"rounded-full"],[1,"name-class","w-full","flex","flex-col","justify-center","pl-3","text-gray-700"],[1,"w-full","flex","items-center","text-xl"]],template:function(i,r){i&1&&(g(0,"div",0)(1,"div",1)(2,"input",2),Lr("ngModelChange",function(o){return Fr(r.searchInput,o)||(r.searchInput=o),o}),U("ngModelChange",function(){return r.findUsers()}),v()(),fe(3,Hw,8,2,"div",3),v()),i&2&&(F(2),Pr("ngModel",r.searchInput),F(),P("ngForOf",r.users))},dependencies:[Fe,Gr,xs,Me,Ge,Gi]})}return t})();var wo=class{messageText;senderId;receiverId;timestamp;constructor(e,n,i,r){this.messageText=e,this.senderId=n,this.receiverId=i,this.timestamp=r}};function qw(t,e){t&1&&(g(0,"p",11),A(1," No messages here "),v())}function Kw(t,e){t&1&&R(0,"img",21)}function Yw(t,e){if(t&1&&(g(0,"p"),A(1),v()),t&2){let n=ve().$implicit,i=ve();F(),vn(" ",n.senderId===(i.senderUser==null?null:i.senderUser.objectId)?i.senderUser==null?null:i.senderUser.firstName:i.receiverUser==null?null:i.receiverUser.firstName," ",n.senderId===(i.senderUser==null?null:i.senderUser.objectId)?i.senderUser==null?null:i.senderUser.lastName:i.receiverUser==null?null:i.receiverUser.lastName," ")}}function Qw(t,e){if(t&1&&(g(0,"ul",12)(1,"li",13),fe(2,Kw,1,0,"img",14),v(),g(3,"li",15)(4,"div",16),fe(5,Yw,2,2,"p",17),v(),g(6,"div",18)(7,"p",19),A(8),v(),g(9,"p",20),A(10),wu(11,"date"),v()()()()),t&2){let n=e.$implicit,i=e.index,r=ve();P("ngClass",n.senderId===r.getCurrentObjectId()?"justify-end flex-row-reverse":"justify-start flex-row"),F(2),P("ngIf",i===0||r.messages[i].senderId!==r.messages[i-1].senderId),F(2),P("ngClass",n.senderId===r.getCurrentObjectId()?"justify-end pr-2":"justify-start pl-2"),F(),P("ngIf",i===0||r.messages[i].senderId!==r.messages[i-1].senderId),F(),P("ngClass",n.senderId===r.getCurrentObjectId()?"pr-2 flex-row-reverse":"flex-row pl-2"),F(2),kr(" ",n.messageText," "),F(2),kr(" ",Cu(11,7,n.timestamp,"hh:mm aa")," ")}}var am=(()=>{class t{messagingService;authService;messages=[];senderUser;receiverUser;text="";constructor(n,i){this.messagingService=n,this.authService=i,this.messagingService.listenForMessages(r=>{this.messages=r}),this.messagingService.openChat.subscribe(r=>{r&&this.messagingService.listenForMessages(s=>{this.messages=s})}),this.authService.getFullName(localStorage.getItem("objectId"),r=>{this.senderUser=r}),this.authService.getFullName(this.messagingService.receiverObjectId,r=>{this.receiverUser=r})}sendMessage(){if(this.text!==""){let n=new wo(this.text,localStorage.getItem("objectId"),this.messagingService.receiverObjectId,Date.now().toString());this.text="",this.messagingService.sendMessage(n)}}getCurrentObjectId(){return localStorage.getItem("objectId")}static \u0275fac=function(i){return new(i||t)(y(ei),y(Oe))};static \u0275cmp=X({type:t,selectors:[["app-chat"]],standalone:!0,features:[Z],decls:11,vars:3,consts:[[1,"h-full","w-full","flex","flex-col","pt-3","px-3","bg-[#F6EFEE]"],["class","w-full text-center bg-gray-500 text-white",4,"ngIf"],[1,"basis-[94%]","flex","flex-col","mb-3","py-3","bg-white","rounded-md","overflow-y-auto"],["class","flex px-5",3,"ngClass",4,"ngFor","ngForOf"],[1,"basis-[6%]","flex","mb-3"],["placeholder","Type a message",1,"basis-[95%]","w-full","h-full","px-2","text-xl","border-gray-300","outline-none","border","rounded-md","focus:border-blue-600","font-lightborder",3,"ngModelChange","keydown.enter","ngModel"],[1,"basis-[5%]","p-2"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","32px","width","32px","version","1.1","id","Capa_1","viewBox","0 0 495.003 495.003",0,"xml","space","preserve",1,"cursor-pointer",3,"click"],["id","XMLID_51_"],["id","XMLID_53_","d","M164.711,456.687c0,2.966,1.647,5.686,4.266,7.072c2.617,1.385,5.799,1.207,8.245-0.468l55.09-37.616   l-67.6-32.22V456.687z"],["id","XMLID_52_","d","M492.431,32.443c-1.513-1.395-3.466-2.125-5.44-2.125c-1.19,0-2.377,0.264-3.5,0.816L7.905,264.422   c-4.861,2.389-7.937,7.353-7.904,12.783c0.033,5.423,3.161,10.353,8.057,12.689l125.342,59.724l250.62-205.99L164.455,364.414   l156.145,74.4c1.918,0.919,4.012,1.376,6.084,1.376c1.768,0,3.519-0.322,5.186-0.977c3.637-1.438,6.527-4.318,7.97-7.956   L494.436,41.257C495.66,38.188,494.862,34.679,492.431,32.443z"],[1,"w-full","text-center","bg-gray-500","text-white"],[1,"flex","px-5",3,"ngClass"],[1,"w-11","rounded-full"],["src","./assets/user.jpg","class","rounded-full",4,"ngIf"],[1,"w-full","flex","flex-col"],[1,"w-full","flex","text-xl",3,"ngClass"],[4,"ngIf"],[1,"flex","items-center","select-text",3,"ngClass"],[1,"text-lg","font-light"],[1,"ml-2","font-light","text-xs","px-2"],["src","./assets/user.jpg",1,"rounded-full"]],template:function(i,r){i&1&&(g(0,"div",0),fe(1,qw,2,0,"p",1),g(2,"div",2),fe(3,Qw,12,10,"ul",3),v(),g(4,"div",4)(5,"input",5),Lr("ngModelChange",function(o){return Fr(r.text,o)||(r.text=o),o}),U("keydown.enter",function(){return r.sendMessage()}),v(),g(6,"div",6),et(),g(7,"svg",7),U("click",function(){return r.sendMessage()}),g(8,"g",8),R(9,"path",9)(10,"path",10),v()()()()()),i&2&&(F(),P("ngIf",r.messages.length===0),F(2),P("ngForOf",r.messages),F(2),Pr("ngModel",r.text))},dependencies:[Fe,Wr,Gr,_t,Du,xs,Me,Ge,Gi]})}return t})();var lm=(()=>{class t{authService;currentUser;hiddenSettings=du();constructor(n){this.authService=n}ngOnInit(){this.authService.findUserByEmail(localStorage.getItem("email"),n=>{this.currentUser=n,this.infoGroup.controls.firstName.setValue(this.currentUser.firstName),this.infoGroup.controls.lastName.setValue(this.currentUser.lastName),this.infoGroup.controls.email.setValue(this.currentUser.email),this.currentUser.provider==="google"&&(this.infoGroup.controls.email.disable(),this.infoGroup.controls.password.disable())})}infoGroup=new It({firstName:new pe("",[ce.required]),lastName:new pe("",[ce.required]),email:new pe("",[ce.required,ce.email]),password:new pe("")});updateInfos(){this.infoGroup.valid&&this.currentUser.provider!=="google"?this.authService.updateInfos(localStorage.getItem("objectId"),this.infoGroup.value.firstName,this.infoGroup.value.lastName,this.infoGroup.value.email,this.infoGroup.value.password.length>=8?this.infoGroup.value.password:void 0,n=>{localStorage.setItem("email",n.email)}):this.infoGroup.valid&&this.authService.updateInfos(localStorage.getItem("objectId"),this.infoGroup.value.firstName,this.infoGroup.value.lastName,void 0,void 0,n=>{})}hideSettings(){this.hiddenSettings.emit(!0)}static \u0275fac=function(i){return new(i||t)(y(Oe))};static \u0275cmp=X({type:t,selectors:[["app-settings"]],outputs:{hiddenSettings:"hiddenSettings"},standalone:!0,features:[Z],decls:27,vars:1,consts:[[1,"h-full","w-full","border-t"],[1,"w-full","p-8"],[1,"flex","items-center","cursor-pointer",3,"click"],[1,"h-8","w-8"],["src","./assets/back.png"],[1,"ml-2","font-bold"],[1,"w-full","h-3/6","flex","justify-center"],[1,"settings-form","w-1/3","flex","flex-col","justify-between",3,"formGroup"],[1,"text-xl","font-bold"],["placeholder","First name","formControlName","firstName",1,"w-full","text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["placeholder","Last name","formControlName","lastName",1,"w-full","text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["type","email","placeholder","email","formControlName","email",1,"w-full","text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],["type","password","formControlName","password",1,"w-full","text-xl","font-light","h-9","px-2","border","border-gray-300","outline-none","rounded-md","focus:border-blue-600"],[1,"bg-green-600","text-white","h-9","text-xl","font-light","rounded-md",3,"click"]],template:function(i,r){i&1&&(g(0,"div",0)(1,"header",1)(2,"div",2),U("click",function(){return r.hideSettings()}),g(3,"div",3),R(4,"img",4),v(),g(5,"p",5),A(6,"Back"),v()()(),g(7,"div",6)(8,"form",7)(9,"div")(10,"label",8),A(11,"First name"),v(),R(12,"input",9),v(),g(13,"div")(14,"label",8),A(15,"Last name"),v(),R(16,"input",10),v(),g(17,"div")(18,"label",8),A(19,"Email"),v(),R(20,"input",11),v(),g(21,"div")(22,"label",8),A(23,"Password"),v(),R(24,"input",12),v(),g(25,"button",13),U("click",function(){return r.updateInfos()}),A(26," Save "),v()()()()),i&2&&(F(8),P("formGroup",r.infoGroup))},dependencies:[Pn,kn,Me,Ge,On,Kt,Yt],styles:["@media only screen and (max-width: 600px){.settings-form[_ngcontent-%COMP%]{width:90%}}"]})}return t})();var Jw=t=>[t];function Xw(t,e){if(t&1){let n=ui();g(0,"ul",17)(1,"li",18),U("click",function(){mn(n);let r=ve();return gn(r.openSettings())}),g(2,"div",19),R(3,"img",20),v(),g(4,"p",11),A(5,"Settings"),v()(),g(6,"li",18),U("click",function(){mn(n);let r=ve();return gn(r.logout())}),g(7,"div",19),R(8,"img",21),v(),g(9,"p",11),A(10,"Logout"),v()()()}t&2&&P("@appear",void 0)}function Zw(t,e){if(t&1&&R(0,"app-users",22),t&2){let n=ve();P("@appear",void 0)("@openUsersPanel",n.openedUsersPanelInMobile?"opened":"closed")("ngClass",bu(3,Jw,n.openedChat?"basis-1/3":"basis-full"))}}function eC(t,e){if(t&1&&R(0,"app-chat",23),t&2){let n=ve();P("@appear",void 0)("ngClass",n.openedChat?"basis-2/3":"basis-0")}}function tC(t,e){if(t&1){let n=ui();g(0,"app-settings",24),U("hiddenSettings",function(){mn(n);let r=ve();return gn(r.closeSettings())}),v()}if(t&2){let n=ve();P("@appear",void 0)("ngClass",n.openedSettings?"basis-full":"basis-0")}}var cm=(()=>{class t{router;messagingService;authService;openedChat=!1;openedSettings=!1;openedPanel=!1;openedUsersPanelInMobile=!1;constructor(n,i,r){this.router=n,this.messagingService=i,this.authService=r,this.getFullName()}currentUser;ngOnInit(){localStorage.getItem("email")===null||localStorage.getItem("userToken")===null||localStorage.getItem("objectId")===null?this.router.navigate(["/login"]):this.authService.verifyIfTokenValid(localStorage.getItem("userToken"),n=>{n||this.router.navigate(["/login"])}),this.messagingService.openChat.subscribe(n=>{this.openedChat=n})}getFullName(){this.authService.getFullName(localStorage.getItem("objectId"),n=>{this.currentUser=n})}openPanel(){this.openedPanel=!this.openedPanel}openSettings(){this.openedPanel=!1,this.openedChat=!1,this.openedSettings=!0}closeSettings(){this.openedSettings=!1}logout(){this.authService.logout(),localStorage.removeItem("email"),localStorage.removeItem("userToken"),localStorage.removeItem("objectId"),this.router.navigate(["/login"])}showMenu(){this.openedUsersPanelInMobile=!this.openedUsersPanelInMobile}static \u0275fac=function(i){return new(i||t)(y(We),y(ei),y(Oe))};static \u0275cmp=X({type:t,selectors:[["app-home"]],standalone:!0,features:[Z],decls:19,vars:7,consts:[[1,"home","h-screen","w-full","flex","flex-col","select-none"],[1,"h-[10%]","flex","items-center","justify-between","px-7","mb:px-3","bg-white"],[1,"h-full","flex","items-center"],[1,"h-full","w-6","justify-center","hidden","mb:flex","mb:items-center",3,"click"],["src","./assets/menu.png"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","#16a34a","height","48px","width","48px","version","1.1","id","Capa_1","viewBox","0 0 60 60",0,"xml","space","preserve",1,"ml-4"],["d","M30,1.5c-16.542,0-30,12.112-30,27c0,5.205,1.647,10.246,4.768,14.604c-0.591,6.537-2.175,11.39-4.475,13.689  c-0.304,0.304-0.38,0.769-0.188,1.153C0.276,58.289,0.625,58.5,1,58.5c0.046,0,0.093-0.003,0.14-0.01  c0.405-0.057,9.813-1.412,16.617-5.338C21.622,54.711,25.738,55.5,30,55.5c16.542,0,30-12.112,30-27S46.542,1.5,30,1.5z"],[1,"text-3xl","ml-2"],[1,"w-44","flex","justify-end","items-center","relative",3,"click"],[1,"h-9","w-9"],["src","./assets/user.jpg"],[1,"cursor-pointer"],[1,"h-[90%]","flex","flex-1","relative"],["class","w-24 flex flex-col bg-white border-b border-r border-l absolute right-0 mx-7 mb:mx-3",4,"ngIf"],["class","mb:absolute mb:h-full",3,"ngClass",4,"ngIf"],["class","mb:basis-full",3,"ngClass",4,"ngIf"],[3,"ngClass","hiddenSettings",4,"ngIf"],[1,"w-24","flex","flex-col","bg-white","border-b","border-r","border-l","absolute","right-0","mx-7","mb:mx-3"],[1,"flex","my-3","items-center",3,"click"],[1,"h-9","w-9","p-1","pl-2","content-center"],["src","./assets/settings.png"],["src","./assets/logout.png"],[1,"mb:absolute","mb:h-full",3,"ngClass"],[1,"mb:basis-full",3,"ngClass"],[3,"hiddenSettings","ngClass"]],template:function(i,r){i&1&&(g(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),U("click",function(){return r.showMenu()}),R(4,"img",4),v(),et(),g(5,"svg",5),R(6,"path",6),v(),Ft(),g(7,"p",7),A(8,"Chat"),v()(),g(9,"div",8),U("click",function(){return r.openPanel()}),g(10,"div",9),R(11,"img",10),v(),g(12,"p",11),A(13),v()()(),g(14,"div",12),fe(15,Xw,11,1,"ul",13)(16,Zw,1,5,"app-users",14)(17,eC,1,2,"app-chat",15)(18,tC,1,2,"app-settings",16),v()()),i&2&&(P("@appear",void 0),F(13),vn(" ",r.currentUser==null?null:r.currentUser.firstName," ",r.currentUser==null?null:r.currentUser.lastName," "),F(2),P("ngIf",r.openedPanel),F(),P("ngIf",!r.openedSettings),F(),P("ngIf",r.openedChat),F(),P("ngIf",r.openedSettings))},dependencies:[Fe,Wr,_t,om,am,lm],data:{animation:[Ut("openUsersPanel",[Vo("opened",ye({left:"0px"})),Vo("closed",ye({left:"-100%"})),rt("opened <=> closed",[it("0.5s")])]),Ut("appear",[rt(":enter",[ye({opacity:0}),it("10000ms",Mu([ye({opacity:0,offset:0}),ye({opacity:.8,offset:.2}),ye({opacity:1,offset:1})]))]),rt(":leave",[ye({opacity:1}),it("50ms",ye({opacity:0}))])])]}})}return t})();var um=[{title:"Home",path:"home",component:cm},{title:"Login",path:"login",component:Oh},{title:"Signup",path:"signup",component:kh},{path:"",redirectTo:"/home",pathMatch:"full"}];var nC="@",iC=(()=>{let e=class e{constructor(i,r,s,o,a){this.doc=i,this.delegate=r,this.zone=s,this.animationType=o,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=w(mu,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-YUYQEDOQ.js").then(r=>r)).catch(r=>{throw new W(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(i,r){let s=this.delegate.createRenderer(i,r);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let o=new Qc(s);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let c=a.createRenderer(i,r);o.use(c),this.scheduler?.notify(9)}).catch(a=>{o.use(s)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(r){Mo()},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Qc=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,i,r){this.delegate.insertBefore(e,n,i,r)}removeChild(e,n,i){this.delegate.removeChild(e,n,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,r){this.delegate.setAttribute(e,n,i,r)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,r){this.delegate.setStyle(e,n,i,r)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){this.shouldReplay(n)&&this.replay.push(r=>r.setProperty(e,n,i)),this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.shouldReplay(n)&&this.replay.push(r=>r.listen(e,n,i)),this.delegate.listen(e,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(nC)}};function dm(t="animations"){return No("NgAsyncAnimations"),Pt([{provide:Nr,useFactory:(e,n,i)=>new iC(e,n,i,t),deps:[ee,Xr,ge]},{provide:Ro,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var hm={providers:[Eu({eventCoalescing:!0}),Md(um),{provide:hi,useClass:Lo},$u(),dm()]};var fm=(()=>{class t{title="chat";static \u0275fac=function(i){return new(i||t)};static \u0275cmp=X({type:t,selectors:[["app-root"]],standalone:!0,features:[Z],decls:1,vars:0,template:function(i,r){i&1&&R(0,"router-outlet")},dependencies:[Ma]})}return t})();var rC="firebase",sC="10.12.4";At(rC,sC,"app");var oC={apiKey:"AIzaSyBaRYK1qyGrBi17GTypMzXGc5-vhC3HfBc",authDomain:"chat-e5d4f.firebaseapp.com",projectId:"chat-e5d4f",storageBucket:"chat-e5d4f.appspot.com",messagingSenderId:"841961552150",appId:"1:841961552150:web:d2639c5f872acf76e73837",databaseURL:"https://chat-e5d4f-default-rtdb.europe-west1.firebasedatabase.app"};Sl(oC);Yu(fm,hm).catch(t=>console.error(t));
